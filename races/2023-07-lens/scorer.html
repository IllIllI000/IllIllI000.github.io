<html>
  <head>
    <meta name='robots' content='noindex'>
    <script>

var reportCount = 0

function addReportFormFields(label, body) {
  const reportsElement = document.getElementById('reports')
  const key = `report${reportCount++}`
  if (!label || '' == label) {
    label = `Bot ${reportCount}`
  }
  if (!body) {
    body = ''
  }

  // results
  const tableElement = document.createElement('table')
  const theadElement = tableElement.createTHead()
  const rowElement = theadElement.insertRow()
  const headings = ['label', 'title', 'matches']
  for (const heading of headings) {
    const headingElement = document.createElement('th')
    headingElement.textContent = heading
    rowElement.appendChild(headingElement)
  }
  const tbodyElement = tableElement.createTBody()
  tbodyElement.id = `${key}_tbody`
  const resultsHeadingElement = document.createElement('h3')
  resultsHeadingElement.textContent = `${label}:`
  const resultsDivElement = document.createElement('div')
  resultsDivElement.id = `${key}_results`
  resultsDivElement.appendChild(resultsHeadingElement)
  resultsDivElement.appendChild(tableElement)
  const allResultsDivElement = document.getElementById('results')
  allResultsDivElement.appendChild(resultsDivElement)

  // input
  const containerElement = document.createElement('div')
  containerElement.id = key

  const botLabelInputElement = document.createElement('input')
  botLabelInputElement.type = 'text'
  botLabelInputElement.size = 20
  botLabelInputElement.value = label
  botLabelInputElement.id = `${key}_name`
  botLabelInputElement.addEventListener('input', function() {
    var label = botLabelInputElement.value
    resultsHeadingElement.textContent = `${label}:`
  })
  const botLabelLabelElement = document.createElement('label')
  botLabelLabelElement.textContent = 'Bot name: '
  botLabelLabelElement.htmlFor = botLabelInputElement.id
  const botReportTextareaElement = document.createElement('textarea')
  botReportTextareaElement.value = body
  botReportTextareaElement.rows = 20
  botReportTextareaElement.cols = 120
  botReportTextareaElement.id = `${key}_body`
  const botReportLabelElement = document.createElement('label')
  botReportLabelElement.textContent = 'Report body markdown (without TOC) of the report:'
  botReportLabelElement.htmlFor = botReportTextareaElement.id

  const addAElement = document.createElement('a')
  addAElement.href = '#'
  addAElement.textContent = '+'
  addAElement.onclick = function() { 
    event.preventDefault()
    addReportFormFields()
  }
  addAElement.style.textDecoration = 'none'
  const removeAElement = document.createElement('a')
  removeAElement.href = '#'
  removeAElement.textContent = '-'
  removeAElement.onclick = function() { 
    event.preventDefault()
    reportsElement.removeChild(containerElement)
    allResultsDivElement.removeChild(resultsDivElement)
  }
  removeAElement.style.textDecoration = 'none'

  containerElement.appendChild(botLabelLabelElement)
  containerElement.appendChild(botLabelInputElement)
  containerElement.appendChild(document.createElement('br'))
  containerElement.appendChild(botReportLabelElement)
  containerElement.appendChild(document.createElement('br'))
  containerElement.appendChild(botReportTextareaElement)
  containerElement.appendChild(document.createElement('br'))
  containerElement.appendChild(document.createElement('br'))
  containerElement.appendChild(document.createTextNode('Add/remove reports: '))
  containerElement.appendChild(addAElement)
  containerElement.appendChild(document.createTextNode(' / '))
  containerElement.appendChild(removeAElement)
  containerElement.appendChild(document.createElement('br'))
  containerElement.appendChild(document.createElement('br'))
  reportsElement.append(containerElement)


}

var salt

function sanitizeStr(str) {
  //return str.toLowerCase().replaceAll(/[\s\u00A0]+/g,' ').replaceAll(/[^a-z0-9\.\_\/: \-\)\(\[\]#]/g, '').trim()
  return str.toLowerCase().replaceAll(/[\s\u00A0]+/g,' ').replaceAll(/[^a-z0-9 ]/g, ' ').replaceAll(/\s+/g, ' ').trim()
}

function decodeHtmlEntities(encodedString) {
  const tempElement = document.createElement('textarea');
  tempElement.innerHTML = encodedString;
  return tempElement.value;
}

var hashes
async function score() {
  const debugElement = document.getElementById('debug')
  debugElement.innerHTML = ''

  const rubric = JSON.parse(document.getElementById('rubric').value)
  hashes = new Set(rubric.hashes)
  salt = rubric.salt
  console.log(hashes)

  const reportsElement = document.getElementById('reports')
  const childIds = Array.from(reportsElement.children).map((childElement) => childElement.id);
  const promises = childIds.map(scoreReport);
  await Promise.all(promises);


  debugElement.appendChild(document.createElement('br'))
  debugElement.appendChild(document.createTextNode('Done'))
  debugElement.appendChild(document.createElement('br'))

  /**
  let str = ''
  for (const [key, value] of allData) {
    str += `${key} : ${JSON.stringify(value)}\n`
  }
  const preElement = document.createElement('pre');
  preElement.textContent = str
  debugElement.appendChild(preElement)
  /**/
}

async function scoreReport(key) {
  console.log(key)
  const tbodyElement = document.getElementById(`${key}_tbody`)
  tbodyElement.innerHTML = ''
  const reportBody = document.getElementById(`${key}_body`).value
  const	reportBodyBlocks = reportBody.split(/^|\n#+[\s\u00A0]+(?=.*[0-9]+)/g)
  const entries = []
  const labels = ['disputed', 'sevInflated', 'outOfScope', 'gasNotQa', 'qaNotGas']
  for (let i = 1; i < 100; i++) {
    const numStr = `${i}`.padStart(2, '0');
    labels.push(`H‑${numStr}_dup`)
    labels.push(`M‑${numStr}_dup`)
    labels.push(`L‑${numStr}_dup`)
    labels.push(`R‑${numStr}_dup`)
    labels.push(`N‑${numStr}_dup`)
    labels.push(`G‑${numStr}_dup`)
    labels.push(`D‑${numStr}_dup`)
  }
  //console.log(labels)
  var allData = new Map()  
  for (const block of reportBodyBlocks) {
    let heading = decodeHtmlEntities(block.split('\n')[0].replaceAll(/<\/?[^`>]+(>|$)/g, '').trim())
    if ('' === heading) {
      continue
    }
    const firstSpaceIndex = heading.search(/[\s\u00A0]/g)
    const title = heading.substr(firstSpaceIndex).trim()
    const label = heading.substr(0, firstSpaceIndex).trim()
    const ruleClass = label.replaceAll(/[^HMLNRGD]/g, '').trim().charAt(0)
    const entry = {'class': sanitizeStr(ruleClass), 'salt':salt, 'title': sanitizeStr(title)}
    //console.log(entry)
/**
    const urlRegex = /\[.*?\]\((https?:\/\/[^\s\)]+)\)/g
    let match
    while ((match = urlRegex.exec(block)) !== null) {
      const url = match[1].replaceAll(/\/\//g, '/').replace(/https?:\//, 'https://').replaceAll(/[\s\u00A0]/g, '');
      const entryWUrl = cloneObj(entry)
      entryWUrl.url = url
      const toCheck = []
      for (const label of labels) {
	const e2 = cloneObj(entry)
	e2.label = label
	toCheck.push(e2)
      }    
    }
/**/
    const toCheck = []
    for (const label of labels) {
      const e2 = cloneObj(entry)
      e2.label = label
      const e2Sorted = {};
      Object.keys(e2).sort().forEach((key) => {
        e2Sorted[key] = e2[key];
      });
      toCheck.push(e2Sorted)
    }
    await getHashToData(toCheck).then((hashToLabeledEntry) => {
      const hits = []
      for (const [key, value] of hashToLabeledEntry) {
	allData.set(key, value)
	if (!hashes.has(key)) {
	  //console.log(key)
	  continue
	}
	console.log(key,value)
	//hitLabels.push(value.label)
	const abbrElement = document.createElement('abbr')
	abbrElement.textContent = value.label.charAt(0)
	abbrElement.title = value.label
	abbrElement.style.textDecoration = 'none'
	hits.push(abbrElement)
      }

      const trElement = document.createElement('tr');
      let tdElement
      tdElement = document.createElement('td')
      tdElement.textContent = label
      trElement.appendChild(tdElement)

      tdElement = document.createElement('td')
      tdElement.style.borderBottom = '1px solid lightgray';
      tdElement.textContent = title
      trElement.appendChild(tdElement)

      const boldElement = document.createElement('b')
      if (0 === hits.length) {
	boldElement.textContent = '?'
      } else {
	boldElement.appendChild(hits[0])
	for (const elem of hits.slice(1)) {
	  boldElement.appendChild(document.createTextNode(', '))
	  boldElement.appendChild(elem)
	}
      }
      tdElement = document.createElement('td')
      tdElement.appendChild(boldElement)
      trElement.appendChild(tdElement)

      tbodyElement.appendChild(trElement)
    })
  }
  
}

function cloneObj(obj) {
  return JSON.parse(JSON.stringify(obj))
}

async function getHashToData(data) {
  const result = new Map();
  const encoder = new TextEncoder();
  for (const obj of data) {
    const jsonString = JSON.stringify(obj)
    const dataBuffer = encoder.encode(jsonString)
    const hashBuffer = await crypto.subtle.digest('SHA-256', dataBuffer)
    const hashArray = Array.from(new Uint8Array(hashBuffer))
    const hashHex = hashArray.map(byte => byte.toString(16).padStart(2, '0')).join('')
    const partialHash = hashHex.substr(0, 10)
    //console.log(partialHash, obj)
    result.set(partialHash, obj);
  }
  return result;
}

    </script>
    <style>
      td { white-space: nowrap; }
    </style>
  </head>
  <body>
    <h1>Bot Race Scorer</h1>

    <p>The purpose of this tool is to identify cases where two bots have identified the same issue, but have used different headings to 
    describe them, and or given them different severities. If two bots have found the same issue, they should be given the same
    number of points during judging, regardless of their respective stated severities (though if one has excessivly inflated 
    the severity, a penalty should probably be assessed).</p>

    <p>This tool takes as input, the report being scored (markdown) and another bot's 'rubric' (JSON), and identifies known
    aliases for the headings in report being scored, based on obfuscated data in the rubric. Try clicking the 'score' button
    below the textareas, which have been populated with data from a previous race, to see how scoring works. This tool solely operates
    on the data provided in the textareas below and does not perform any network-related operations. You can inspect the source by
    right clicking and viewing the source, or can view it <a href='https://github.com/IllIllI000/IllIllI000.github.io/tree/main/races'>here</a>. 
    The tool is based on ideas from <a href='https://blog.cloudflare.com/validating-leaked-passwords-with-k-anonymity/'>this</a> article.</p>

    <p>A major difficulty in scoring bot races is that the top bots all have slightly different wording for their issues, so blind 
    matching of titles will not work. This tool pushes the task of matching bot titles to the owner of each submission rubric,
    where each rubric-generating bot owner has their own database of mappings of titles, and their rubric is generated based on their
    mappings, rather than forcing each bot owner to use the same title. This is a lot more work for each rubric submitter, but
    it leaks a lot less rule information to non-participants, and is thus more fair to the people who put in the work to gather
    and keep the data up to date. This means that while the tool is open-source, the data from which the rubrics are generated
    is private to each bot owner.</p>

    <form id='scoreForm' onsubmit='event.preventDefault(); score();'>
      <label for='textarea'>Rubric from the bottom of the IllIllI-bot report:</label><br/>
      <textarea id='rubric' rows='5' cols='60'>
{"salt":"d47c77","hashes":["310d7edaf6","c5b0a67db5","54df3d2453","050f8f9cb7","fa27d94eea","978005614c","79fff4d3af","6cce28cfbe","88debcd50d","9d66771e9e","4e4f9e1be8","0481167154","7f17a63b66","47191a32b4","f7fadade13","b71ea406b2","0626e83d63","ed0c47db79","cbc00c93c9","8baef3a6cc","b76100bb20","ac8a6f6a03","313bc0aae4","bee47d1b33","5e4be1daea","9988e4085b","d8e6e19535","8ec99a6084","76447a245f","4607e953ff","072b16d8d6","d4c97e3bfc","860591e473","c611dd3d32","cd5355e724","04f7843f6e","35fe5d97ad","5757ae9106","33a49c642b","076008bee9","1c844fb904","1e1b38ecf9","70a6681d28","a0f5e2adea","d87a07d761","2a0d30948a","9e345b3228","0649419518","78eba85bdd","895040c0e3","864763eae6","164fa33134","b9eb76ad61","b3a8859185","ffb9193ee3","e6a59b859f","f7fadade13","b71ea406b2","0626e83d63","ed0c47db79","cbc00c93c9","8baef3a6cc","b76100bb20","4fb7418077","ce6f6c5752","b629dbba11","efcc19a498","ddbebd93f1","ad2a946788","50aa7b91a9","0455a4c07c","edb4788838","f2a624da54","e5069e34e0","3f4aee3387","dbf7ea1697","abc15e537b","7e052afa3a","56df567bd5","39d2668d0e","a3e2a7c7b6","101bc30ed2","6f64f20416","47da6056f9","968961f7fe","4d749e7e78","7c22960947","a50f0900d4","f5ea330808","24835c0f40","52d05dad23","eda0491498","bc810389dd","ac7612e356","789e177747","0027d2bb93","fe8960f6a7","07c87d8f3d","a924449828","fe6767bae1","4faa76c088","7668aa82ad","c47f8e0ae1","a146ac77a9","147d440ea9","607856252d","87b69f7946","c3c3c85b0e","b8c73e108a","e180f4675a","d387d8c5de","134005f29a","60589f2a67","75c602c7ba","0539657cf8","d2e45ebe8a","6e04659cd0","a5ec3e759e","a39656b558","607856252d","87b69f7946","c3c3c85b0e","b8c73e108a","e180f4675a","d387d8c5de","134005f29a","924c337e65","18c15d0c67","8a2299979b","02c1fc38ed","66a1478221","fb59d85d02","783e119fdc","4b5cf4abe0","eebeed5eb1","40c459acda","8c8998235a","ca7d342b56","84d6a3c6b0","03757234b0","f878f15557","b10269369c","f9de1f9e88","fa29273c97","8d1478d33c","f4b09021b8","0b25fa2a11","aa68c08ef1","7d2995897b","55fbc62f80","05f035bbf7","0724158f70","c35784fbfc","eb90bba58d","2214a96efe","4925aba0fc","1da4d68ab8","7498d3389e","b3a34eca5f","34a9595295","770eb4ecec","4dd9b900a1","80b32e9e44","6f7ec44b74","5ce1321782","87979473a2","0d9b69d6df","bbbd6eef69","6bad651b3d","a5128c8726","cd3e787c13","8d20362e39","96be65905b","517db3f61f","ed3571069d","9614805c06","eeefe65c4f","0186424bb8","141d0ff393","5b0494c7ec","4cdf702aa8","e7f70a35c5","e6872f634a","9bb412643f","deddd4fbf1","bec9a60c3f","fd26fa3671","a0a563a4af","764a8ae52a","665acc5513","7f3ec72000","b08d7b3e47","58c7616607","0042c513c3","9f3e7ff535","08526453f1","eb6068bb23","b6bca4e13e","6efcbe34ef","c9117942e2","03d1327db6","f3661a9761","455b80a444","44280ab440","01e538fa37","2aa366dbb2","9675ce09be","c3232ee339","e50c85a194","e735afcd4e","44280ab440","01e538fa37","2aa366dbb2","9675ce09be","c3232ee339","e50c85a194","e735afcd4e","44280ab440","01e538fa37","2aa366dbb2","9675ce09be","c3232ee339","e50c85a194","e735afcd4e","f0d3aa9e51","adfd2b92f6","f38ace10ac","4752092185","f8c859b770","07a441ac72","58a410d808","049ac9ea16","9b4e8e95e9","73ac3be87c","cb6208c920","669f23134e","a774cb00bc","d408231a91","90687b632d","71aa8126f1","04aa244303","dd1614ad20","b3b2ca8516","ea307b4bac","d285978cc6","ba8a3e3591","d36b890bbc","46624a7276","c5b5d2a2e6","94236927d0","965ab1f351","8dc4f6c067","6d9e1fc0ea","6142a1a5a5","8f3f2e391e","f5321a49ad","ad177d6bb1","f3f1738d46","52355fd7cd","42fc6c2ac5","8e2bd9b60b","d82cf1406d","cb69eda158","8809900027","f48142f9f2","4a24b08fc5","fe867bfe3c","9dcb72bc34","b3ffb2a1b5","87d6cb231a","2b744edc3e","6d8785082e","56a189c271","f0d3aa9e51","adfd2b92f6","f38ace10ac","4752092185","f8c859b770","07a441ac72","58a410d808","664afa2615","15d50f20e0","cf12efa1f2","7541c1b083","c3d25d540c","2a58ddb4da","121f178f70","83227d4100","ab50544609","04efe74754","9ab93c63e5","27b88a0185","112044dd19","b17fd9b41f","f3e12b7c03","7733cd44b3","16968828d4","fd55265020","c40831cc00","5496ed03ac","3009bdd15a","3b002b63f0","4f5ec601ce","06f28fdec0","55f532f155","6d274c995f","3200c5b53b","e99f6024b7","d1d26fb8f3","386618524b","9ed19e62bc","326a705951","eed2a392ad","6ae2497f0f","a2222e3f4e","f3e12b7c03","7733cd44b3","16968828d4","fd55265020","c40831cc00","5496ed03ac","3009bdd15a","aac0ce44c1","235ffa26e5","cb4e6355c7","ee308a1d96","c5a0cf34ea","83f32b08d0","8ffb2efa72","912f633752","305d8d285a","1222c1014d","38dd5ed552","4b076833ab","8957f59293","fb912bfc1b","eedf55b881","efc36290c0","2f4265b84d","46befa802f","987cd6a1d5","6afdf4e48c","05d0b464bd","1f5b65811f","04edc1fb6f","172353396a","6d417846b8","94a5118aa3","2fc2764932","f097223be5","8a254457b7","7a5a16c219","f082a5e456","acf282dcf3","5788e98872","fba2696b1f","e98c621790","fc7d712f16","2bb6f068cc","9af8cd0b0c","917329a377","a02eb36a6f","6b9dd7b97b","fd24904ed1","0a35f4bc6f","21981c1cd8","5ed08d82d3","b3ae309a5f","d288ae6f8c","6d2c62f531","4f47501693","d2661c3e88","b4ba512986","df678929fa","fa7d85be50","d06775fa27","922796470d","cf5c2ea396","d2661c3e88","b4ba512986","df678929fa","fa7d85be50","d06775fa27","922796470d","cf5c2ea396","37989c8ce7","175f70e801","93bfd6db3c","7f238af030","81d279af64","538651878e","2c7e5eb735","cc1ef9a474","e6863c0d2f","910d5bbd28","712c186bab","789a5bffb2","12d705ded2","107defdee9","69f1ad1a4b","bf15eb582d","aa19d4d157","45ffafac29","5992e2d5de","a40c34ce81","d77d002b0f","6ed8bfcd54","85d10c7bdd","fa6eed173f","d16a6e3c32","e4c62a27be","63a665bc80","d240041293","b33c5cc496","1999aaaf55","71d2863a04","ce181d4e9b","68dc2bec8d","9373cb3238","ecc0a40113","54b6cac76e","21b7fdc4aa","c808156ecb","ebc412edf0","99fa015e3d","d86db7dd32","bbd46c864b","f32d969b60","28044d69a3","fb7a5f0778","5624ef2fa4","854c7d3344","934166fc3a","fd2f3cc407","69b40cecff","949f2be429","d345763507","0b127d5fb3","28afbb9fa2","67ced41993","ff3f03d6c2","ca7a9efcc6","28f2d591a0","7d05848800","5b6541a64e","e5e407ba90","b2fff88fc8","09a9df5bce","e8d945723d","05b8b52529","4d1464ed11","a178e59ddb","62f250bdb2","f2da6c2cb3","cdce6a3291","1c78ceb9ee","1ac307e9bc","5aeed4aa4e","2336ed07ce","179af75f70","e3e01ed86d","149e67be59","fb5e227d27","97432668b6","9bb9d1f9fd","6f2919b39f","9d1affb0df","122630fc9c","681966f219","f89f2c4502","3118352632","6f42bd3427","8a3b30b3b9","ea3e21d0db","21ec09b266","322b534b20","9d48f75682","63d914b317","82a4b7a00e","f4aca609bf","3b3441c581","477e17b7d8","aba33f6f9a","451d76ff34","17503489bc","2a3dd343ae","9121fff854","cb50c0ea18","3d748539af","4f34bae96b","3e6d61e699","f22e41300b","05a00a6bae","2be967ff42","52fe34cf05","9dc850510d","2dad5b3abd","8ec35bd804","68d3663269","4c3a9a7b46","b413c8bcd6","675c0b0d42","8bd3b28b76","dd8deceea5","c0e2822f5d","c4e8f4eb23","251947561a","eead6f77dc","b40c382ed5","4b2f42f114","91da1f164e","52f8fb2377","1fda11581b","de61a965ad","3d53c1e03b","fe09b153e2","a35c224b7f","ec305f9ccf","21343b70e7","98abc1359e","1d0d018f8b","757f6d70ef","49da59b01f","9fdd3a6b9f","64747769b9","52129ec5ff","a51f2acea0","582ac34aed","b10f7ac5c5","0b0e25c29f","5b063704d5","898d0280c8","860e83a66b","a26e3bd156","53b97f3c90","1fe1978718","51f4c61315","6fe60b72bc","52dad62937","c928370b42","9fd8d6cf15","88dee6ef02","634f99dc4a","28d00924e8","dee0e6da35","b427336344","e5db4386fc","94365f2293","94436f8645","1c40a02a9b","408abbbe4f","56d7815c01","d8e3f70454","c0373a4864","c62163d526","95bef93b30","c0fbb5f5fc","5d1f45600f","3249679759","828a2a8716","db32689934","e6149aa309","d14061bd07","6cc81ec50f","bec0b6ddb4","32ac806b28","ef233a777c","569100bda3","85fc9aa459","6e65712821","cbf1f73b4b","59322046ee","cf3da36913","faf3e8e0c1","50b4e74b5c","45d86bde1f","6d5a27496a","54eae21b44","ed02ad6841","1b9a765a5d","11a1372d08","16cf0b4860","8b06b50136","ddf9d7ea08","198a275e7e","f8f783d61f","d2a8a4354b","a79e8fc1ce","9888420c27","14b66d3051","6836138a50","a0c825a449","3727cee9b2","aa641ea3bc","e4d6378894","90b75aed27","b0c5842a7d","b4a4a36241","e27f63c023","69968a53b7","d0f7712941","bcc0b186ad","7e3b8ac980","d1909c8fda","6c61d70b45","a37ead8e8e","963bb39911","2f925fda14","1f4e079f01","2f423a9c28","4701e9266e","56eab727b8","221889d0dd","308691ce8a","ca48250515","cd4322dbae","0064d31082","def90d2d49","7602792274","a39d9daaca","44064c0743","b876bc1907","661834517c","61939021d8","48ce8f57a2","d746930cb9","e35a28d4ff","3aa25e9a95","48e8c5d8fa","84463174e8","336ec1d436","c45860ed31","16248db442","97e900a18f","267c974e47","e8322183a9","63f9a660d4","92979b86c5","df605cccdc","c3faf439c7","fa4994e7c1","760a055d01","c372870e73","d0b2499f77","b1ff75391c","a70aec4865","5b23472160","7b683864bf","3a17a03eff","762d7f605b","c7ff862c1d","1a25cabddf","519410a5de","a1fea8b1ff","0b80fb3fea","5e4ead6844","7909f77ddf","5dbb4167d6","d396829452","7c7b80cb34","02c5446612","07cfe34a09","fd7a8f12a4","417a2a31c4","5103701823","7ccd531ee4","f5728172fa","662544017b","9fbea67aaf","bd8fac4c4a","2cfe860451","2540fe5ff5","0d95c43126","d39db73403","8960f592d1","f94b820f5e","7db7e1df6f","416c3fbfd0","6ccd57c17e","abe29e20e7","246a731c61","16fbcd55a4","dd5ae61cb6","9428832f9d","cf306b5031","c33e49f0a5","ba991de282","75b2ac2479","061a024f71","72b0429323","349a6be2c3","bceb8d6d90","e33cfa8949","81d4c245bf","c146353170","862e06b747","59673e6def","51deb612f4","fdcac4e51b","d2da513d52","07a194e678","4516c34495","e0dcb2ab08","970680e6ea","fad6e88d7d","4f2135df80","7d4768a4ca","0c877448a9","819798ea3a","e47a67a8cc","6818304569","c624ba7adf","0cf34e0644","9576b4da80","6b1ad2788b","5e8c593be5","b641ee6bb7","6548eac599","29e22e55cc","174eef75e6","bbe143d979","62ac1d75de","3b009c446d","c6e60c9336","39496bfa84","36daca68e0","6c581c4cb9","e4f9506039","098a57f79a","b6a2fa57d7","999884f331","c7bfa3d588","8906557fbc","fc5c78fa5b","8144e37968","80ae3bc516","1e3dde4300","8a19e90a4e","f32dc66982","84fce8ec20","75fe6b2a83","a66d390e04","87bd111bda","6fcb8465f7","a071de363f","fc6d9aba5e","72fee77a0b","7ee4f09565","2881d089bc","95582ee030","b6de458499","6f749dde18","1564c4a52d","b4d65465d3","29405ba2d2","5d0405b354","486da3381b","ac6374f5f6","aaa1ceacec","f9b2c6bc7c","5931c6a415","b80de3f0db","0805aed82b","14a6080ff0","b91b4331ea","61e5f4b53d","f752535d42","0761795b60","80746a564c","737bfb0b76","f41c19778e","02dd6fc2c3","3fd00fac3a","d7b8b3b5a9","3116e0eff0","e1262e90dc","c61cee2e2c","8a5fdfafb7","a60546af2e","672aa43fd2","fd441156a6","d27301079f","8efa0af2f7","d1b1a4cdda","9284f3f3fb","822af5a353","eaeae0b663","a7e2dfdc78","23b6e47a87","085c7ac1ce","79421e9987","346165ed07","b066d1cdb7","d8e77d770d","20835cac5d","c6bdb2f8de","375b6e8721","6ab429262e","b61b254bf9","a0a3aa1276","e3f6f263ad","d03f9c79e0","b4925ab051","7f366941f5","40556890fb","70a580c731","6dfd038275","4a44731a2a","ec0071b594","b9808d5a0c","7137010815","50c94ae5c4","da0395a2d0","7aa3a8c984","928065b274","5ffc6c1b09","3ae2689082","b1767cfa11","6314639edf","2b16ef07e1","b2b08a2286","62a22ec142","e85629c372","3fb3101940","677676f7fb","a0bf200b5d","4d605c986b","dba5aa66fe","097843da89","b5636aee28","a2318bbf32","3a83c4f447","f21b06170a","e02b3fc8d9","6ab6a6c4db","ececefab2f","17b3ae5691","162383d5d0","5b4700d478","337d795553","fda540500e","ba8cab005a","5e8c180f8a","12653dbbc6","3ca65ce93b","25b251ff7d","93bf45d807","36f710623e","9f7ea26c51","b690f8fd80","a987b55422","1af510369e","a1b483c286","dac1cc5242","8cc85be07c","d5d0d03052","c46c1a128b","0e6c4c50fe","704cd42abf","23e501fbd7","6ad2d24eec","e2c7ee86d0","48ad408bab","9fb98fa348","dc2a80a3b6","ce74d4aa48","cc6c3c69fe","dbedeeef73","95cf61396d","a852d827cc","7e57677fbd","6de10d8e01","df0feb25e8","2ea7114126","c5dfc1e83c","36f710623e","9f7ea26c51","b690f8fd80","a987b55422","1af510369e","a1b483c286","dac1cc5242","12207f10f9","f8f9734209","117cb2c74c","fca65ae794","bef3b10ba1","06fcbec772","ffde90d73e","caf7728c7a","a7429944b2","7ff15a1fe1","67cd7b5f29","831ffdb702","5e54eaa252","d65e5a07c8","08c618f7c4","74520e77cd","3a23721265","1189a9a96c","2436623ea7","bba9755ca2","83ae2f4a76","c3588b8ec4","acb04c0652","2badb5d4be","b460d228ab","437d5bbd4e","b2231ec289","d1de0e6866","3897199be8","fb8628ba56","6081226834","7d0dbdbc4a","69e897da22","fc1d28128e","325fa1cc69","b85d3e1543","d60f5d9755","49f66e3eaa","0a7848af7f","f8ea99a8d3","e9ca242908","5563dc4aa9","23c7d536be","1ebcdce507","a6567a35c3","0f33ef339a","f08aa7ca33","bc59337fd2","5cc1100cb1","322ab7f33b","7d860c4d48","277147112b","1f10f17574","5f198d7a71","ff28b9444f","a7bf917f32","9bdfba61f9","e9db6f12e2","b4619422ab","ba39e4a5d3","1156d83350","2b73c2d5a4","9f3c58da2a","094880c308","9f57cad164","e08e086bb3","e5e8a8ca96","0213f3a958","0ca07220e7","a8fd047e50","67dcbbe288","04cddf1cea","840eb8f0d0","9c15fdfef6","4cf1bf7b96","15a76912cc","100b8045cf","f28861c460","b239e0a162","471e908e76","b716fbbbeb","53d8180fd9","4dd1d3a9a6","988d7c52e1","8ec5129213","f609e502e1","d1c617ea2d","aa93e7113f","a9b81b7aff","6a3b2bc42a","131c6f1082","dc669001df","49e31f601a","4af9f729d0","44360fa36c","1b6583ee11","5d11b81bab","e445170bf1","52e2e1b8a8","3950d15ab7","630e766ad5","9b4d915c56","940349a00a","03cdb8351b","8bbbec23c6","a0988122d0","af03ea6776","ec66e7177b","c92fb06df4","d706582dca","ae92ef902a","41039d2594","e60083cf33","62af5f5f78","753f7f0f3b","953b98b6db","947558fcaa","d95058f437","daf1933aa0","54860ac764","9a37d58eee","aa8e455fea","94bbe858f4","bbb86b1147","240baf256e","8037b7de0f","4c514d6215","8cf4bdc8a3","6ca34b3d3c","3c4034bbca","9e1c5fce91","e24611d519","8b91df2454","d4b91c311c","60ccaf8307","7cbef62a1b","6dc330720b","ace85aaccd","974e24482b","e5794de66d","66ff0e2456","dbb20316f9","9078779db5","ceb38e8823","dc960429fa","592737a7d9","d55e060e83","289c84c1cd","4674ba001e","6b747d9ac5","c403601621","b9800ad42b","f12c96a437","ae0b885f2f","1637af0d8d","74fa2d35a4","c5f9810963","6c42688430","a73f774fd6","d367a766f5","9a71fb3103","dff8c5aed1","f03711d52b","044d42fa51","1d5c28b651","ac6c879826","92ddf20934","5cf31aaf4d","edfbec223f","6888c05531","752f3f0bad","b63d8a451c","6fd9655d38","6b541af5b2","6070e069fe","06ce3034df","8dcb786422","230bcb1614","49be50d949","6e226c9e6d","6ac1f696eb","2ac32caddd","b70f73a181","dd2c391bd2","843b6095c9","83e96865fe","bea8b7e82e","8c47423b88","d0375d88d3","5acd4b2da6","9118fd4539","a42caae5b3","aa5840c2a3","9cc566096d","8f15f5efc2","6aa560eb4c","40c1187796","47e0868407","e685320e29","b185a2337a","fb81b419a1","c71a380ee4","ec6ea813e0","ab1eab3a4d","c7e74e2795","cd639ff71d","246a899c7c","4b3dd2ee1d","0b49938264","0d28f6de8e","06fe432fc3","b661d5b09b","b9932cc252","c093f6da6b","dfecaf285d","b158eccd07","e9d84bfabc","2e13c7107d","55babfa479","4bb8e5f56c","ca27cdd828","15309ac77c","577b8e50f4","092cfcd049","7d4b2ad601","c5af14661f","e894744f3f","d094e0e49f","d22818b46c","3f3697a2cf","0bdbbe60e2","e0f63ffd65","23bfb69ff1","50cbeed31f","67477df3c4","4d6f86ccb5","c593404712","1c45a76d0d","3fa417774c","bfb424ab15","88b05b3a19","2353e01398","7782bc2898","5b225f56ed","7c8f217795","649abdb614","dcc90d64fd","e55ba7f121","5e1939f182","419e84699c","fc527a9af1","94350e4e66","7d4b2ad601","c5af14661f","e894744f3f","d094e0e49f","d22818b46c","3f3697a2cf","0bdbbe60e2","e19597f75e","496889047a","ecc3cc344f","775949cd22","819d494121","5fa9492094","9b0242fa74","48fe50cfda","d66b19ee36","e65219b6b9","46ca55a86f","2ef8bbfc03","b4a2f0270d","16d5021ebb","f7a4dcb451","ba64afcff9","56e7ad2783","67c21ee6c6","34d5bfda9c","8cb0d31e85","3940102bb5","48fe50cfda","d66b19ee36","e65219b6b9","46ca55a86f","2ef8bbfc03","b4a2f0270d","16d5021ebb","eb0f825616","592967ee15","638ff2e7b9","80d97e8679","0acc40dd02","ddbcf87124","a6bb659354","6a99d2c545","d5be610828","ef18c8bb53","aacfd3153c","dd8144c2a3","9d87731629","c06dc44839","570428c3ba","ef0ae599d5","24a35aba92","2457537b2c","440115d31b","9809cc1df7","a14192918d","ecd845ea83","5fa9e21ba6","19d6323b03","7c15b79269","a682990bc0","8df3b9b266","80c96acaa4","110e8e1395","7e83d297c0","d8474c5280","69875b53ca","cfb0d20a67","fe4de7cca8","920c321b60","8afc38c4fe","99a2137461","e4c5c7911d","0ea4891cf9","1c9b4f46b0","fa9363aa5e","0be69dafc3","66f8a59633","b7414c7ef3","a48f980fce","b88fc7c9b5","8ae1c4b295","2e7e354b71","a913f6d7d5","8522617961","ffe94ad56e","38672fe857","1284d5a228","6258eef9f9","ea90792836","6dc8087580","ecd845ea83","5fa9e21ba6","19d6323b03","7c15b79269","a682990bc0","8df3b9b266","80c96acaa4","f38bddc272","ba031e094a","8bd29480b6","2f31709527","69fd48621a","79200c0bfb","cda87fa2af","16f16dd791","e756bf4cd2","deb488cd34","4593a4d4f8","2008ba5f48","f1bc726a48","3444a3f928","c413e82468","b3557c6ff4","ae9bbbf82c","5e0a398a48","0d99f69d74","206d77a374","100eda5a4b","c3a3f93b88","8901797ea8","89151eeef4","8886571a75","92cb689be1","5e0f8684b4","8f5c624fb6","fa5a288afb","1641d64f2a","737ee40455","ad44970750","9d14e970ee","a3194746a0","8f2bd47c0f","624086bd93","a88f4855b3","5e9d92d5b0","192bb2bd4e","fa9ae520aa","23f253d1c7","029060f2a8","9a4a9149a5","9f62989f17","7581790ccd","eaee13d050","1b3a7aa811","04d30aab64","ff5db016fc","d9b71dc3a6","75c5ed367d","052f555177","d17744a67c","0588883475","b6c322408f","2bc078a6d1","c52572e62e","4cdb8325b8","4bd0211c11","8a6f720985","4dbfe56348","b1de07ffeb","4bb4b5dc71","b83e25c1ac","567c7aa261","66bbe64cab","2a4e1e6103","c31f82f118","e97af2ca7b","48a93a78f5","318a9cac86","807f3823c7","9d68bd7baf","5505acaaa2","65203ab785","c58b22efdd","891f888660","0a834a7a22","da5f683850","be6f10eba8","30e9e7c05f","27e20e2139","29cc40a1e1","01b7526df0","c5711e6541","04ce773dbc","70cfd2068a","72ffa12946","49bf30659a","2b9558df33","facbf7d174","c6160cf29b","28074d68df","723d685689","3a361eff1f","703b84851e","6f1f139a86","c3a85670c0","fee7d9a31b","f2c208810b","fc32e6a257","3ba31bfa3e","501fc6460d","d8d16be70b","862db1778b","b33b27f2b9","4189abad47","d227d73888","28855cd830","1d05d25a27","f9e42e9263","85d1bd835a","c469bfc790","e2a9ad2518","447502b9f7","e37229cc07","5887ec6b89","29b5fb4145","ede7c43358","fee7d9a31b","f2c208810b","fc32e6a257","3ba31bfa3e","501fc6460d","d8d16be70b","862db1778b","168e8e122a","e1234d51a2","7316c0f913","b81d018aba","eb4abf1d16","cf90c63abb","38cea7e037","514486d4fb","620cd3914e","bdb44dc4a5","b81403f8fc","531e02b791","55634d6bd8","35cdd47637","ed29e7e868","c09dc04afd","969bfd9ab8","e39dab3dc5","dabec4f996","c74fbff0a9","bc06da6ae4","53852e8db1","0dad19653e","4f77abe0f4","962d8c1770","bfed48e7b8","dd7e4efe8c","d569a85954","5d602d9f77","1a8256223d","65b44896e1","264c3beac3","d3b49a78e3","a973c58b88","794934e48f","9db39d66c6","2e63b86229","18ada48fc8","69d3993de8","d6316e84ac","05c42b6518","059d91f386","2402507046","fc64283093","a0ac5d34e1","fa2e484c14","5c84df0315","89eb306515","989de6dd38","182d8848e8","5bcd375357","8c5ada1d92","e4e55c2d91","4fea5cf416","f23debeae8","ad7f3673ce","67845f8edd","991b12ee49","3c504a0d88","4808897f77","8c547e8694","bb97dbdeaf","ca818d6673","c990d701ed","5d52cfc88b","078c434253","c4db8602b0","fc1f2e727d","f73a4aa373","defdf13933","16501463c2","12c72d9ea6","fabb36c414","1113686b20","905df1717d","c4a7b70bb4","a6ac4aa947","30072835d4","3184e412ba","a26bf1d409","01722c68eb","3cfdaf1f53","9c750945ce","5dc13dd0fc","a69bee4213","19207e1705","c02bcd1e7d","c01c6eba28","5992c7d955","c105634422","91ce778c39","e5325ce8c1","1a8fc12bc3","d7589be0c4","29ce31d68a","6290a0a0cd","cc3d845e33","1647dcd541","f3d9b5d314","f402c687c5","1fcbda10f9","c7688c66da","88286f3835","455525cc10","63d56f42a5","3a5f07b00d","27b37e3703","96b50bbebd","67b2363d80","ea9c089e72","ad765bb279","9d2190b649","100cb5279f","2e7b6536d2","ded5323adc","f698eb33fa","f91df56dc0","7ce1452f99","97971d6f8d","48fd776cc8","519b048f15","3d2020af0d","c95d934da4","97671f1346","772329443e","0e44980854","18ec85838c","3ebceb8230","074e08f604","54fa30c943","a8dd303ca3","e262db8eb0","57bc1893a2","2cb3e62b82","546d460035","5ab915406f","84b9b1bf01","e64f6dff52","1f9ecec343","94aacb6b6a","db43ae357c","c59440e5ab","daac85350b","70105417d4","8534c3075e","02c251603d","ad1548ef98","5548393d41","86bc73f051","486aab0b52","1c101c684a","f37c2ed83e","cd242611ee","5841f932bb","c5860063e9","995014485f","4e0d7cce54","e7da67ee67","3707977750","795a03169b","15e92a3e3e","cd61dbea14","eb3441cec0","10733588eb","0c078a8b76","122cbf072f","dea2b9bbc7","0db511cf5e","b2a52bd7d5","a9b8505a67","ba2ba1a9ec","55c2560dbd","54fd6972c4","22f3340bf2","575b2fc0a9","f218c4cb0b","31d90cb3b2","81f8d09465","b86e8f793d","d1e0dffa63","f81b7369e4","3d81e6c5c0","a8fc55f29c","01e765ab50","7d596bb1c8","1678f06cee","0b3123df97","9e660fcfcd","4841a62cad","58d6f8c219","7a5a6658ca","f9c43bd97d","1661fac3c1","181d8065e7","8e22b2af88","674a559351","d5245177ac","2ff8b2a05e","58b8996017","5ab3ff74e3","0d5acf9fa2","795679a073","c23baca60b","2e5b8ececc","6ca6b4ff3e","d893279879","6d659e9875","485aa027fe","18c2bbdf10","9883a3c190","0fa4b09f2d","62810d01cf","7546be3018","61322dc0ba","e16aaca7ce","d83a2cf71d","58d603ee0c","0dcb7e34b4","5ba9edff68","7b10fa4476","59eea48741","f8ff1ada47","c456972063","a380bad898","9590630639","b2fec5f145","553b5e1278","cb9d498363","fc0c438471","46c248e9d3","0ba3024ac4","bef0c3efa7","a7fe97ac68","b6c195f098","10a78bdbff","b274c0266b","adef26ddbf","6b0d5fa8cc","9be7082569","1c2f729deb","24ffa9ce61","436dc9836b","e49ba93f67","646f31c720","3ed4d5e954","614985884d","cfa05349a8","b177084c4f","ac88ccf032","0eac26b813","55167f00a6","2a6b7bc109","181ca8ebb3","29d01b2e77","528709a5c9","4922eef102","11bb3e359e","aae2096f96","b71eeaa10a","d89af7d94c","b9f6b3f2ff","5adca592fc","7032c8e8f8","468f970fe6","4071106f81","65a9056531","3f60d09902","8d1dd17ccf","a6deda6563","843c5a2626","9585e8eb1e","1d2ebc386d","06b912e9d1","e52150b698","4dbeae8c99","e215c67265","0e76671dcc","200f95609c","ca2699e914","9b28420a5c","e4dace44ba","1636d74f33","e8713416a6","8595334d82","1e2018f1bd","e1bc8e4885","81d8c7c0cc","a8731dfe1a","995a62096b","c196d48d86","2e422a27e8","43c735a789","ac531dfa50","a495a5e7cf","e4dace44ba","1636d74f33","e8713416a6","8595334d82","1e2018f1bd","e1bc8e4885","81d8c7c0cc","f0b97984f7","b26d333719","d3a70108fd","62ff18ea09","33b03ff7b0","a0d18277fd","8ff4d957db","568112cc29","57075ba691","bcb48e52ca","b6d1ff1c54","57b00ad6c1","5e87545143","1c9ee706b8","6239dd40a6","186afdaf7e","c66c9faa8f","a11b279115","b0a7149024","f3369ad414","a517fec58c","7ef3b6d256","b46b8fdd32","d04b8d3f52","5709416206","f9f9c176a4","911f068a75","9cafe4ce34","aeea3dc5f7","6efd571df6","26f4e58c6d","2fa88aa857","61c0e6bc01","2a84b05481","18ca6af95e","4df860c4c6","6e5186ca76","957cf6fe9a","69f2a64a65","caf74b28cd","5109e1baeb","f2cceb5b85","d80179e311","54df248712","6aa633e8f6","bd35397992","ac4a388eae","fec7ee9e4d","4ca3fe7558","7bbf5f92fd","df3e9193e3","4d7c5595e9","8ee2836a02","3496de29c4","5085db4fef","90f6f20350","c3e02f9be5","c2fc81f4f0","04482af8ea","12bd83cef1","ec0a537934","96395478c9","1c2591cfde","ff1aac7dda","e6e25e5e9e","a6a1164ac1","3b65e08c0c","6ad525d671","c53f390792","6249db4b0f","61c040ab2e","47771d3e15","d12331d9da","91dd2d3bce","a5b52117a3","04b8be8137","58e0d07ea6","a734757405","2dbb432972","1f6378ed01","5e03bad10e","e420123a89","7ccbd64ed3","0948769685","e6efb52183","a15009b640","7c7302f0a8","704615c36a","dd1341e594","4e7617dc01","6e6babbdf4","0db069533c","c73540eadc","3029dc9003","f60a7da807","8bab673418","67c52d978d","63d1af941f","d7c905df5f","ed5387dc65","92aab347e3","3148216048","3b05506824","f0d326242a","201bdc33bb","db7edfc11b","3005dd528f","83d7e14940","0af4fdabd5","ee00091ff2","fbb74153bb","bd831c7d51","92ed5e93e9","3e7c8365a0","402f204aea","b2fa69b463","7a0b5b614a","8a3664c647","7ff2f8bbb4","1967313eca","89ad630aa8","074f5c6ea5","98dd35ca75","07a62c748f","1f9759f63e","faf16b5925","e504c48b77","a5fb90850e","b9403c167c","2d34a20cf7","6b2631120a","42593ba3e2","b5fe43847f","974276d701","12f0fb454a","b83e238395","7f43381e0a","50e5ff958c","b5ca37252c","d8a389797c","9b0291a880","c2f0de3d4d","5b2ae30464","ace5b0e5d9","2af10c7143","70197e3a93","264f0a59ea","0d205db598","917fe7ea05","ae73114820","77aff3ef70","a087ea86da","e8191551ae","f7344ac993","7e2c32bcfd","5a2e13e6c8","98bbcf3901","12c538fc50","b9d2f6b5ec","4b2f99ab2e","c2a65dddcf","484fcf6c66","76da174e0f","bb367561e1","2e44fe81bd","16c01fefe2","d623ebabec","4e9fbb7595","00b7a7b5f4","b4b88c3c2b","4436e9e2fa","7d25afb231","2176e15353","5a10769957","e276617066","0d3dd89cdf","74ff39d301","5cb0e55c74","1bf2858f16","740961fdf3","437c164aa4","2a35bd196c","c48b34f524","cae742cfe1","c0fe2eca17","394c615630","4c4d80e1a9","0cb06bee7a","b52a9ea894","9dd662d922","4be18c4112","032378a3d3","877092c8f5","a871916496","dca018539b","6c009ffe11","ec398e4c50","91270916e8","9e6c00cf8a","e0fdda6fa1","0fee8726de","83baf3ea6f","2592965292","67062b3eeb","95b2b1da2b","05568e644c","2a31b11d85","668b096074","1b1d044ab8","e9e061c217","a2628b5860","c526153ee3","a96605e1ba","65cea1e04b","76a105a232","7fdc8599c2","024bfc4f8b","573b75df28","c8eaa7e1c1","f4e0404ab2","37801a6efb","0952891523","5260a262fe","066046c39e"]}

      </textarea>
      <br/><br/>

      <div id='reports'></div>

      <input type='submit' value='score'>
    </form>
    
    <br/>

    <p><b>How to read this table</b>: The report you've pasted above will be parsed into individual headings, with one row per issue type. 
    The 'matches' column is not meant to match the 'label' column, but is instead meant to match the specific finding from the 
    IllIllI-bot report's headings (seen <a href='https://illilli000.github.io/races/2023-07-lens/key.txt'>here</a> for the default page data). 
    When there is more than one value in the 'matches' column, that means there are some instances that appear in multiple categories. 
    For example, label '<i>[L-05]</i>' has matches (if you hover your mouse over '<i>L</i>' and '<i>D</i>') '<i>L‑02_dup, D‑02_dup</i>', 
    which means '<i>[L-05] Array lengths not checked</i>' in the pasted report 
    has some entries that may match either '<i>[L‑02] Array lengths not checked</i>' (valid instances) or '<i>[D‑02] Array lengths not checked</i>' 
    (disputed/invalid instances) from the IllIllI-bot report. A match of '<i>?</i>' means that there isn't currently an alias that matches
    the report's heading in the rubric; there may or may not be a duplicate in the IllIllI-bot report, or it could be an invalid finding in the 
    other bot's report. The judge will have to investigate as would normally be done.</p>

    <p>The purpose of this tool is to ensure that two reports with the same issue get the same score for that issue. For example, the winning bot
    had '<i>[L-10] Int casting `block.timestamp` can reduce the lifespan of a contract</i>' as 'Low' severity, but looking at the 'matches'
    column (<i>N‑57_dup</i>), IllIllI-bot had the same finding as '<i>[N‑57] Contract timekeeping will break earlier than the Ethereum network itself will 
    stop working</i>' with 'Non-critical' severity. A judge judging these two reports should give both '<i>[L-10]</i>' in this report, and '<i>[N‑57]</i>' in
    IllIllI-bot's report, the same number of points.</p>

    <p><b>When to use this tool for judging</b>: The easiest way to use this tool is as a final check before submitting bot scores. Paste the winning bot's
    markdown and IllIllI-bot's rubric and click the 'score' button, then compare the severities of the 'matches' with the severities
    you gave the winning report. If they all match, you're done - great! If there are some discrepancies, drill down into the individual
    findings and see why the scores don't match, and make sure that the issues in both reports got the same scores for those specific issues.</p>

    <div id='results'>
    </div>
    <div id='debug'></div>
    
    <script>
      const defaultReport = "\n### <a name=\"M-01\"></a>[M-01] `approve()`/`safeApprove()` may revert if the current approval is not zero\nCalling `approve()` without first calling `approve(0)` if the current approval is non-zero will revert with some tokens, such as Tether (USDT). While Tether is known to do this, it applies to other tokens as well, which are trying to protect against [this attack vector](https://docs.google.com/document/d/1YLPtQxZu1UAvO9cZ1O2RPXBbT0mooh4DYKjA_jp-RLM/edit). `safeApprove()` itself also implements this protection. Always reset the approval to zero before changing it to a new value, or use `safeIncreaseAllowance()`/`safeDecreaseAllowance()`\n\n*Instances (2)*:\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n117:         super.approve(to, tokenId);\n\n```\n\n[117](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L117),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n144:         super.approve(to, tokenId);\n\n```\n\n[144](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L144),\n\n### <a name=\"M-02\"></a>[M-02] Condition will not revert when block.timestamp is `==` to the compared variable\nThe condition does not revert when `block.timestamp` is equal to the compared `>` or `<` variable. For example, if there is a check for `block.timestamp > identifier` then there should be a check for cases where `block.timestamp` is `==` to `identifier`\n\n*Instances (1)*:\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n470:         if (signature.deadline < block.timestamp) revert Errors.SignatureExpired();\n\n```\n\n[470](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L470),\n\n### <a name=\"M-03\"></a>[M-03] Centralization Risk for trusted owners\n\n#### Impact:\nContracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.\n\n*Instances (16)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/misc/ImmutableOwnable.sol\n\n5: contract ImmutableOwnable {\n\n```\n\n[5](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L5),\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n9: contract LensV2UpgradeContract is ImmutableOwnable {\n\n32:     ) ImmutableOwnable(owner, lensHub) {\n\n44:     function executeLensV2Upgrade() external onlyOwner {\n\n```\n\n[9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L9), [32](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L32), [44](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L44),\n\n```solidity\nFile: contracts/misc/ProfileCreationProxy.sol\n\n19: contract ProfileCreationProxy is ImmutableOwnable {\n\n28:     ) ImmutableOwnable(owner, hub) {\n\n64:     function proxyCreateHandle(address to, string calldata handle) external onlyOwner returns (uint256) {\n\n```\n\n[19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L19), [28](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L28), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L64),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n7: contract ControllableByContract is Ownable {\n\n21:     constructor(address owner) Ownable() {\n\n30:     function setControllerContract(address newControllerContract) external onlyOwner {\n\n```\n\n[7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L7), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L21), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L30),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n23:     function lensHub_setGovernance(address newGovernance) external onlyOwner {\n\n27:     function lensHub_setEmergencyAdmin(address newEmergencyAdmin) external onlyOwner {\n\n```\n\n[23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L23), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L27),\n\n```solidity\nFile: contracts/misc/access/ProxyAdmin.sol\n\n29:     function rollbackLastUpgrade() external onlyOwner {\n\n33:     function proxy_changeAdmin(address newAdmin) external onlyOwner {\n\n```\n\n[29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L29), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L33),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n25: contract LensHandles is ERC721, ImmutableOwnable, ILensHandles {\n\n66:     ) ERC721('', '') ImmutableOwnable(owner, lensHub) {\n\n```\n\n[25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L25), [66](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L66),\n\n</details>\n\n### <a name=\"M-04\"></a>[M-04] No limits when setting fees\nWhen settings fees state variables, ensure there a require checks in place to prevent incorrect values from being set. This is particularly important when dealing with fee values as without checks fees can be set to 100%\n\n*Instances (1)*:\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n60:     function setTreasuryFee(uint16 newTreasuryFee) external override onlyGov {\n61:            _setTreasuryFee(newTreasuryFee);\n62:        }\n\n```\n\n[60](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L60),\n\n### <a name=\"M-05\"></a>[M-05] Re-org attack\nRe-orgs can happen in all EVM chains. In ethereum, where currently Frankencoin is deployed, it is not “super common” but it still happens, being the last one less than a year ago: [ethereum-beacon-chain-blockchain-reorg](https://decrypt.co/101390/ethereum-beacon-chain-blockchain-reorg) The issue increases the changes of happening if deploying on L2’s/ rollups. where re-orgs have been much more active: [polygon-hit-by-157-block-reorg-despite-hard-fork-to-reduce-reorgs](https://protos.com/polygon-hit-by-157-block-reorg-despite-hard-fork-to-reduce-reorgs/) being the last one, less than a year ago. Deploy the cloned Contract via create2 with a specific salt that includes msg.sender and address `_existing`\n\n*Instances (1)*:\n\n```solidity\nFile: contracts/libraries/FollowLib.sol\n\n92:         address followNFT = address(new FollowNFTProxy(functionData));\n\n```\n\n[92](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L92),\n\n### <a name=\"M-06\"></a>[M-06] `_safeMint()` should be used rather than `_mint()` wherever possible\n`_mint()` is [discouraged](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/d4d8d2ed9798cc3383912a23b5e8d5cb602f7d4b/contracts/token/ERC721/ERC721.sol#L271)in favor of `_safeMint()` which ensures that the recipient is either an EOA or implements `IERC721Receiver`. Both [OpenZeppelin](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/d4d8d2ed9798cc3383912a23b5e8d5cb602f7d4b/contracts/token/ERC721/ERC721.sol#L238-L250)and [solmate](https://github.com/Rari-Capital/solmate/blob/4eaf6b68202e36f67cab379768ac6be304c8ebde/src/tokens/ERC721.sol#L180)have versions of this function\n\n*Instances (4)*:\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n184:         _mint(wrappedTokenReceiver == address(0) ? followerProfileOwner : wrappedTokenReceiver, followTokenId);\n\n202:                 _mint(IERC721(HUB).ownerOf(followerProfileId), followTokenId);\n\n```\n\n[184](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L184), [202](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L202),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n59:             _mint(to, tokenId);\n\n```\n\n[59](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L59),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n196:         _mint(to, tokenId);\n\n```\n\n[196](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L196),\n\n### <a name=\"M-07\"></a>[M-07] Overflow\nmanual check needed\n\n*Instances (30)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/LensHub.sol\n\n96:         unchecked {\n\n```\n\n[96](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L96),\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n299:         unchecked {\n\n361:         unchecked {\n\n378:             unchecked {\n\n417:         unchecked {\n\n506:         unchecked {\n\n```\n\n[299](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L299), [361](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L361), [378](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L378), [417](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L417), [506](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L506),\n\n```solidity\nFile: contracts/libraries/FollowLib.sol\n\n47:             unchecked {\n\n77:             unchecked {\n\n```\n\n[47](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L47), [77](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L77),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n165:             unchecked {\n\n332:             unchecked {\n\n504:         unchecked {\n\n```\n\n[165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L165), [332](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L332), [504](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L504),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n45:             unchecked {\n\n108:             unchecked {\n\n171:             unchecked {\n\n```\n\n[45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L45), [108](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L108), [171](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L171),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n160:             unchecked {\n\n241:             unchecked {\n\n```\n\n[160](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L160), [241](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L241),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n511:             unchecked {\n\n```\n\n[511](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L511),\n\n```solidity\nFile: contracts/libraries/ValidationLib.sol\n\n114:             unchecked {\n\n```\n\n[114](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L114),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n360:         unchecked {\n\n388:         unchecked {\n\n425:         unchecked {\n\n```\n\n[360](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L360), [388](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L388), [425](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L425),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n57:         unchecked {\n\n```\n\n[57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L57),\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n69:             unchecked {\n\n80:             unchecked {\n\n91:             unchecked {\n\n102:             unchecked {\n\n113:             unchecked {\n\n124:             unchecked {\n\n```\n\n[69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L69), [80](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L80), [91](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L91), [102](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L102), [113](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L113), [124](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L124),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n220:             unchecked {\n\n243:             unchecked {\n\n```\n\n[220](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L220), [243](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L243),\n\n</details>\n\n\n## Low Risk Issues\n\n### <a name=\"L-01\"></a>[L-01] Enum values should be used in place of constant array indexes\nCreate a commented enum value to use in place of constant array indexes, this makes the code far easier to understand\n\n*Instances (2)*:\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n210:         bytes1 firstByte = localNameAsBytes[0];\n\n234:         if (localNameAsBytes[0] == '_') {\n\n```\n\n[210](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L210), [234](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L234),\n\n### <a name=\"L-02\"></a>[L-02] Missing checks for `address(0)` in function when assigning values to address state variables\n\n*Instances (4)*:\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n195:             sstore(GOVERNANCE_SLOT, newGovernance)\n\n207:             sstore(EMERGENCY_ADMIN_SLOT, newEmergencyAdmin)\n\n```\n\n[195](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L195), [207](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L207),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n440:         _tokenApprovals[tokenId] = to;\n\n```\n\n[440](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L440),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n32:         controllerContract = newControllerContract;\n\n```\n\n[32](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L32),\n\n### <a name=\"L-03\"></a>[L-03] `address` shouldn't be hard-coded\nIt is often better to declare `address`es as `immutable`, and assign them via constructor arguments. This allows the code to remain the same across deployments on different networks, and avoids recompilation when addresses need to change.\n\n*Instances (1)*:\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n41:     address constant LENS_HUB_ADDRESS = 0xDb46d1Dc155634FbC732f92E853b10B288AD5a1d;\n\n```\n\n[41](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L41),\n\n### <a name=\"L-04\"></a>[L-04] Add to `denylist` function\nNFT thefts have increased recently, so with the addition of hacked NFTs to the platform, NFTs can be converted into liquidity. To prevent this, I recommend adding the denylist function.\n\nMarketplaces such as Opensea have a denylist feature that will not list NFTs that have been reported theft, NFT projects such as Manifold have denylist functions in their smart contracts.\n\nHere is the project example; Manifold\n\n[Manifold Contract](https://etherscan.io/address/0xe4e4003afe3765aca8149a82fc064c0b125b9e5a#code)\n\n\n\n```solidity\nmodifier nonDenylistRequired(address extension) {\n   require(!_denylistedExtensions.contains(extension), \"Extension denylisted\");\n    _;\n}\n\n```\n\n\n*Instances (5)*:\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n/// @audit Add to Denylist function and modifier.\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L1),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n/// @audit Add to Denylist function and modifier.\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L1),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n/// @audit Add to Denylist function and modifier.\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L1),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n/// @audit Add to Denylist function and modifier.\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L1),\n\n```solidity\nFile: contracts/interfaces/ILensERC721.sol\n\n/// @audit Add to Denylist function and modifier.\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensERC721.sol#L1),\n\n### <a name=\"L-05\"></a>[L-05] Array lengths not checked\nIf the length of the arrays are not required to be of the same length, user operations may not be fully executed due to a mismatch in the number of items iterated over, versus the number of items provided in the second array\n\n*Instances (27)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/LensHub.sol\n\n149:     function changeDelegatedExecutorsConfig(\n150:             uint256 delegatorProfileId,\n151:             address[] calldata delegatedExecutors,\n152:             bool[] calldata approvals,\n153:             uint64 configNumber,\n154:             bool switchToGivenConfig\n155:         ) external override whenNotPaused onlyProfileOwner(msg.sender, delegatorProfileId) {\n\n165:     function changeDelegatedExecutorsConfig(\n166:             uint256 delegatorProfileId,\n167:             address[] calldata delegatedExecutors,\n168:             bool[] calldata approvals\n169:         ) external override whenNotPaused onlyProfileOwner(msg.sender, delegatorProfileId) {\n\n174:     function changeDelegatedExecutorsConfigWithSig(\n175:             uint256 delegatorProfileId,\n176:             address[] calldata delegatedExecutors,\n177:             bool[] calldata approvals,\n178:             uint64 configNumber,\n179:             bool switchToGivenConfig,\n180:             Types.EIP712Signature calldata signature\n181:         ) external override whenNotPaused onlyProfileOwner(signature.signer, delegatorProfileId) {\n\n320:     function follow(\n321:             uint256 followerProfileId,\n322:             uint256[] calldata idsOfProfilesToFollow,\n323:             uint256[] calldata followTokenIds,\n324:             bytes[] calldata datas\n325:         )\n326:             external\n327:             override\n328:             whenNotPaused\n329:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, followerProfileId)\n330:             returns (uint256[] memory)\n331:         {\n\n343:     function followWithSig(\n344:             uint256 followerProfileId,\n345:             uint256[] calldata idsOfProfilesToFollow,\n346:             uint256[] calldata followTokenIds,\n347:             bytes[] calldata datas,\n348:             Types.EIP712Signature calldata signature\n349:         )\n350:             external\n351:             override\n352:             whenNotPaused\n353:             onlyProfileOwnerOrDelegatedExecutor(signature.signer, followerProfileId)\n354:             returns (uint256[] memory)\n355:         {\n\n397:     function setBlockStatus(\n398:             uint256 byProfileId,\n399:             uint256[] calldata idsOfProfilesToSetBlockStatus,\n400:             bool[] calldata blockStatus\n401:         ) external override whenNotPaused onlyProfileOwnerOrDelegatedExecutor(msg.sender, byProfileId) {\n\n406:     function setBlockStatusWithSig(\n407:             uint256 byProfileId,\n408:             uint256[] calldata idsOfProfilesToSetBlockStatus,\n409:             bool[] calldata blockStatus,\n410:             Types.EIP712Signature calldata signature\n411:         ) external override whenNotPaused onlyProfileOwnerOrDelegatedExecutor(signature.signer, byProfileId) {\n\n```\n\n[149](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L149), [165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L165), [174](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L174), [320](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L320), [343](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L343), [397](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L397), [406](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L406),\n\n```solidity\nFile: contracts/libraries/FollowLib.sol\n\n15:     function follow(\n16:            uint256 followerProfileId,\n17:            address transactionExecutor,\n18:            uint256[] calldata idsOfProfilesToFollow,\n19:            uint256[] calldata followTokenIds,\n20:            bytes[] calldata followModuleDatas\n21:        ) external returns (uint256[] memory) {\n\n```\n\n[15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L15),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n87:     function validateChangeDelegatedExecutorsConfigSignature(\n88:            Types.EIP712Signature calldata signature,\n89:            uint256 delegatorProfileId,\n90:            address[] calldata delegatedExecutors,\n91:            bool[] calldata approvals,\n92:            uint64 configNumber,\n93:            bool switchToGivenConfig\n94:        ) external {\n\n320:     function validateFollowSignature(\n321:             Types.EIP712Signature calldata signature,\n322:             uint256 followerProfileId,\n323:             uint256[] calldata idsOfProfilesToFollow,\n324:             uint256[] calldata followTokenIds,\n325:             bytes[] calldata datas\n326:         ) external {\n\n378:     function validateSetBlockStatusSignature(\n379:             Types.EIP712Signature calldata signature,\n380:             uint256 byProfileId,\n381:             uint256[] calldata idsOfProfilesToSetBlockStatus,\n382:             bool[] calldata blockStatus\n383:         ) external {\n\n```\n\n[87](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L87), [320](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L320), [378](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L378),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n94:     function batchMigrateFollows(\n95:            uint256[] calldata followerProfileIds,\n96:            uint256[] calldata idsOfProfileFollowed,\n97:            uint256[] calldata followTokenIds\n98:        ) external {\n\n```\n\n[94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L94),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n128:     function setBlockStatus(\n129:             uint256 byProfileId,\n130:             uint256[] calldata idsOfProfilesToSetBlockStatus,\n131:             bool[] calldata blockStatus\n132:         ) external {\n\n180:     function changeDelegatedExecutorsConfig(\n181:             uint256 delegatorProfileId,\n182:             address[] calldata delegatedExecutors,\n183:             bool[] calldata approvals\n184:         ) external {\n\n198:     function changeGivenDelegatedExecutorsConfig(\n199:             uint256 delegatorProfileId,\n200:             address[] calldata delegatedExecutors,\n201:             bool[] calldata approvals,\n202:             uint64 configNumber,\n203:             bool switchToGivenConfig\n204:         ) external {\n\n222:     function _changeDelegatedExecutorsConfig(\n223:             Types.DelegatedExecutorsConfig storage _delegatedExecutorsConfig,\n224:             uint256 delegatorProfileId,\n225:             address[] memory delegatedExecutors,\n226:             bool[] memory approvals,\n227:             uint64 configNumber,\n228:             bool switchToGivenConfig\n229:         ) private {\n\n```\n\n[128](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L128), [180](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L180), [198](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L198), [222](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L222),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n472:     function _initPubActionModules(\n473:             uint256 profileId,\n474:             address transactionExecutor,\n475:             uint256 pubId,\n476:             address[] calldata actionModules,\n477:             bytes[] calldata actionModulesInitDatas\n478:         ) private returns (bytes[] memory) {\n\n```\n\n[472](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L472),\n\n```solidity\nFile: contracts/libraries/ValidationLib.sol\n\n87:     function validateReferrersAndGetReferrersPubTypes(\n88:            uint256[] memory referrerProfileIds,\n89:            uint256[] memory referrerPubIds,\n90:            uint256 targetedProfileId,\n91:            uint256 targetedPubId\n92:        ) internal view returns (Types.PublicationType[] memory) {\n\n```\n\n[87](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L87),\n\n```solidity\nFile: contracts/misc/LensV2Migration.sol\n\n37:     function batchMigrateFollows(\n38:            uint256[] calldata followerProfileIds,\n39:            uint256[] calldata idsOfProfileFollowed,\n40:            uint256[] calldata followTokenIds\n41:        ) external {\n\n```\n\n[37](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L37),\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n20:     constructor(\n21:            address proxyAdminAddress,\n22:            address governanceAddress,\n23:            address owner,\n24:            address lensHub,\n25:            address newImplementationAddress,\n26:            address[] memory oldFollowModulesToUnwhitelist_,\n27:            address[] memory newFollowModulesToWhitelist_,\n28:            address[] memory oldReferenceModulesToUnwhitelist_,\n29:            address[] memory newReferenceModulesToWhitelist_,\n30:            address[] memory oldCollectModulesToUnwhitelist_,\n31:            address[] memory newActionModulesToWhitelist_\n32:        ) ImmutableOwnable(owner, lensHub) {\n\n```\n\n[20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L20),\n\n```solidity\nFile: contracts/interfaces/ILensProtocol.sol\n\n77:     function changeDelegatedExecutorsConfig(\n\n93:     function changeDelegatedExecutorsConfig(\n\n102:     function changeDelegatedExecutorsConfigWithSig(\n\n230:     function follow(\n\n240:     function followWithSig(\n\n279:     function setBlockStatus(\n\n288:     function setBlockStatusWithSig(\n\n```\n\n[77](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L77), [93](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L93), [102](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L102), [230](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L230), [240](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L240), [279](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L279), [288](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L288),\n\n</details>\n\n### <a name=\"L-06\"></a>[L-06] File allows a version of solidity that is susceptible to an assembly optimizer bug\nIn solidity versions 0.8.13 and 0.8.14, there is an [optimizer bug](https://github.com/ethereum/solidity-blog/blob/499ab8abc19391be7b7b34f88953a067029a5b45/_posts/2022-06-15-inline-assembly-memory-side-effects-bug.md) where, if the use of a variable is in a separate `assembly` block from the block in which it was stored, the `mstore` operation is optimized out, leading to uninitialized memory. The code currently does not have such a pattern of execution, but it does use `mstore`s in `assembly` blocks, so it is a risk for future changes. The affected solidity versions should be avoided if at all possible.\n\n*Instances (2)*:\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n60:         assembly {\n61:                sstore(royaltiesInBasisPointsSlot, royaltiesInBasisPoints)\n62:            }\n\n```\n\n[60](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L60),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n482:                     assembly {\n483:                             revert(add(32, reason), mload(reason))\n484:                         }\n\n```\n\n[482](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L482),\n\n### <a name=\"L-07\"></a>[L-07] Burn functions should be protected with a modifier\n\n*Instances (8)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n255:     function burn(uint256 followTokenId) public override {\n\n341:     function _followWithUnwrappedTokenFromBurnedProfile(\n\n```\n\n[255](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L255), [341](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L341),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n309:     function validateBurnSignature(Types.EIP712Signature calldata signature, uint256 tokenId) external {\n\n```\n\n[309](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L309),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n264:     function burn(uint256 tokenId) public virtual override {\n\n380:     function _burn(uint256 tokenId) internal virtual {\n\n```\n\n[264](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L264), [380](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L380),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n101:     function burn(uint256 tokenId) external {\n\n```\n\n[101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L101),\n\n```solidity\nFile: contracts/interfaces/IERC721Burnable.sol\n\n18:     function burn(uint256 tokenId) external;\n\n```\n\n[18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IERC721Burnable.sol#L18),\n\n```solidity\nFile: contracts/interfaces/ILensHandles.sol\n\n33:     function burn(uint256 tokenId) external;\n\n```\n\n[33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHandles.sol#L33),\n\n</details>\n\n### <a name=\"L-08\"></a>[L-08] Missing zero address check in constructor\n\n*Instances (19)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/base/HubRestricted.sol\n\n25:         HUB = hub;\n\n```\n\n[25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/HubRestricted.sol#L25),\n\n```solidity\nFile: contracts/base/LensImplGetters.sol\n\n12:         FOLLOW_NFT_IMPL = followNFTImpl;\n\n13:         __LEGACY__COLLECT_NFT_IMPL = collectNFTImpl;\n\n```\n\n[12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensImplGetters.sol#L12), [13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensImplGetters.sol#L13),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n34:         MODULE_GLOBALS = IModuleGlobals(moduleGlobals);\n\n```\n\n[34](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L34),\n\n```solidity\nFile: contracts/misc/ImmutableOwnable.sol\n\n27:         OWNER = owner;\n\n28:         LENS_HUB = lensHub;\n\n```\n\n[27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L27), [28](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L28),\n\n```solidity\nFile: contracts/misc/LensV2Migration.sol\n\n26:         FEE_FOLLOW_MODULE = legacyFeeFollowModule;\n\n27:         PROFILE_FOLLOW_MODULE = legacyProfileFollowModule;\n\n28:         NEW_FEE_FOLLOW_MODULE = newFeeFollowModule;\n\n29:         lensHandles = LensHandles(lensHandlesAddress);\n\n30:         tokenHandleRegistry = TokenHandleRegistry(tokenHandleRegistryAddress);\n\n```\n\n[26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L26), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L27), [28](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L28), [29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L29), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L30),\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n33:         PROXY_ADMIN = ProxyAdmin(proxyAdminAddress);\n\n34:         GOVERNANCE = Governance(governanceAddress);\n\n35:         newImplementation = newImplementationAddress;\n\n```\n\n[33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L33), [34](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L34), [35](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L35),\n\n```solidity\nFile: contracts/misc/ProfileCreationProxy.sol\n\n29:         LENS_HANDLES = ILensHandles(lensHandles);\n\n30:         TOKEN_HANDLE_REGISTRY = ITokenHandleRegistry(tokenHandleRegistry);\n\n```\n\n[29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L29), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L30),\n\n```solidity\nFile: contracts/misc/access/ProxyAdmin.sol\n\n18:         previousImplementation = previousImplementation_;\n\n```\n\n[18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L18),\n\n```solidity\nFile: contracts/namespaces/TokenHandleRegistry.sol\n\n43:         LENS_HUB = lensHub;\n\n44:         LENS_HANDLES = lensHandles;\n\n```\n\n[43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L43), [44](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L44),\n\n</details>\n\n### <a name=\"L-09\"></a>[L-09] Initializers can be front-run\nInitializers can be front-run, allowing an attacker to either set their own values, take ownership of the contract, and in the best case forcing a re-deployment\n\n*Instances (2)*:\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n48:     function initialize(uint256 profileId) external override {\n\n```\n\n[48](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L48),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n45:     function initialize(uint256 profileId, uint256 pubId) external override {\n\n```\n\n[45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L45),\n\n### <a name=\"L-10\"></a>[L-10] Int casting `block.timestamp` can reduce the lifespan of a contract\nConsider removing casting to ensure future functionality.\n\n*Instances (3)*:\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n393:         _followDataByFollowTokenId[followTokenId].followTimestamp = uint48(block.timestamp);\n\n396:             _followDataByFollowTokenId[followTokenId].originalFollowTimestamp = uint48(block.timestamp);\n\n```\n\n[393](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L393), [396](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L396),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n365:         _tokenData[tokenId].mintTimestamp = uint96(block.timestamp);\n\n```\n\n[365](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L365),\n\n### <a name=\"L-11\"></a>[L-11] Loss of precision\nDivision by large numbers may result in the result being zero, due to solidity not supporting fractions. Consider requiring a minimum amount for the numerator to ensure that it is always larger than the denominator\n\n*Instances (2)*:\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n55:         return (salePrice * _loadRoyaltiesInBasisPoints()) / BASIS_POINTS;\n\n```\n\n[55](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L55),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n109:         if (newTreasuryFee >= BPS_MAX / 2) revert Errors.InitParamsInvalid();\n\n```\n\n[109](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L109),\n\n### <a name=\"L-12\"></a>[L-12] Missing checks for `ecrecover()` signature malleability\n`ecrecover()` accepts as valid, two versions of signatures, meaning an attacker can use the same signature twice, or an attacker may be able to front-run the original signer with the altered version of the signature, causing the signer's transaction to revert due to nonce reuse. Consider adding checks for signature malleability, or using OpenZeppelin's ECDSA library to perform the extra checks necessary in order to prevent malleability.\n\n*Instances (1)*:\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n478:             address recoveredAddress = ecrecover(digest, signature.v, signature.r, signature.s);\n\n```\n\n[478](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L478),\n\n### <a name=\"L-13\"></a>[L-13] Missing contract-existence checks before low-level calls\nLow-level calls return success if there is no code present at the specified address.\n\n*Instances (1)*:\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n/// @audit executeAsGovernance()\n82:         (bool success, bytes memory returnData) = target.call{gas: gasleft(), value: msg.value}(data);\n\n```\n\n[82](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L82),\n\n### <a name=\"L-14\"></a>[L-14] Missing limits when setting min/max amounts\nThere are some missing limits in these functions, and this could lead to unexpected scenarios. Consider adding a min/max limit for the following values, when appropriate.\n\n*Instances (6)*:\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n48:     function initialize(uint256 profileId) external override {\n\n386:     function _baseFollow(\n\n428:     function _approveFollow(uint256 approvedProfileId, uint256 followTokenId) internal {\n\n480:     function tryMigrate(\n\n```\n\n[48](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L48), [386](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L386), [428](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L428), [480](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L480),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n45:     function initialize(uint256 profileId, uint256 pubId) external override {\n\n45:     function initialize(uint256 profileId, uint256 pubId) external override {\n\n```\n\n[45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L45), [45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L45),\n\n### <a name=\"L-15\"></a>[L-15] NFT doesn't handle hard forks\nWhen there are hard forks, users often have to go through [many hoops](https://twitter.com/elerium115/status/1558471934924431363) to ensure that they control ownership on every fork. Consider adding `require(1 == chain.chainId)`, or the chain ID of whichever chain you prefer, to the functions below, or at least include the chain ID in the URI, so that there is no confusion about which chain is the owner of the NFT.\n\n*Instances (4)*:\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n285:     function tokenURI(uint256 followTokenId) public view override returns (string memory) {\n286:             if (!_exists(followTokenId)) {\n287:                 revert Errors.TokenDoesNotExist();\n288:             }\n289:             return\n290:                 FollowTokenURILib.getTokenURI(\n291:                     followTokenId,\n292:                     _followedProfileId,\n293:                     _followDataByFollowTokenId[followTokenId].originalFollowTimestamp\n294:                 );\n295:         }\n\n```\n\n[285](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L285),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n105:     function tokenURI(uint256 tokenId) public view override(LensBaseERC721, IERC721Metadata) returns (string memory) {\n106:             if (!_exists(tokenId)) {\n107:                 revert Errors.TokenDoesNotExist();\n108:             }\n109:             return ProfileTokenURILib.getTokenURI(tokenId);\n110:         }\n\n```\n\n[105](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L105),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n69:     function tokenURI(uint256 tokenId) public view override returns (string memory) {\n70:            if (!_exists(tokenId)) revert Errors.TokenDoesNotExist();\n71:            return ILensHub(HUB).getContentURI(_profileId, _pubId);\n72:        }\n\n```\n\n[69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L69),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n81:     function tokenURI(uint256 tokenId) public view override returns (string memory) {\n82:            _requireMinted(tokenId);\n83:            return HandleTokenURILib.getTokenURI(tokenId, _localNames[tokenId]);\n84:        }\n\n```\n\n[81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L81),\n\n### <a name=\"L-16\"></a>[L-16] Owner can renounce Ownership\nThe Openzeppelin’s Ownable used in this project contract implements renounceOwnership. This can represent a certain risk if the ownership is renounced for any other reason than by design. Renouncing ownership will leave the contract without an owner, thereby removing any functionality that is only available to the owner.\n\n*Instances (9)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n9: contract LensV2UpgradeContract is ImmutableOwnable {\n\n```\n\n[9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L9),\n\n```solidity\nFile: contracts/misc/ProfileCreationProxy.sol\n\n19: contract ProfileCreationProxy is ImmutableOwnable {\n\n19: contract ProfileCreationProxy is ImmutableOwnable {\n\n19: contract ProfileCreationProxy is ImmutableOwnable {\n\n```\n\n[19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L19), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L19), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L19),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n7: contract ControllableByContract is Ownable {\n\n```\n\n[7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L7),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n12: contract Governance is ControllableByContract {\n\n12: contract Governance is ControllableByContract {\n\n```\n\n[12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L12), [12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L12),\n\n```solidity\nFile: contracts/misc/access/ProxyAdmin.sol\n\n8: contract ProxyAdmin is ControllableByContract {\n\n8: contract ProxyAdmin is ControllableByContract {\n\n```\n\n[8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L8), [8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L8),\n\n</details>\n\n### <a name=\"L-17\"></a>[L-17] Contracts are not using their OZ Upgradeable counterparts\nThe non-upgradeable standard version of OpenZeppelin’s library are inherited / used by the contracts. It would be safer to use the upgradeable versions of the library contracts to avoid unexpected behaviour.\n\nWhere applicable, use the contracts from `@openzeppelin/contracts-upgradeable` instead of `@openzeppelin/contracts`. See [this](https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/tree/master/contracts) for list of available upgradeable contracts\n\n*Instances (31)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n9: import {IERC721} from '@openzeppelin/contracts/token/ERC721/IERC721.sol';\n\n14: import {Strings} from '@openzeppelin/contracts/utils/Strings.sol';\n\n```\n\n[9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L9), [14](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L14),\n\n```solidity\nFile: contracts/libraries/LegacyCollectLib.sol\n\n11: import {Clones} from '@openzeppelin/contracts/proxy/Clones.sol';\n\n12: import {Strings} from '@openzeppelin/contracts/utils/Strings.sol';\n\n```\n\n[11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L11), [12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L12),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n4: import {IERC1271} from '@openzeppelin/contracts/interfaces/IERC1271.sol';\n\n```\n\n[4](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L4),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n6: import {IERC165} from '@openzeppelin/contracts/utils/introspection/IERC165.sol';\n\n7: import {IERC2981} from '@openzeppelin/contracts/interfaces/IERC2981.sol';\n\n```\n\n[6](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L6), [7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L7),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n12: import {IERC721Receiver} from '@openzeppelin/contracts/token/ERC721/IERC721Receiver.sol';\n\n13: import {IERC721Metadata} from '@openzeppelin/contracts/token/ERC721/extensions/IERC721Metadata.sol';\n\n14: import {Address} from '@openzeppelin/contracts/utils/Address.sol';\n\n15: import {Strings} from '@openzeppelin/contracts/utils/Strings.sol';\n\n16: import {ERC165} from '@openzeppelin/contracts/utils/introspection/ERC165.sol';\n\n17: import {IERC165} from '@openzeppelin/contracts/utils/introspection/IERC165.sol';\n\n18: import {IERC721} from '@openzeppelin/contracts/token/ERC721/IERC721.sol';\n\n```\n\n[12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L12), [13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L13), [14](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L14), [15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L15), [16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L16), [17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L17), [18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L18),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n5: import {IERC721} from '@openzeppelin/contracts/token/ERC721/IERC721.sol';\n\n6: import {IERC721Metadata} from '@openzeppelin/contracts/token/ERC721/extensions/IERC721Metadata.sol';\n\n7: import {IERC165} from '@openzeppelin/contracts/utils/introspection/IERC165.sol';\n\n24: import {Address} from '@openzeppelin/contracts/utils/Address.sol';\n\n```\n\n[5](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L5), [6](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L6), [7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L7), [24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L24),\n\n```solidity\nFile: contracts/base/upgradeability/FollowNFTProxy.sol\n\n6: import {Proxy} from '@openzeppelin/contracts/proxy/Proxy.sol';\n\n7: import {Address} from '@openzeppelin/contracts/utils/Address.sol';\n\n```\n\n[6](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L6), [7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L7),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n8: import {IERC721} from '@openzeppelin/contracts/token/ERC721/IERC721.sol';\n\n11: import {Strings} from '@openzeppelin/contracts/utils/Strings.sol';\n\n```\n\n[8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L8), [11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L11),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n5: import {Ownable} from '@openzeppelin/contracts/access/Ownable.sol';\n\n```\n\n[5](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L5),\n\n```solidity\nFile: contracts/misc/access/ProxyAdmin.sol\n\n5: import {TransparentUpgradeableProxy} from '@openzeppelin/contracts/proxy/transparent/TransparentUpgradeableProxy.sol';\n\n```\n\n[5](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L5),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n5: import {ERC721} from '@openzeppelin/contracts/token/ERC721/ERC721.sol';\n\n12: import {Address} from '@openzeppelin/contracts/utils/Address.sol';\n\n13: import {IERC721} from '@openzeppelin/contracts/token/ERC721/IERC721.sol';\n\n```\n\n[5](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L5), [12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L12), [13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L13),\n\n```solidity\nFile: contracts/namespaces/TokenHandleRegistry.sol\n\n5: import {IERC721} from '@openzeppelin/contracts/token/ERC721/IERC721.sol';\n\n```\n\n[5](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L5),\n\n```solidity\nFile: contracts/interfaces/ILensERC721.sol\n\n5: import {IERC721} from '@openzeppelin/contracts/token/ERC721/IERC721.sol';\n\n9: import {IERC721Metadata} from '@openzeppelin/contracts/token/ERC721/extensions/IERC721Metadata.sol';\n\n```\n\n[5](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensERC721.sol#L5), [9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensERC721.sol#L9),\n\n```solidity\nFile: contracts/interfaces/ILensHandles.sol\n\n5: import {IERC721} from '@openzeppelin/contracts/token/ERC721/IERC721.sol';\n\n```\n\n[5](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHandles.sol#L5),\n\n</details>\n\n### <a name=\"L-18\"></a>[L-18] Solidity version 0.8.20 may not work on other chains due to `PUSH0`\nThe compiler for Solidity 0.8.20 switches the default target EVM version to [Shanghai](https://blog.soliditylang.org/2023/05/10/solidity-0.8.20-release-announcement/#important-note), which includes the new PUSH0 op code. This op code may not yet be implemented on all L2s, so deployment on these chains will fail. To work around this issue, use an earlier [EVM](https://docs.soliditylang.org/en/v0.8.20/using-the-compiler.html?ref=zaryabs.com#setting-the-evm-version-to-target) [version](https://book.getfoundry.sh/reference/config/solidity-compiler#evm_version)\n\n*Instances (63)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/LensHub.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L3),\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L3),\n\n```solidity\nFile: contracts/libraries/ActionLib.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L3),\n\n```solidity\nFile: contracts/libraries/FollowLib.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L3),\n\n```solidity\nFile: contracts/libraries/GovernanceLib.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L3),\n\n```solidity\nFile: contracts/libraries/LegacyCollectLib.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L3),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n2: pragma solidity ^0.8.15;\n\n```\n\n[2](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L2),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n3: pragma solidity ^0.8.19;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L3),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L3),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L3),\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L3),\n\n```solidity\nFile: contracts/libraries/ValidationLib.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L3),\n\n```solidity\nFile: contracts/libraries/constants/Errors.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L3),\n\n```solidity\nFile: contracts/libraries/constants/Events.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L3),\n\n```solidity\nFile: contracts/libraries/constants/Typehash.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L3),\n\n```solidity\nFile: contracts/libraries/constants/Types.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L3),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n3: pragma solidity ^0.8.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L3),\n\n```solidity\nFile: contracts/base/HubRestricted.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/HubRestricted.sol#L3),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n3: pragma solidity ^0.8.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L3),\n\n```solidity\nFile: contracts/base/LensGovernable.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L3),\n\n```solidity\nFile: contracts/base/LensHubEventHooks.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubEventHooks.sol#L3),\n\n```solidity\nFile: contracts/base/LensHubStorage.sol\n\n3: pragma solidity ^0.8.18;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L3),\n\n```solidity\nFile: contracts/base/LensImplGetters.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensImplGetters.sol#L3),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L3),\n\n```solidity\nFile: contracts/base/upgradeability/FollowNFTProxy.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L3),\n\n```solidity\nFile: contracts/misc/ImmutableOwnable.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L3),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L3),\n\n```solidity\nFile: contracts/misc/LensV2Migration.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L3),\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n3: pragma solidity ^0.8.19;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L3),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L3),\n\n```solidity\nFile: contracts/misc/ProfileCreationProxy.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L3),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L3),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L3),\n\n```solidity\nFile: contracts/misc/access/ProxyAdmin.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L3),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n3: pragma solidity ^0.8.18;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L3),\n\n```solidity\nFile: contracts/namespaces/TokenHandleRegistry.sol\n\n3: pragma solidity ^0.8.18;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L3),\n\n```solidity\nFile: contracts/namespaces/constants/Errors.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L3),\n\n```solidity\nFile: contracts/namespaces/constants/Events.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Events.sol#L3),\n\n```solidity\nFile: contracts/namespaces/constants/Types.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Types.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ICollectModule.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ICollectModule.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ICollectNFT.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ICollectNFT.sol#L3),\n\n```solidity\nFile: contracts/interfaces/IERC721Burnable.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IERC721Burnable.sol#L3),\n\n```solidity\nFile: contracts/interfaces/IERC721MetaTx.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IERC721MetaTx.sol#L3),\n\n```solidity\nFile: contracts/interfaces/IERC721Timestamped.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IERC721Timestamped.sol#L3),\n\n```solidity\nFile: contracts/interfaces/IFollowModule.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowModule.sol#L3),\n\n```solidity\nFile: contracts/interfaces/IFollowNFT.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILegacyCollectModule.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyCollectModule.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILegacyCollectNFT.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyCollectNFT.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILegacyFollowModule.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyFollowModule.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILegacyReferenceModule.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyReferenceModule.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensERC721.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensERC721.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensGovernable.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensHandles.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHandles.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensHub.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHub.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensHubEventHooks.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHubEventHooks.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensHubInitializable.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHubInitializable.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensImplGetters.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensImplGetters.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensProfiles.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProfiles.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensProtocol.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L3),\n\n```solidity\nFile: contracts/interfaces/IModuleGlobals.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L3),\n\n```solidity\nFile: contracts/interfaces/IPublicationActionModule.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IPublicationActionModule.sol#L3),\n\n```solidity\nFile: contracts/interfaces/IReferenceModule.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IReferenceModule.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ITokenHandleRegistry.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ITokenHandleRegistry.sol#L3),\n\n</details>\n\n### <a name=\"L-19\"></a>[L-19] Storage Write Removal Bug On Conditional Early Termination\nSee the following for more info:\n-[https://twitter.com/solidity_lang/status/1567953562151579650?s=20&t=fXIo4hRjOiMXl2dqpD5Oyw](https://twitter.com/solidity_lang/status/1567953562151579650?s=20&t=fXIo4hRjOiMXl2dqpD5Oyw)-[https://blog.soliditylang.org/2022/09/08/storage-write-removal-before-conditional-termination/](https://blog.soliditylang.org/2022/09/08/storage-write-removal-before-conditional-termination/)\n\n*Instances (12)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n467:     function _getRoyaltiesInBasisPointsSlot() internal pure override returns (uint256) {\n468:             uint256 slot;\n469:             assembly {\n470:                 slot := _royaltiesInBasisPoints.slot\n471:             }\n472:             return slot;\n473:         }\n\n467:     function _getRoyaltiesInBasisPointsSlot() internal pure override returns (uint256) {\n468:             uint256 slot;\n469:             assembly {\n470:                 slot := _royaltiesInBasisPoints.slot\n471:             }\n472:             return slot;\n473:         }\n\n```\n\n[467](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L467), [467](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L467),\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n165:     function incrementMaxActionModuleIdUsed() internal returns (uint256) {\n166:             uint256 incrementedId;\n167:             assembly {\n168:                 incrementedId := add(sload(MAX_ACTION_MODULE_ID_USED_SLOT), 1)\n169:                 sstore(MAX_ACTION_MODULE_ID_USED_SLOT, incrementedId)\n170:             }\n171:             if (incrementedId > MAX_ACTION_MODULE_ID_SUPPORTED) {\n172:                 revert Errors.MaxActionModuleIdReached();\n173:             }\n174:             return incrementedId;\n175:         }\n\n165:     function incrementMaxActionModuleIdUsed() internal returns (uint256) {\n166:             uint256 incrementedId;\n167:             assembly {\n168:                 incrementedId := add(sload(MAX_ACTION_MODULE_ID_USED_SLOT), 1)\n169:                 sstore(MAX_ACTION_MODULE_ID_USED_SLOT, incrementedId)\n170:             }\n171:             if (incrementedId > MAX_ACTION_MODULE_ID_SUPPORTED) {\n172:                 revert Errors.MaxActionModuleIdReached();\n173:             }\n174:             return incrementedId;\n175:         }\n\n```\n\n[165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L165), [165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L165),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n338:                 assembly {\n339:                         /// Equivalent to reverting with the returned error selector if\n340:                         /// the length is not zero.\n341:                         let length := mload(err)\n342:                         if iszero(iszero(length)) {\n343:                             revert(add(err, 32), length)\n344:                         }\n345:                     }\n\n391:                 assembly {\n392:                         /// Equivalent to reverting with the returned error selector if\n393:                         /// the length is not zero.\n394:                         let length := mload(err)\n395:                         if iszero(iszero(length)) {\n396:                             revert(add(err, 32), length)\n397:                         }\n398:                     }\n\n444:                 assembly {\n445:                         /// Equivalent to reverting with the returned error selector if\n446:                         /// the length is not zero.\n447:                         let length := mload(err)\n448:                         if iszero(iszero(length)) {\n449:                             revert(add(err, 32), length)\n450:                         }\n451:                     }\n\n```\n\n[338](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L338), [391](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L391), [444](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L444),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n65:     function _loadRoyaltiesInBasisPoints() internal view virtual returns (uint256) {\n66:            uint256 royaltiesInBasisPointsSlot = _getRoyaltiesInBasisPointsSlot();\n67:            uint256 royaltyAmount;\n68:            assembly {\n69:                royaltyAmount := sload(royaltiesInBasisPointsSlot)\n70:            }\n71:            return royaltyAmount;\n72:        }\n\n65:     function _loadRoyaltiesInBasisPoints() internal view virtual returns (uint256) {\n66:            uint256 royaltiesInBasisPointsSlot = _getRoyaltiesInBasisPointsSlot();\n67:            uint256 royaltyAmount;\n68:            assembly {\n69:                royaltyAmount := sload(royaltiesInBasisPointsSlot)\n70:            }\n71:            return royaltyAmount;\n72:        }\n\n```\n\n[65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L65), [65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L65),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n116:     function _getRoyaltiesInBasisPointsSlot() internal pure override returns (uint256) {\n117:             uint256 slot;\n118:             assembly {\n119:                 slot := _royaltiesInBasisPoints.slot\n120:             }\n121:             return slot;\n122:         }\n\n116:     function _getRoyaltiesInBasisPointsSlot() internal pure override returns (uint256) {\n117:             uint256 slot;\n118:             assembly {\n119:                 slot := _royaltiesInBasisPoints.slot\n120:             }\n121:             return slot;\n122:         }\n\n```\n\n[116](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L116), [116](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L116),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n86:             assembly {\n87:                    revert(add(returnData, 32), len)\n88:                }\n\n```\n\n[86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L86),\n\n</details>\n\n### <a name=\"L-20\"></a>[L-20] `tokenURI()` does not follow EIP-721\nThe [EIP](https://eips.ethereum.org/EIPS/eip-721) states that `tokenURI()` \"Throws if `_tokenId` is not a valid NFT\", which the code below does not do. If the NFT has not yet been minted, `tokenURI()` should revert\n\n*Instances (4)*:\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n285:     function tokenURI(uint256 followTokenId) public view override returns (string memory) {\n\n```\n\n[285](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L285),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n105:     function tokenURI(uint256 tokenId) public view override(LensBaseERC721, IERC721Metadata) returns (string memory) {\n\n```\n\n[105](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L105),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n69:     function tokenURI(uint256 tokenId) public view override returns (string memory) {\n\n```\n\n[69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L69),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n81:     function tokenURI(uint256 tokenId) public view override returns (string memory) {\n\n```\n\n[81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L81),\n\n### <a name=\"L-21\"></a>[L-21] Unsafe downcast\nWhen a type is downcast to a smaller type, the higher order bits are truncated, effectively applying a modulo to the original value. Without any other checks, this wrapping will lead to unexpected behavior and bugs\n\n*Instances (3)*:\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n/// @audit uint160\n392:         _followDataByFollowTokenId[followTokenId].followerProfileId = uint160(followerProfileId);\n\n/// @audit uint160\n514:         _followDataByFollowTokenId[followTokenId].followerProfileId = uint160(followerProfileId);\n\n```\n\n[392](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L392), [514](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L514),\n\n```solidity\nFile: contracts/libraries/GovernanceLib.sol\n\n/// @audit uint248\n100:                 uint248(id),\n\n```\n\n[100](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L100),\n\n### <a name=\"L-22\"></a>[L-22] Unsafe ERC20 operation(s)\n\n*Instances (4)*:\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n117:         super.approve(to, tokenId);\n\n```\n\n[117](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L117),\n\n```solidity\nFile: contracts/misc/ProfileCreationProxy.sol\n\n58:         LENS_HANDLES.transferFrom(address(this), destination, handleId);\n\n59:         ILensHub(LENS_HUB).transferFrom(address(this), destination, profileId);\n\n```\n\n[58](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L58), [59](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L59),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n144:         super.approve(to, tokenId);\n\n```\n\n[144](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L144),\n\n### <a name=\"L-23\"></a>[L-23] Unspecific compiler version pragma\n\n*Instances (30)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/libraries/constants/Errors.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L3),\n\n```solidity\nFile: contracts/libraries/constants/Events.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L3),\n\n```solidity\nFile: contracts/libraries/constants/Typehash.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L3),\n\n```solidity\nFile: contracts/libraries/constants/Types.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L3),\n\n```solidity\nFile: contracts/namespaces/constants/Errors.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L3),\n\n```solidity\nFile: contracts/namespaces/constants/Events.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Events.sol#L3),\n\n```solidity\nFile: contracts/namespaces/constants/Types.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Types.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ICollectModule.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ICollectModule.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ICollectNFT.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ICollectNFT.sol#L3),\n\n```solidity\nFile: contracts/interfaces/IERC721Burnable.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IERC721Burnable.sol#L3),\n\n```solidity\nFile: contracts/interfaces/IERC721MetaTx.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IERC721MetaTx.sol#L3),\n\n```solidity\nFile: contracts/interfaces/IERC721Timestamped.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IERC721Timestamped.sol#L3),\n\n```solidity\nFile: contracts/interfaces/IFollowModule.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowModule.sol#L3),\n\n```solidity\nFile: contracts/interfaces/IFollowNFT.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILegacyCollectModule.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyCollectModule.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILegacyCollectNFT.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyCollectNFT.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILegacyReferenceModule.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyReferenceModule.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensERC721.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensERC721.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensGovernable.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensHandles.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHandles.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensHub.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHub.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensHubEventHooks.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHubEventHooks.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensHubInitializable.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHubInitializable.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensImplGetters.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensImplGetters.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensProfiles.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProfiles.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILensProtocol.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L3),\n\n```solidity\nFile: contracts/interfaces/IModuleGlobals.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L3),\n\n```solidity\nFile: contracts/interfaces/IPublicationActionModule.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IPublicationActionModule.sol#L3),\n\n```solidity\nFile: contracts/interfaces/IReferenceModule.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IReferenceModule.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ITokenHandleRegistry.sol\n\n3: pragma solidity >=0.6.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ITokenHandleRegistry.sol#L3),\n\n</details>\n\n### <a name=\"L-24\"></a>[L-24] TransferOwnership Should Be Two Step\nRecommend considering implementing a two step process where the owner or admin nominates an account and the nominated account needs to call an acceptOwnership() function for the transfer of ownership to fully succeed. This ensures the nominated EOA account is a valid and active account.\n\n*Instances (1)*:\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n22:         _transferOwnership(owner);\n\n```\n\n[22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L22),\n\n### <a name=\"L-25\"></a>[L-25] Use `Ownable2Step` rather than `Ownable`\n[Ownable2Step](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/3d7a93876a2e5e1d7fe29b5a0e96e222afdc4cfa/contracts/access/Ownable2Step.sol#L31-L56) and [Ownable2StepUpgradeable](https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/blob/25aabd286e002a1526c345c8db259d57bdf0ad28/contracts/access/Ownable2StepUpgradeable.sol#L47-L63) prevent the contract ownership from mistakenly being transferred to an address that cannot handle it (e.g. due to a typo in the address), by requiring that the recipient of the owner permissions actively accept via a contract call of its own.\n\n*Instances (1)*:\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n7: contract ControllableByContract is Ownable {\n\n```\n\n[7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L7),\n\n### <a name=\"L-26\"></a>[L-26] Using zero as a parameter\nTaking `0` as a valid argument in Solidity without checks can lead to severe security issues. A historical example is the infamous `0x0` address bug where numerous tokens were lost. This happens because `0` can be interpreted as an uninitialized `address`, leading to transfers to the `0x0` `address`, effectively burning tokens. Moreover, `0` as a denominator in division operations would cause a runtime exception. It's also often indicative of a logical error in the caller's code. It's important to always validate input and handle edge cases like `0` appropriately. Use `require()` statements to enforce conditions and provide clear error messages to facilitate debugging and safer code.\n\n*Instances (8)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n331:             _approveFollow(0, followTokenId);\n\n444:             _approveFollow(0, followTokenId);\n\n```\n\n[331](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L331), [444](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L444),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n173:             delegatedExecutors: new address[](0),\n\n174:             approvals: new bool[](0),\n\n```\n\n[173](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L173), [174](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L174),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n529:             return new bytes(0);\n\n```\n\n[529](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L529),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n82:         emit Events.TokenGuardianStateChanged({\n\n```\n\n[82](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L82),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n131:         emit HandlesEvents.TokenGuardianStateChanged({\n\n271:         super._beforeTokenTransfer(from, to, 0, batchSize);\n\n```\n\n[131](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L131), [271](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L271),\n\n</details>\n\n### <a name=\"L-27\"></a>[L-27] Vulnerable versions of packages are being used\nThis project's specific package versions are vulnerable to the specific CVEs listed below. Consider switching to more recent versions of these packages that don't have these vulnerabilities.\n-[CVE-2023-26488](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-26488) - MEDIUM - OpenZeppelin Contracts is a library for secure smart contract development. The ERC721Consecutive contract designed for minting NFTs in batches does not update balances when a batch has size 1 and consists of a single token. Subsequent transfers from the receiver of that token may overflow the balance as reported by `balanceOf`. The issue exclusively presents with batches of size 1. The issue has been patched in 4.8.2. (@openzeppelin/contracts >=4.8.0 <4.8.2)-[CVE-2023-30541](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30541) - MEDIUM - OpenZeppelin Contracts is a library for secure smart contract development. A function in the implementation contract may be inaccessible if its selector clashes with one of the proxy's own selectors. Specifically, if the clashing function has a different signature with incompatible ABI encoding, the proxy could revert while attempting to decode the arguments from calldata. The probability of an accidental clash is negligible, but one could be caused deliberately and could cause a reduction in availability. The issue has been fixed in version 4.8.3. As a workaround if a function appears to be inaccessible for this reason, it may be possible to craft the calldata such that ABI decoding does not fail at the proxy and the function is properly proxied through. (@openzeppelin/contracts >=3.2.0 <4.8.3)-[CVE-2023-30542](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30542) - HIGH - OpenZeppelin Contracts is a library for secure smart contract development. The proposal creation entrypoint (`propose`) in `GovernorCompatibilityBravo` allows the creation of proposals with a `signatures` array shorter than the `calldatas` array. This causes the additional elements of the latter to be ignored, and if the proposal succeeds the corresponding actions would eventually execute without any calldata. The `ProposalCreated` event correctly represents what will eventually execute, but the proposal parameters as queried through `getActions` appear to respect the original intended calldata. This issue has been patched in 4.8.3. As a workaround, ensure that all proposals that pass through governance have equal length `signatures` and `calldatas` parameters. (@openzeppelin/contracts >=4.3.0 <4.8.3)\n\n*Instances (1)*:\n\n```solidity\nFile: Various Files\n\n/// @audit Vulnerabilities\n1: \n\n```\n\n\n\n\n## Non-critical Issues\n\n### <a name=\"N-01\"></a>[N-01] Large assembly blocks should have extensive comments\nAssembly blocks are take a lot more time to audit than normal Solidity code, and often have gotchas and side-effects that the Solidity versions of the same code do not. Consider adding more comments explaining what is being done in every step of the assembly code\n\n*Instances (35)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n469:         assembly {\n470:                 slot := _royaltiesInBasisPoints.slot\n471:             }\n\n```\n\n[469](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L469),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n199:         assembly {\n200:                 let lengthWithoutOffset := sub(mload(encodedStruct), 32) // Calculates length without offset.\n201:                 encodedStruct := add(encodedStruct, 32) // Skips the offset by shifting the memory pointer.\n202:                 mstore(encodedStruct, lengthWithoutOffset) // Stores new length, which now excludes the offset.\n203:             }\n\n```\n\n[199](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L199),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n77:                 assembly {\n78:                        let handle_length := mload(handle)\n79:                        mstore(handle, sub(handle_length, DOT_LENS_SUFFIX_LENGTH)) // Cut 5 chars (.lens) from the end\n80:                    }\n\n```\n\n[77](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L77),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n209:         assembly {\n210:                 referencePubParams := quoteParams\n211:             }\n\n220:         assembly {\n221:                 referencePubParams := commentParams\n222:             }\n\n338:                 assembly {\n339:                         /// Equivalent to reverting with the returned error selector if\n340:                         /// the length is not zero.\n341:                         let length := mload(err)\n342:                         if iszero(iszero(length)) {\n343:                             revert(add(err, 32), length)\n344:                         }\n345:                     }\n\n391:                 assembly {\n392:                         /// Equivalent to reverting with the returned error selector if\n393:                         /// the length is not zero.\n394:                         let length := mload(err)\n395:                         if iszero(iszero(length)) {\n396:                             revert(add(err, 32), length)\n397:                         }\n398:                     }\n\n444:                 assembly {\n445:                         /// Equivalent to reverting with the returned error selector if\n446:                         /// the length is not zero.\n447:                         let length := mload(err)\n448:                         if iszero(iszero(length)) {\n449:                             revert(add(err, 32), length)\n450:                         }\n451:                     }\n\n```\n\n[209](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L209), [220](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L220), [338](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L338), [391](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L391), [444](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L444),\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n54:         assembly {\n55:                mstore(0, profileId)\n56:                mstore(32, PUBLICATIONS_MAPPING_SLOT)\n57:                mstore(32, keccak256(0, 64))\n58:                mstore(0, pubId)\n59:                _publication.slot := keccak256(0, 64)\n60:            }\n\n64:         assembly {\n65:                mstore(0, profileId)\n66:                mstore(32, PROFILES_MAPPING_SLOT)\n67:                _profiles.slot := keccak256(0, 64)\n68:            }\n\n76:         assembly {\n77:                mstore(0, delegatorProfileId)\n78:                mstore(32, DELEGATED_EXECUTOR_CONFIG_MAPPING_SLOT)\n79:                _delegatedExecutorsConfig.slot := keccak256(0, 64)\n80:            }\n\n88:         assembly {\n89:                _tokenGuardianDisablingTimestamp.slot := TOKEN_GUARDIAN_DISABLING_TIMESTAMP_MAPPING_SLOT\n90:            }\n\n94:         assembly {\n95:                mstore(0, tokenId)\n96:                mstore(32, TOKEN_DATA_MAPPING_SLOT)\n97:                _tokenData.slot := keccak256(0, 64)\n98:            }\n\n106:         assembly {\n107:                 mstore(0, blockerProfileId)\n108:                 mstore(32, BLOCKED_STATUS_MAPPING_SLOT)\n109:                 _blockedStatus.slot := keccak256(0, 64)\n110:             }\n\n114:         assembly {\n115:                 _nonces.slot := SIG_NONCES_MAPPING_SLOT\n116:             }\n\n124:         assembly {\n125:                 _profileIdByHandleHash.slot := PROFILE_ID_BY_HANDLE_HASH_MAPPING_SLOT\n126:             }\n\n134:         assembly {\n135:                 _profileCreatorWhitelisted.slot := PROFILE_CREATOR_WHITELIST_MAPPING_SLOT\n136:             }\n\n144:         assembly {\n145:                 _followModuleWhitelisted.slot := FOLLOW_MODULE_WHITELIST_MAPPING_SLOT\n146:             }\n\n154:         assembly {\n155:                 _actionModuleWhitelistData.slot := ACTION_MODULE_WHITELIST_DATA_MAPPING_SLOT\n156:             }\n\n160:         assembly {\n161:                 _actionModules.slot := ACTION_MODULES_SLOT\n162:             }\n\n167:         assembly {\n168:                 incrementedId := add(sload(MAX_ACTION_MODULE_ID_USED_SLOT), 1)\n169:                 sstore(MAX_ACTION_MODULE_ID_USED_SLOT, incrementedId)\n170:             }\n\n182:         assembly {\n183:                 _referenceModuleWhitelisted.slot := REFERENCE_MODULE_WHITELIST_MAPPING_SLOT\n184:             }\n\n188:         assembly {\n189:                 _governance := sload(GOVERNANCE_SLOT)\n190:             }\n\n194:         assembly {\n195:                 sstore(GOVERNANCE_SLOT, newGovernance)\n196:             }\n\n200:         assembly {\n201:                 _emergencyAdmin := sload(EMERGENCY_ADMIN_SLOT)\n202:             }\n\n206:         assembly {\n207:                 sstore(EMERGENCY_ADMIN_SLOT, newEmergencyAdmin)\n208:             }\n\n212:         assembly {\n213:                 _state := sload(PROTOCOL_STATE_SLOT)\n214:             }\n\n218:         assembly {\n219:                 sstore(PROTOCOL_STATE_SLOT, newState)\n220:             }\n\n224:         assembly {\n225:                 _lastInitializedRevision := sload(LAST_INITIALIZED_REVISION_SLOT)\n226:             }\n\n230:         assembly {\n231:                 sstore(LAST_INITIALIZED_REVISION_SLOT, newLastInitializedRevision)\n232:             }\n\n```\n\n[54](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L54), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L64), [76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L76), [88](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L88), [94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L94), [106](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L106), [114](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L114), [124](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L124), [134](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L134), [144](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L144), [154](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L154), [160](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L160), [167](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L167), [182](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L182), [188](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L188), [194](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L194), [200](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L200), [206](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L206), [212](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L212), [218](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L218), [224](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L224), [230](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L230),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n60:         assembly {\n61:                sstore(royaltiesInBasisPointsSlot, royaltiesInBasisPoints)\n62:            }\n\n68:         assembly {\n69:                royaltyAmount := sload(royaltiesInBasisPointsSlot)\n70:            }\n\n```\n\n[60](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L60), [68](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L68),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n482:                     assembly {\n483:                             revert(add(32, reason), mload(reason))\n484:                         }\n\n```\n\n[482](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L482),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n118:         assembly {\n119:                 slot := _royaltiesInBasisPoints.slot\n120:             }\n\n```\n\n[118](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L118),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n86:             assembly {\n87:                    revert(add(returnData, 32), len)\n88:                }\n\n```\n\n[86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L86),\n\n</details>\n\n### <a name=\"N-02\"></a>[N-02]  `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()`\nUse `abi.encode()` instead which will pad items to 32 bytes, which will [prevent hash collisions](https://docs.soliditylang.org/en/v0.8.13/abi-spec.html#non-standard-packed-mode) (e.g. `abi.encodePacked(0x123,0x456)` => `0x123456` => `abi.encodePacked(0x1,0x23456)`, but `abi.encode(0x123,0x456)` => `0x0...1230...456`). \"Unless there is a compelling reason, `abi.encode` should be preferred\". If there is only one argument to `abi.encodePacked()` it can often be cast to `bytes()` or `bytes32()` [instead](https://ethereum.stackexchange.com/questions/30912/how-to-compare-strings-in-solidity#answer-82739).\nIf all arguments are strings and or bytes, `bytes.concat()` should be used instead\n\n*Instances (8)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n169:         return keccak256(abi.encodePacked(actionModulesInitDatasHashes));\n\n345:                         keccak256(abi.encodePacked(idsOfProfilesToFollow)),\n\n346:                         keccak256(abi.encodePacked(followTokenIds)),\n\n347:                         keccak256(abi.encodePacked(dataHashes)),\n\n368:                         keccak256(abi.encodePacked(idsOfProfilesToUnfollow)),\n\n390:                         keccak256(abi.encodePacked(idsOfProfilesToSetBlockStatus)),\n\n391:                         keccak256(abi.encodePacked(blockStatus)),\n\n493:         return keccak256(abi.encodePacked('\\x19\\x01', calculateDomainSeparator(), hashedMessage));\n\n```\n\n[169](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L169), [345](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L345), [346](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L346), [347](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L347), [368](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L368), [390](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L390), [391](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L391), [493](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L493),\n\n</details>\n\n### <a name=\"N-03\"></a>[N-03] Avoid the use of sensitive terms\nUse [alternative variants](https://www.zdnet.com/article/mysql-drops-master-slave-and-blacklist-whitelist-terminology/), e.g. allowlist/denylist instead of whitelist/blacklist.\n\n*Instances (319)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/LensHub.sol\n\n/// @audit whitelist\n95:         ValidationLib.validateProfileCreatorWhitelisted(msg.sender);\n\n```\n\n[95](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L95),\n\n```solidity\nFile: contracts/libraries/ActionLib.sol\n\n/// @audit whitelist\n29:         uint256 actionModuleId = StorageLib.actionModuleWhitelistData()[actionModuleAddress].id;\n\n```\n\n[29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L29),\n\n```solidity\nFile: contracts/libraries/GovernanceLib.sol\n\n/// @audit whitelist\n71:     function whitelistProfileCreator(address profileCreator, bool whitelist) external {\n\n/// @audit whitelist\n71:     function whitelistProfileCreator(address profileCreator, bool whitelist) external {\n\n/// @audit whitelist\n72:         StorageLib.profileCreatorWhitelisted()[profileCreator] = whitelist;\n\n/// @audit whitelist\n72:         StorageLib.profileCreatorWhitelisted()[profileCreator] = whitelist;\n\n/// @audit whitelist\n73:         emit Events.ProfileCreatorWhitelisted(profileCreator, whitelist, block.timestamp);\n\n/// @audit whitelist\n73:         emit Events.ProfileCreatorWhitelisted(profileCreator, whitelist, block.timestamp);\n\n/// @audit whitelist\n76:     function whitelistFollowModule(address followModule, bool whitelist) external {\n\n/// @audit whitelist\n76:     function whitelistFollowModule(address followModule, bool whitelist) external {\n\n/// @audit whitelist\n77:         StorageLib.followModuleWhitelisted()[followModule] = whitelist;\n\n/// @audit whitelist\n77:         StorageLib.followModuleWhitelisted()[followModule] = whitelist;\n\n/// @audit whitelist\n78:         emit Events.FollowModuleWhitelisted(followModule, whitelist, block.timestamp);\n\n/// @audit whitelist\n78:         emit Events.FollowModuleWhitelisted(followModule, whitelist, block.timestamp);\n\n/// @audit whitelist\n81:     function whitelistReferenceModule(address referenceModule, bool whitelist) external {\n\n/// @audit whitelist\n81:     function whitelistReferenceModule(address referenceModule, bool whitelist) external {\n\n/// @audit whitelist\n82:         StorageLib.referenceModuleWhitelisted()[referenceModule] = whitelist;\n\n/// @audit whitelist\n82:         StorageLib.referenceModuleWhitelisted()[referenceModule] = whitelist;\n\n/// @audit whitelist\n83:         emit Events.ReferenceModuleWhitelisted(referenceModule, whitelist, block.timestamp);\n\n/// @audit whitelist\n83:         emit Events.ReferenceModuleWhitelisted(referenceModule, whitelist, block.timestamp);\n\n/// @audit whitelist\n86:     function whitelistActionModule(address actionModule, bool whitelist) external {\n\n/// @audit whitelist\n86:     function whitelistActionModule(address actionModule, bool whitelist) external {\n\n/// @audit whitelist\n87:         Types.ActionModuleWhitelistData memory actionModuleWhitelistData = StorageLib.actionModuleWhitelistData()[\n\n/// @audit whitelist\n87:         Types.ActionModuleWhitelistData memory actionModuleWhitelistData = StorageLib.actionModuleWhitelistData()[\n\n/// @audit whitelist\n87:         Types.ActionModuleWhitelistData memory actionModuleWhitelistData = StorageLib.actionModuleWhitelistData()[\n\n/// @audit whitelist\n92:         if (actionModuleWhitelistData.id == 0) {\n\n/// @audit whitelist\n93:             // The action module with the given address wasn't whitelisted before, a new ID is assigned to it.\n\n/// @audit whitelist\n94:             if (!whitelist) {\n\n/// @audit whitelist\n95:                 revert Errors.NotWhitelisted();\n\n/// @audit whitelist\n99:             StorageLib.actionModuleWhitelistData()[actionModule] = Types.ActionModuleWhitelistData(\n\n/// @audit whitelist\n99:             StorageLib.actionModuleWhitelistData()[actionModule] = Types.ActionModuleWhitelistData(\n\n/// @audit whitelist\n101:                 whitelist\n\n/// @audit whitelist\n105:             // The action module with the given address was already whitelisted before, it has an ID already assigned.\n\n/// @audit whitelist\n106:             StorageLib.actionModuleWhitelistData()[actionModule].isWhitelisted = whitelist;\n\n/// @audit whitelist\n106:             StorageLib.actionModuleWhitelistData()[actionModule].isWhitelisted = whitelist;\n\n/// @audit whitelist\n106:             StorageLib.actionModuleWhitelistData()[actionModule].isWhitelisted = whitelist;\n\n/// @audit whitelist\n107:             id = actionModuleWhitelistData.id;\n\n/// @audit whitelist\n109:         emit Events.ActionModuleWhitelisted(actionModule, id, whitelist, block.timestamp);\n\n/// @audit whitelist\n109:         emit Events.ActionModuleWhitelisted(actionModule, id, whitelist, block.timestamp);\n\n```\n\n[71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L71), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L71), [72](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L72), [72](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L72), [73](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L73), [73](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L73), [76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L76), [76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L76), [77](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L77), [77](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L77), [78](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L78), [78](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L78), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L81), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L81), [82](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L82), [82](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L82), [83](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L83), [83](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L83), [86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L86), [86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L86), [87](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L87), [87](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L87), [87](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L87), [92](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L92), [93](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L93), [94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L94), [95](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L95), [99](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L99), [99](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L99), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L101), [105](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L105), [106](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L106), [106](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L106), [106](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L106), [107](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L107), [109](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L109), [109](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L109),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n/// @audit whitelist\n54:             // We don't need to check for deprecated modules here because deprecated ones are no longer whitelisted.\n\n/// @audit whitelist\n116:         ValidationLib.validateFollowModuleWhitelisted(followModule);\n\n```\n\n[54](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L54), [116](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L116),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n/// @audit whitelist\n488:             Types.ActionModuleWhitelistData memory actionModuleWhitelistData = StorageLib.actionModuleWhitelistData()[\n\n/// @audit whitelist\n488:             Types.ActionModuleWhitelistData memory actionModuleWhitelistData = StorageLib.actionModuleWhitelistData()[\n\n/// @audit whitelist\n488:             Types.ActionModuleWhitelistData memory actionModuleWhitelistData = StorageLib.actionModuleWhitelistData()[\n\n/// @audit whitelist\n492:             if (!actionModuleWhitelistData.isWhitelisted) {\n\n/// @audit whitelist\n492:             if (!actionModuleWhitelistData.isWhitelisted) {\n\n/// @audit whitelist\n493:                 revert Errors.NotWhitelisted();\n\n/// @audit whitelist\n496:             uint256 actionModuleIdBitmapMask = 1 << (actionModuleWhitelistData.id - 1);\n\n/// @audit whitelist\n531:         ValidationLib.validateReferenceModuleWhitelisted(referenceModule);\n\n```\n\n[488](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L488), [488](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L488), [488](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L488), [492](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L492), [492](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L492), [493](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L493), [496](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L496), [531](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L531),\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n/// @audit whitelist\n22:     uint256 constant PROFILE_CREATOR_WHITELIST_MAPPING_SLOT = 13;\n\n/// @audit whitelist\n23:     uint256 constant FOLLOW_MODULE_WHITELIST_MAPPING_SLOT = 14;\n\n/// @audit whitelist\n24:     uint256 constant ACTION_MODULE_WHITELIST_DATA_MAPPING_SLOT = 15;\n\n/// @audit whitelist\n25:     uint256 constant REFERENCE_MODULE_WHITELIST_MAPPING_SLOT = 16;\n\n/// @audit whitelist\n129:     function profileCreatorWhitelisted()\n\n/// @audit whitelist\n132:         returns (mapping(address => bool) storage _profileCreatorWhitelisted)\n\n/// @audit whitelist\n135:             _profileCreatorWhitelisted.slot := PROFILE_CREATOR_WHITELIST_MAPPING_SLOT\n\n/// @audit whitelist\n135:             _profileCreatorWhitelisted.slot := PROFILE_CREATOR_WHITELIST_MAPPING_SLOT\n\n/// @audit whitelist\n139:     function followModuleWhitelisted()\n\n/// @audit whitelist\n142:         returns (mapping(address => bool) storage _followModuleWhitelisted)\n\n/// @audit whitelist\n145:             _followModuleWhitelisted.slot := FOLLOW_MODULE_WHITELIST_MAPPING_SLOT\n\n/// @audit whitelist\n145:             _followModuleWhitelisted.slot := FOLLOW_MODULE_WHITELIST_MAPPING_SLOT\n\n/// @audit whitelist\n149:     function actionModuleWhitelistData()\n\n/// @audit whitelist\n152:         returns (mapping(address => Types.ActionModuleWhitelistData) storage _actionModuleWhitelistData)\n\n/// @audit whitelist\n152:         returns (mapping(address => Types.ActionModuleWhitelistData) storage _actionModuleWhitelistData)\n\n/// @audit whitelist\n155:             _actionModuleWhitelistData.slot := ACTION_MODULE_WHITELIST_DATA_MAPPING_SLOT\n\n/// @audit whitelist\n155:             _actionModuleWhitelistData.slot := ACTION_MODULE_WHITELIST_DATA_MAPPING_SLOT\n\n/// @audit whitelist\n177:     function referenceModuleWhitelisted()\n\n/// @audit whitelist\n180:         returns (mapping(address => bool) storage _referenceModuleWhitelisted)\n\n/// @audit whitelist\n183:             _referenceModuleWhitelisted.slot := REFERENCE_MODULE_WHITELIST_MAPPING_SLOT\n\n/// @audit whitelist\n183:             _referenceModuleWhitelisted.slot := REFERENCE_MODULE_WHITELIST_MAPPING_SLOT\n\n```\n\n[22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L22), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L23), [24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L24), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L25), [129](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L129), [132](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L132), [135](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L135), [135](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L135), [139](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L139), [142](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L142), [145](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L145), [145](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L145), [149](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L149), [152](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L152), [152](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L152), [155](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L155), [155](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L155), [177](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L177), [180](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L180), [183](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L183), [183](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L183),\n\n```solidity\nFile: contracts/libraries/ValidationLib.sol\n\n/// @audit whitelist\n51:     function validateReferenceModuleWhitelisted(address referenceModule) internal view {\n\n/// @audit whitelist\n52:         if (!StorageLib.referenceModuleWhitelisted()[referenceModule]) {\n\n/// @audit whitelist\n53:             revert Errors.NotWhitelisted();\n\n/// @audit whitelist\n57:     function validateFollowModuleWhitelisted(address followModule) internal view {\n\n/// @audit whitelist\n58:         if (!StorageLib.followModuleWhitelisted()[followModule]) {\n\n/// @audit whitelist\n59:             revert Errors.NotWhitelisted();\n\n/// @audit whitelist\n63:     function validateProfileCreatorWhitelisted(address profileCreator) internal view {\n\n/// @audit whitelist\n64:         if (!StorageLib.profileCreatorWhitelisted()[profileCreator]) {\n\n/// @audit whitelist\n65:             revert Errors.NotWhitelisted();\n\n```\n\n[51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L51), [52](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L52), [53](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L53), [57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L57), [58](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L58), [59](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L59), [63](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L63), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L64), [65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L65),\n\n```solidity\nFile: contracts/libraries/constants/Errors.sol\n\n/// @audit whitelist\n23:     error NotWhitelisted();\n\n```\n\n[23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L23),\n\n```solidity\nFile: contracts/libraries/constants/Events.sol\n\n/// @audit whitelist\n65:      * @dev Emitted when a profile creator is added to or removed from the whitelist.\n\n/// @audit whitelist\n68:      * @param whitelisted Whether or not the profile creator is being added to the whitelist.\n\n/// @audit whitelist\n68:      * @param whitelisted Whether or not the profile creator is being added to the whitelist.\n\n/// @audit whitelist\n71:     event ProfileCreatorWhitelisted(address indexed profileCreator, bool indexed whitelisted, uint256 timestamp);\n\n/// @audit whitelist\n71:     event ProfileCreatorWhitelisted(address indexed profileCreator, bool indexed whitelisted, uint256 timestamp);\n\n/// @audit whitelist\n74:      * @dev Emitted when a follow module is added to or removed from the whitelist.\n\n/// @audit whitelist\n77:      * @param whitelisted Whether or not the follow module is being added to the whitelist.\n\n/// @audit whitelist\n77:      * @param whitelisted Whether or not the follow module is being added to the whitelist.\n\n/// @audit whitelist\n80:     event FollowModuleWhitelisted(address indexed followModule, bool indexed whitelisted, uint256 timestamp);\n\n/// @audit whitelist\n80:     event FollowModuleWhitelisted(address indexed followModule, bool indexed whitelisted, uint256 timestamp);\n\n/// @audit whitelist\n83:      * @dev Emitted when a reference module is added to or removed from the whitelist.\n\n/// @audit whitelist\n86:      * @param whitelisted Whether or not the reference module is being added to the whitelist.\n\n/// @audit whitelist\n86:      * @param whitelisted Whether or not the reference module is being added to the whitelist.\n\n/// @audit whitelist\n89:     event ReferenceModuleWhitelisted(address indexed referenceModule, bool indexed whitelisted, uint256 timestamp);\n\n/// @audit whitelist\n89:     event ReferenceModuleWhitelisted(address indexed referenceModule, bool indexed whitelisted, uint256 timestamp);\n\n/// @audit whitelist\n92:      * @dev Emitted when an action module is added to or removed from the whitelist.\n\n/// @audit whitelist\n95:      * @param id Id of the whitelisted action module.\n\n/// @audit whitelist\n96:      * @param whitelisted Whether or not the action module is being added to the whitelist.\n\n/// @audit whitelist\n96:      * @param whitelisted Whether or not the action module is being added to the whitelist.\n\n/// @audit whitelist\n99:     event ActionModuleWhitelisted(\n\n/// @audit whitelist\n102:         bool indexed whitelisted,\n\n/// @audit whitelist\n400:      * @notice Emitted when a currency is added to or removed from the ModuleGlobals whitelist.\n\n/// @audit whitelist\n403:      * @param prevWhitelisted Whether or not the currency was previously whitelisted.\n\n/// @audit whitelist\n403:      * @param prevWhitelisted Whether or not the currency was previously whitelisted.\n\n/// @audit whitelist\n404:      * @param whitelisted Whether or not the currency is whitelisted.\n\n/// @audit whitelist\n404:      * @param whitelisted Whether or not the currency is whitelisted.\n\n/// @audit whitelist\n407:     event ModuleGlobalsCurrencyWhitelisted(\n\n/// @audit whitelist\n409:         bool indexed prevWhitelisted,\n\n/// @audit whitelist\n410:         bool indexed whitelisted,\n\n```\n\n[65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L65), [68](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L68), [68](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L68), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L71), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L71), [74](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L74), [77](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L77), [77](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L77), [80](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L80), [80](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L80), [83](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L83), [86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L86), [86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L86), [89](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L89), [89](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L89), [92](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L92), [95](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L95), [96](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L96), [96](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L96), [99](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L99), [102](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L102), [400](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L400), [403](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L403), [403](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L403), [404](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L404), [404](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L404), [407](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L407), [409](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L409), [410](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L410),\n\n```solidity\nFile: contracts/libraries/constants/Types.sol\n\n/// @audit whitelist\n175:      * @param referenceModule The reference module to set for the given publication, must be whitelisted.\n\n/// @audit whitelist\n199:      * @param referenceModule The reference module to set for the given publication, must be whitelisted.\n\n/// @audit whitelist\n228:      * @param referenceModule The reference module to set for the given publication, must be whitelisted.\n\n/// @audit whitelist\n257:      * @param referenceModule The reference module to set for the given publication, must be whitelisted.\n\n/// @audit whitelist\n406:     struct ActionModuleWhitelistData {\n\n/// @audit whitelist\n408:         bool isWhitelisted;\n\n```\n\n[175](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L175), [199](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L199), [228](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L228), [257](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L257), [406](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L406), [408](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L408),\n\n```solidity\nFile: contracts/base/LensGovernable.sol\n\n/// @audit whitelist\n41:     function whitelistProfileCreator(address profileCreator, bool whitelist) external override onlyGov {\n\n/// @audit whitelist\n41:     function whitelistProfileCreator(address profileCreator, bool whitelist) external override onlyGov {\n\n/// @audit whitelist\n42:         GovernanceLib.whitelistProfileCreator(profileCreator, whitelist);\n\n/// @audit whitelist\n42:         GovernanceLib.whitelistProfileCreator(profileCreator, whitelist);\n\n/// @audit whitelist\n46:     function whitelistFollowModule(address followModule, bool whitelist) external override onlyGov {\n\n/// @audit whitelist\n46:     function whitelistFollowModule(address followModule, bool whitelist) external override onlyGov {\n\n/// @audit whitelist\n47:         GovernanceLib.whitelistFollowModule(followModule, whitelist);\n\n/// @audit whitelist\n47:         GovernanceLib.whitelistFollowModule(followModule, whitelist);\n\n/// @audit whitelist\n51:     function whitelistReferenceModule(address referenceModule, bool whitelist) external override onlyGov {\n\n/// @audit whitelist\n51:     function whitelistReferenceModule(address referenceModule, bool whitelist) external override onlyGov {\n\n/// @audit whitelist\n52:         GovernanceLib.whitelistReferenceModule(referenceModule, whitelist);\n\n/// @audit whitelist\n52:         GovernanceLib.whitelistReferenceModule(referenceModule, whitelist);\n\n/// @audit whitelist\n56:     function whitelistActionModule(address actionModule, bool whitelist) external override onlyGov {\n\n/// @audit whitelist\n56:     function whitelistActionModule(address actionModule, bool whitelist) external override onlyGov {\n\n/// @audit whitelist\n57:         GovernanceLib.whitelistActionModule(actionModule, whitelist);\n\n/// @audit whitelist\n57:         GovernanceLib.whitelistActionModule(actionModule, whitelist);\n\n/// @audit whitelist\n82:     function isProfileCreatorWhitelisted(address profileCreator) external view override returns (bool) {\n\n/// @audit whitelist\n83:         return StorageLib.profileCreatorWhitelisted()[profileCreator];\n\n/// @audit whitelist\n87:     function isFollowModuleWhitelisted(address followModule) external view override returns (bool) {\n\n/// @audit whitelist\n88:         return StorageLib.followModuleWhitelisted()[followModule];\n\n/// @audit whitelist\n92:     function isReferenceModuleWhitelisted(address referenceModule) external view override returns (bool) {\n\n/// @audit whitelist\n93:         return StorageLib.referenceModuleWhitelisted()[referenceModule];\n\n/// @audit whitelist\n97:     function getActionModuleWhitelistData(address actionModule)\n\n/// @audit whitelist\n101:         returns (Types.ActionModuleWhitelistData memory)\n\n/// @audit whitelist\n103:         return StorageLib.actionModuleWhitelistData()[actionModule];\n\n```\n\n[41](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L41), [41](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L41), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L42), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L42), [46](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L46), [46](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L46), [47](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L47), [47](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L47), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L51), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L51), [52](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L52), [52](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L52), [56](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L56), [56](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L56), [57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L57), [57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L57), [82](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L82), [83](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L83), [87](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L87), [88](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L88), [92](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L92), [93](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L93), [97](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L97), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L101), [103](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L103),\n\n```solidity\nFile: contracts/base/LensHubStorage.sol\n\n/// @audit whitelist\n21:     mapping(address profileCreator => bool isWhitelisted) internal _profileCreatorWhitelisted; // Slot 13\n\n/// @audit whitelist\n21:     mapping(address profileCreator => bool isWhitelisted) internal _profileCreatorWhitelisted; // Slot 13\n\n/// @audit whitelist\n23:     mapping(address => bool isWhitelisted) internal _followModuleWhitelisted; // Slot 14\n\n/// @audit whitelist\n23:     mapping(address => bool isWhitelisted) internal _followModuleWhitelisted; // Slot 14\n\n/// @audit whitelist\n25:     // `_collectModuleWhitelisted` slot replaced by `_actionModuleWhitelistData` in Lens V2.\n\n/// @audit whitelist\n25:     // `_collectModuleWhitelisted` slot replaced by `_actionModuleWhitelistData` in Lens V2.\n\n/// @audit whitelist\n26:     // All the old modules need to be unwhitelisted before V2 upgrade to avoid dirty storage.\n\n/// @audit whitelist\n27:     // mapping(address collectModule => bool isWhitelisted) internal __DEPRECATED__collectModuleWhitelisted;\n\n/// @audit whitelist\n27:     // mapping(address collectModule => bool isWhitelisted) internal __DEPRECATED__collectModuleWhitelisted;\n\n/// @audit whitelist\n28:     mapping(address actionModule => Types.ActionModuleWhitelistData whitelistData) internal _actionModuleWhitelistData; // Slot 15\n\n/// @audit whitelist\n28:     mapping(address actionModule => Types.ActionModuleWhitelistData whitelistData) internal _actionModuleWhitelistData; // Slot 15\n\n/// @audit whitelist\n28:     mapping(address actionModule => Types.ActionModuleWhitelistData whitelistData) internal _actionModuleWhitelistData; // Slot 15\n\n/// @audit whitelist\n30:     mapping(address referenceModule => bool isWhitelisted) internal _referenceModuleWhitelisted; // Slot 16\n\n/// @audit whitelist\n30:     mapping(address referenceModule => bool isWhitelisted) internal _referenceModuleWhitelisted; // Slot 16\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L21), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L21), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L23), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L23), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L25), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L25), [26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L26), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L27), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L27), [28](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L28), [28](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L28), [28](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L28), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L30), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L30),\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n/// @audit whitelist\n13:     address[] public oldFollowModulesToUnwhitelist;\n\n/// @audit whitelist\n14:     address[] public newFollowModulesToWhitelist;\n\n/// @audit whitelist\n15:     address[] public oldReferenceModulesToUnwhitelist;\n\n/// @audit whitelist\n16:     address[] public newReferenceModulesToWhitelist;\n\n/// @audit whitelist\n17:     address[] public oldCollectModulesToUnwhitelist;\n\n/// @audit whitelist\n18:     address[] public newActionModulesToWhitelist;\n\n/// @audit whitelist\n26:         address[] memory oldFollowModulesToUnwhitelist_,\n\n/// @audit whitelist\n27:         address[] memory newFollowModulesToWhitelist_,\n\n/// @audit whitelist\n28:         address[] memory oldReferenceModulesToUnwhitelist_,\n\n/// @audit whitelist\n29:         address[] memory newReferenceModulesToWhitelist_,\n\n/// @audit whitelist\n30:         address[] memory oldCollectModulesToUnwhitelist_,\n\n/// @audit whitelist\n31:         address[] memory newActionModulesToWhitelist_\n\n/// @audit whitelist\n36:         oldFollowModulesToUnwhitelist = oldFollowModulesToUnwhitelist_;\n\n/// @audit whitelist\n36:         oldFollowModulesToUnwhitelist = oldFollowModulesToUnwhitelist_;\n\n/// @audit whitelist\n37:         newFollowModulesToWhitelist = newFollowModulesToWhitelist_;\n\n/// @audit whitelist\n37:         newFollowModulesToWhitelist = newFollowModulesToWhitelist_;\n\n/// @audit whitelist\n38:         oldReferenceModulesToUnwhitelist = oldReferenceModulesToUnwhitelist_;\n\n/// @audit whitelist\n38:         oldReferenceModulesToUnwhitelist = oldReferenceModulesToUnwhitelist_;\n\n/// @audit whitelist\n39:         newReferenceModulesToWhitelist = newReferenceModulesToWhitelist_;\n\n/// @audit whitelist\n39:         newReferenceModulesToWhitelist = newReferenceModulesToWhitelist_;\n\n/// @audit whitelist\n40:         oldCollectModulesToUnwhitelist = oldCollectModulesToUnwhitelist_;\n\n/// @audit whitelist\n40:         oldCollectModulesToUnwhitelist = oldCollectModulesToUnwhitelist_;\n\n/// @audit whitelist\n41:         newActionModulesToWhitelist = newActionModulesToWhitelist_;\n\n/// @audit whitelist\n41:         newActionModulesToWhitelist = newActionModulesToWhitelist_;\n\n/// @audit whitelist\n51:         _unwhitelistOldFollowModules();\n\n/// @audit whitelist\n52:         _unwhitelistOldReferenceModules();\n\n/// @audit whitelist\n53:         _unwhitelistOldCollectModules();\n\n/// @audit whitelist\n57:         _whitelistNewFollowModules();\n\n/// @audit whitelist\n58:         _whitelistNewReferenceModules();\n\n/// @audit whitelist\n59:         _whitelistNewActionModules();\n\n/// @audit whitelist\n64:     function _unwhitelistOldFollowModules() internal {\n\n/// @audit whitelist\n65:         uint256 oldFollowModulesToUnwhitelistLength = oldFollowModulesToUnwhitelist.length;\n\n/// @audit whitelist\n65:         uint256 oldFollowModulesToUnwhitelistLength = oldFollowModulesToUnwhitelist.length;\n\n/// @audit whitelist\n67:         while (i < oldFollowModulesToUnwhitelistLength) {\n\n/// @audit whitelist\n68:             GOVERNANCE.lensHub_whitelistFollowModule(oldFollowModulesToUnwhitelist[i], false);\n\n/// @audit whitelist\n68:             GOVERNANCE.lensHub_whitelistFollowModule(oldFollowModulesToUnwhitelist[i], false);\n\n/// @audit whitelist\n75:     function _unwhitelistOldReferenceModules() internal {\n\n/// @audit whitelist\n76:         uint256 oldReferenceModulesToUnwhitelistLength = oldReferenceModulesToUnwhitelist.length;\n\n/// @audit whitelist\n76:         uint256 oldReferenceModulesToUnwhitelistLength = oldReferenceModulesToUnwhitelist.length;\n\n/// @audit whitelist\n78:         while (i < oldReferenceModulesToUnwhitelistLength) {\n\n/// @audit whitelist\n79:             GOVERNANCE.lensHub_whitelistReferenceModule(oldReferenceModulesToUnwhitelist[i], false);\n\n/// @audit whitelist\n79:             GOVERNANCE.lensHub_whitelistReferenceModule(oldReferenceModulesToUnwhitelist[i], false);\n\n/// @audit whitelist\n86:     function _unwhitelistOldCollectModules() internal {\n\n/// @audit whitelist\n87:         uint256 oldCollectModulesToUnwhitelistLength = oldCollectModulesToUnwhitelist.length;\n\n/// @audit whitelist\n87:         uint256 oldCollectModulesToUnwhitelistLength = oldCollectModulesToUnwhitelist.length;\n\n/// @audit whitelist\n89:         while (i < oldCollectModulesToUnwhitelistLength) {\n\n/// @audit whitelist\n90:             GOVERNANCE.lensHub_whitelistCollectModule(oldCollectModulesToUnwhitelist[i], false);\n\n/// @audit whitelist\n90:             GOVERNANCE.lensHub_whitelistCollectModule(oldCollectModulesToUnwhitelist[i], false);\n\n/// @audit whitelist\n97:     function _whitelistNewFollowModules() internal {\n\n/// @audit whitelist\n98:         uint256 newFollowModulesToWhitelistLength = newFollowModulesToWhitelist.length;\n\n/// @audit whitelist\n98:         uint256 newFollowModulesToWhitelistLength = newFollowModulesToWhitelist.length;\n\n/// @audit whitelist\n100:         while (i < newFollowModulesToWhitelistLength) {\n\n/// @audit whitelist\n101:             GOVERNANCE.lensHub_whitelistFollowModule(newFollowModulesToWhitelist[i], true);\n\n/// @audit whitelist\n101:             GOVERNANCE.lensHub_whitelistFollowModule(newFollowModulesToWhitelist[i], true);\n\n/// @audit whitelist\n108:     function _whitelistNewReferenceModules() internal {\n\n/// @audit whitelist\n109:         uint256 newReferenceModulesToWhitelistLength = newReferenceModulesToWhitelist.length;\n\n/// @audit whitelist\n109:         uint256 newReferenceModulesToWhitelistLength = newReferenceModulesToWhitelist.length;\n\n/// @audit whitelist\n111:         while (i < newReferenceModulesToWhitelistLength) {\n\n/// @audit whitelist\n112:             GOVERNANCE.lensHub_whitelistReferenceModule(newReferenceModulesToWhitelist[i], true);\n\n/// @audit whitelist\n112:             GOVERNANCE.lensHub_whitelistReferenceModule(newReferenceModulesToWhitelist[i], true);\n\n/// @audit whitelist\n119:     function _whitelistNewActionModules() internal {\n\n/// @audit whitelist\n120:         uint256 newActionModulesToWhitelistLength = newActionModulesToWhitelist.length;\n\n/// @audit whitelist\n120:         uint256 newActionModulesToWhitelistLength = newActionModulesToWhitelist.length;\n\n/// @audit whitelist\n122:         while (i < newActionModulesToWhitelistLength) {\n\n/// @audit whitelist\n123:             GOVERNANCE.lensHub_whitelistActionModule(newActionModulesToWhitelist[i], true);\n\n/// @audit whitelist\n123:             GOVERNANCE.lensHub_whitelistActionModule(newActionModulesToWhitelist[i], true);\n\n```\n\n[13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L13), [14](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L14), [15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L15), [16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L16), [17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L17), [18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L18), [26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L26), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L27), [28](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L28), [29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L29), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L30), [31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L31), [36](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L36), [36](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L36), [37](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L37), [37](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L37), [38](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L38), [38](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L38), [39](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L39), [39](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L39), [40](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L40), [40](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L40), [41](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L41), [41](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L41), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L51), [52](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L52), [53](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L53), [57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L57), [58](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L58), [59](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L59), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L64), [65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L65), [65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L65), [67](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L67), [68](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L68), [68](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L68), [75](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L75), [76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L76), [76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L76), [78](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L78), [79](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L79), [79](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L79), [86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L86), [87](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L87), [87](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L87), [89](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L89), [90](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L90), [90](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L90), [97](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L97), [98](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L98), [98](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L98), [100](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L100), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L101), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L101), [108](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L108), [109](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L109), [109](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L109), [111](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L111), [112](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L112), [112](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L112), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L119), [120](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L120), [120](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L120), [122](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L122), [123](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L123), [123](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L123),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n/// @audit whitelist\n22:     mapping(address => bool) internal _currencyWhitelisted;\n\n/// @audit whitelist\n65:     function whitelistCurrency(address currency, bool toWhitelist) external override onlyGov {\n\n/// @audit whitelist\n65:     function whitelistCurrency(address currency, bool toWhitelist) external override onlyGov {\n\n/// @audit whitelist\n66:         _whitelistCurrency(currency, toWhitelist);\n\n/// @audit whitelist\n66:         _whitelistCurrency(currency, toWhitelist);\n\n/// @audit whitelist\n70:     function isCurrencyWhitelisted(address currency) external view override returns (bool) {\n\n/// @audit whitelist\n71:         return _currencyWhitelisted[currency];\n\n/// @audit whitelist\n115:     function _whitelistCurrency(address currency, bool toWhitelist) internal {\n\n/// @audit whitelist\n115:     function _whitelistCurrency(address currency, bool toWhitelist) internal {\n\n/// @audit whitelist\n117:         bool prevWhitelisted = _currencyWhitelisted[currency];\n\n/// @audit whitelist\n117:         bool prevWhitelisted = _currencyWhitelisted[currency];\n\n/// @audit whitelist\n118:         _currencyWhitelisted[currency] = toWhitelist;\n\n/// @audit whitelist\n118:         _currencyWhitelisted[currency] = toWhitelist;\n\n/// @audit whitelist\n119:         emit Events.ModuleGlobalsCurrencyWhitelisted(currency, prevWhitelisted, toWhitelist, block.timestamp);\n\n/// @audit whitelist\n119:         emit Events.ModuleGlobalsCurrencyWhitelisted(currency, prevWhitelisted, toWhitelist, block.timestamp);\n\n/// @audit whitelist\n119:         emit Events.ModuleGlobalsCurrencyWhitelisted(currency, prevWhitelisted, toWhitelist, block.timestamp);\n\n```\n\n[22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L22), [65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L65), [65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L65), [66](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L66), [66](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L66), [70](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L70), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L71), [115](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L115), [115](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L115), [117](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L117), [117](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L117), [118](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L118), [118](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L118), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L119), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L119), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L119),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n/// @audit whitelist\n9:     function whitelistCollectModule(address collectModule, bool whitelist) external;\n\n/// @audit whitelist\n9:     function whitelistCollectModule(address collectModule, bool whitelist) external;\n\n/// @audit whitelist\n35:     function lensHub_whitelistProfileCreator(address profileCreator, bool whitelist)\n\n/// @audit whitelist\n35:     function lensHub_whitelistProfileCreator(address profileCreator, bool whitelist)\n\n/// @audit whitelist\n39:         LENS_HUB.whitelistProfileCreator(profileCreator, whitelist);\n\n/// @audit whitelist\n39:         LENS_HUB.whitelistProfileCreator(profileCreator, whitelist);\n\n/// @audit whitelist\n42:     function lensHub_whitelistFollowModule(address followModule, bool whitelist)\n\n/// @audit whitelist\n42:     function lensHub_whitelistFollowModule(address followModule, bool whitelist)\n\n/// @audit whitelist\n46:         LENS_HUB.whitelistFollowModule(followModule, whitelist);\n\n/// @audit whitelist\n46:         LENS_HUB.whitelistFollowModule(followModule, whitelist);\n\n/// @audit whitelist\n49:     function lensHub_whitelistReferenceModule(address referenceModule, bool whitelist)\n\n/// @audit whitelist\n49:     function lensHub_whitelistReferenceModule(address referenceModule, bool whitelist)\n\n/// @audit whitelist\n53:         LENS_HUB.whitelistReferenceModule(referenceModule, whitelist);\n\n/// @audit whitelist\n53:         LENS_HUB.whitelistReferenceModule(referenceModule, whitelist);\n\n/// @audit whitelist\n56:     function lensHub_whitelistActionModule(address actionModule, bool whitelist)\n\n/// @audit whitelist\n56:     function lensHub_whitelistActionModule(address actionModule, bool whitelist)\n\n/// @audit whitelist\n60:         LENS_HUB.whitelistActionModule(actionModule, whitelist);\n\n/// @audit whitelist\n60:         LENS_HUB.whitelistActionModule(actionModule, whitelist);\n\n/// @audit whitelist\n63:     // Interface to the Deprecated LensHub V1 to unwhitelist collect modules\n\n/// @audit whitelist\n64:     function lensHub_whitelistCollectModule(address collectModule, bool whitelist)\n\n/// @audit whitelist\n64:     function lensHub_whitelistCollectModule(address collectModule, bool whitelist)\n\n/// @audit whitelist\n68:         ILensHub_V1(address(LENS_HUB)).whitelistCollectModule(collectModule, whitelist);\n\n/// @audit whitelist\n68:         ILensHub_V1(address(LENS_HUB)).whitelistCollectModule(collectModule, whitelist);\n\n```\n\n[9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L9), [9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L9), [35](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L35), [35](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L35), [39](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L39), [39](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L39), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L42), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L42), [46](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L46), [46](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L46), [49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L49), [49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L49), [53](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L53), [53](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L53), [56](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L56), [56](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L56), [60](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L60), [60](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L60), [63](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L63), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L64), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L64), [68](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L68), [68](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L68),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n/// @audit whitelist\n39:     modifier onlyOwnerOrWhitelistedProfileCreator() {\n\n/// @audit whitelist\n41:             msg.sender != OWNER && !ILensHub(LENS_HUB).isProfileCreatorWhitelisted(msg.sender)\n\n/// @audit whitelist\n43:             revert HandlesErrors.NotOwnerNorWhitelisted();\n\n/// @audit whitelist\n89:         onlyOwnerOrWhitelistedProfileCreator\n\n```\n\n[39](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L39), [41](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L41), [43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L43), [89](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L89),\n\n```solidity\nFile: contracts/namespaces/constants/Errors.sol\n\n/// @audit whitelist\n18:     error NotOwnerNorWhitelisted();\n\n```\n\n[18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L18),\n\n```solidity\nFile: contracts/interfaces/ILensGovernable.sol\n\n/// @audit whitelist\n42:      * @notice Adds or removes a profile creator from the whitelist.\n\n/// @audit whitelist\n45:      * @param profileCreator The profile creator address to add or remove from the whitelist.\n\n/// @audit whitelist\n46:      * @param whitelist Whether or not the profile creator should be whitelisted.\n\n/// @audit whitelist\n46:      * @param whitelist Whether or not the profile creator should be whitelisted.\n\n/// @audit whitelist\n48:     function whitelistProfileCreator(address profileCreator, bool whitelist) external;\n\n/// @audit whitelist\n48:     function whitelistProfileCreator(address profileCreator, bool whitelist) external;\n\n/// @audit whitelist\n51:      * @notice Adds or removes a follow module from the whitelist.\n\n/// @audit whitelist\n54:      * @param followModule The follow module contract address to add or remove from the whitelist.\n\n/// @audit whitelist\n55:      * @param whitelist Whether or not the follow module should be whitelisted.\n\n/// @audit whitelist\n55:      * @param whitelist Whether or not the follow module should be whitelisted.\n\n/// @audit whitelist\n57:     function whitelistFollowModule(address followModule, bool whitelist) external;\n\n/// @audit whitelist\n57:     function whitelistFollowModule(address followModule, bool whitelist) external;\n\n/// @audit whitelist\n60:      * @notice Adds or removes a reference module from the whitelist.\n\n/// @audit whitelist\n63:      * @param referenceModule The reference module contract to add or remove from the whitelist.\n\n/// @audit whitelist\n64:      * @param whitelist Whether or not the reference module should be whitelisted.\n\n/// @audit whitelist\n64:      * @param whitelist Whether or not the reference module should be whitelisted.\n\n/// @audit whitelist\n66:     function whitelistReferenceModule(address referenceModule, bool whitelist) external;\n\n/// @audit whitelist\n66:     function whitelistReferenceModule(address referenceModule, bool whitelist) external;\n\n/// @audit whitelist\n69:      * @notice Adds or removes an action module from the whitelist. This function can only be called by the current\n\n/// @audit whitelist\n73:      * @param actionModule The action module contract address to add or remove from the whitelist.\n\n/// @audit whitelist\n74:      * @param whitelist True if the action module should be whitelisted, false if it should be unwhitelisted.\n\n/// @audit whitelist\n74:      * @param whitelist True if the action module should be whitelisted, false if it should be unwhitelisted.\n\n/// @audit whitelist\n74:      * @param whitelist True if the action module should be whitelisted, false if it should be unwhitelisted.\n\n/// @audit whitelist\n76:     function whitelistActionModule(address actionModule, bool whitelist) external;\n\n/// @audit whitelist\n76:     function whitelistActionModule(address actionModule, bool whitelist) external;\n\n/// @audit whitelist\n95:      * @notice Returns whether or not a profile creator is whitelisted.\n\n/// @audit whitelist\n99:      * @return bool True if the profile creator is whitelisted, false otherwise.\n\n/// @audit whitelist\n101:     function isProfileCreatorWhitelisted(address profileCreator) external view returns (bool);\n\n/// @audit whitelist\n104:      * @notice Returns whether or not a follow module is whitelisted.\n\n/// @audit whitelist\n108:      * @return bool True if the follow module is whitelisted, false otherwise.\n\n/// @audit whitelist\n110:     function isFollowModuleWhitelisted(address followModule) external view returns (bool);\n\n/// @audit whitelist\n113:      * @notice Returns whether or not a reference module is whitelisted.\n\n/// @audit whitelist\n117:      * @return bool True if the reference module is whitelisted, false otherwise.\n\n/// @audit whitelist\n119:     function isReferenceModuleWhitelisted(address referenceModule) external view returns (bool);\n\n/// @audit whitelist\n122:      * @notice Returns whether or not an action module is whitelisted, and its ID assigned.\n\n/// @audit whitelist\n123:      * @dev If the ID is zero, it means the module has never been whitelisted, so no ID assigned to it yet.\n\n/// @audit whitelist\n125:      * @param actionModule The address of the action module to get whitelist data of.\n\n/// @audit whitelist\n127:      * @return ActionModuleWhitelistData The data containing the ID and whitelist status of the given module.\n\n/// @audit whitelist\n127:      * @return ActionModuleWhitelistData The data containing the ID and whitelist status of the given module.\n\n/// @audit whitelist\n129:     function getActionModuleWhitelistData(address actionModule)\n\n/// @audit whitelist\n132:         returns (Types.ActionModuleWhitelistData memory);\n\n```\n\n[42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L42), [45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L45), [46](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L46), [46](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L46), [48](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L48), [48](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L48), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L51), [54](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L54), [55](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L55), [55](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L55), [57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L57), [57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L57), [60](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L60), [63](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L63), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L64), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L64), [66](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L66), [66](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L66), [69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L69), [73](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L73), [74](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L74), [74](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L74), [74](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L74), [76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L76), [76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L76), [95](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L95), [99](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L99), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L101), [104](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L104), [108](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L108), [110](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L110), [113](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L113), [117](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L117), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L119), [122](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L122), [123](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L123), [125](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L125), [127](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L127), [127](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L127), [129](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L129), [132](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L132),\n\n```solidity\nFile: contracts/interfaces/ILensProtocol.sol\n\n/// @audit whitelist\n17:      * @custom:permissions Any whitelisted profile creator.\n\n/// @audit whitelist\n46:      * @param followModule The follow module to set for the given profile, must be whitelisted.\n\n/// @audit whitelist\n426:      * @notice Returns the address of the action module associated with the given whitelist ID, address(0) if none.\n\n```\n\n[17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L17), [46](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L46), [426](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L426),\n\n```solidity\nFile: contracts/interfaces/IModuleGlobals.sol\n\n/// @audit whitelist\n15:  *  - Whitelist of currencies allowed for use in modules\n\n/// @audit whitelist\n43:      * @notice Adds or removes a currency from the whitelist.\n\n/// @audit whitelist\n46:      * @param currency The currency to add or remove from the whitelist.\n\n/// @audit whitelist\n47:      * @param toWhitelist Whether to add (true) or remove (false) the currency from the whitelist.\n\n/// @audit whitelist\n47:      * @param toWhitelist Whether to add (true) or remove (false) the currency from the whitelist.\n\n/// @audit whitelist\n49:     function whitelistCurrency(address currency, bool toWhitelist) external;\n\n/// @audit whitelist\n49:     function whitelistCurrency(address currency, bool toWhitelist) external;\n\n/// @audit whitelist\n56:      * @notice Returns whether a currency is whitelisted.\n\n/// @audit whitelist\n58:      * @param currency The currency to query the whitelist for.\n\n/// @audit whitelist\n60:      * @return bool True if the queried currency is whitelisted, false otherwise.\n\n/// @audit whitelist\n62:     function isCurrencyWhitelisted(address currency) external view returns (bool);\n\n```\n\n[15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L15), [43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L43), [46](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L46), [47](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L47), [47](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L47), [49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L49), [49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L49), [56](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L56), [58](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L58), [60](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L60), [62](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L62),\n\n</details>\n\n### <a name=\"N-04\"></a>[N-04] Variable names that consist of all capital letters should be reserved for `constant`/`immutable` variables\nIf the variable needs to be different based on which class it comes from, a `view`/`pure` function should be used instead (e.g. like [this](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/76eee35971c2541585e05cbf258510dda7b2fbc6/contracts/token/ERC20/extensions/draft-IERC20Permit.sol#L59)).\n\n*Instances (1)*:\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n24:     uint256[5] ___DEPRECATED_SLOTS; // Deprecated slots, previously used for delegations.\n\n```\n\n[24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L24),\n\n### <a name=\"N-05\"></a>[N-05] Cast to `bytes` or `bytes32` for clearer semantic meaning\nThis should especially be done if the new value is not required to be different from the old value\n\n*Instances (9)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n103:                         abi.encodePacked(delegatedExecutors),\n\n104:                         abi.encodePacked(approvals),\n\n169:         return keccak256(abi.encodePacked(actionModulesInitDatasHashes));\n\n345:                         keccak256(abi.encodePacked(idsOfProfilesToFollow)),\n\n346:                         keccak256(abi.encodePacked(followTokenIds)),\n\n347:                         keccak256(abi.encodePacked(dataHashes)),\n\n368:                         keccak256(abi.encodePacked(idsOfProfilesToUnfollow)),\n\n390:                         keccak256(abi.encodePacked(idsOfProfilesToSetBlockStatus)),\n\n391:                         keccak256(abi.encodePacked(blockStatus)),\n\n```\n\n[103](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L103), [104](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L104), [169](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L169), [345](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L345), [346](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L346), [347](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L347), [368](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L368), [390](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L390), [391](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L391),\n\n</details>\n\n### <a name=\"N-06\"></a>[N-06] Consider disabling `renounceOwnership()`\nIf the plan for your project does not include eventually giving up all ownership control, consider overwriting OpenZeppelin's `Ownable`'s `renounceOwnership()` function in order to disable it.\n\n*Instances (9)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n9: contract LensV2UpgradeContract is ImmutableOwnable {\n\n```\n\n[9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L9),\n\n```solidity\nFile: contracts/misc/ProfileCreationProxy.sol\n\n19: contract ProfileCreationProxy is ImmutableOwnable {\n\n19: contract ProfileCreationProxy is ImmutableOwnable {\n\n19: contract ProfileCreationProxy is ImmutableOwnable {\n\n```\n\n[19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L19), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L19), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L19),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n7: contract ControllableByContract is Ownable {\n\n```\n\n[7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L7),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n12: contract Governance is ControllableByContract {\n\n12: contract Governance is ControllableByContract {\n\n```\n\n[12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L12), [12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L12),\n\n```solidity\nFile: contracts/misc/access/ProxyAdmin.sol\n\n8: contract ProxyAdmin is ControllableByContract {\n\n8: contract ProxyAdmin is ControllableByContract {\n\n```\n\n[8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L8), [8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L8),\n\n</details>\n\n### <a name=\"N-07\"></a>[N-07] Consider using `delete` rather than assigning zero to clear values\nThe `delete` keyword more closely matches the semantics of what is being done, and draws more attention to the changing of state, which may lead to a more thorough audit of its associated logic.\n\n*Instances (2)*:\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n81:         StorageLib.tokenGuardianDisablingTimestamp()[msg.sender] = 0;\n\n```\n\n[81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L81),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n130:         _tokenGuardianDisablingTimestamp[msg.sender] = 0;\n\n```\n\n[130](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L130),\n\n### <a name=\"N-08\"></a>[N-08] Consider using named mappings\nConsider moving to solidity version 0.8.18 or later, and using [named mappings](https://ethereum.stackexchange.com/a/145555) to make it easier to understand the purpose of each mapping\n\n*Instances (31)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n36:     mapping(uint256 => Types.FollowData) internal _followDataByFollowTokenId;\n\n37:     mapping(uint256 => uint256) internal _followTokenIdByFollowerProfileId;\n\n38:     mapping(uint256 => uint256) internal _followApprovalByFollowTokenId;\n\n```\n\n[36](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L36), [37](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L37), [38](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L38),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n140:         mapping(uint256 => bool) storage _blockedStatus = StorageLib.blockedStatus(byProfileId);\n\n```\n\n[140](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L140),\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n86:         returns (mapping(address => uint256) storage _tokenGuardianDisablingTimestamp)\n\n104:         returns (mapping(uint256 => bool) storage _blockedStatus)\n\n113:     function nonces() internal pure returns (mapping(address => uint256) storage _nonces) {\n\n122:         returns (mapping(bytes32 => uint256) storage _profileIdByHandleHash)\n\n132:         returns (mapping(address => bool) storage _profileCreatorWhitelisted)\n\n142:         returns (mapping(address => bool) storage _followModuleWhitelisted)\n\n152:         returns (mapping(address => Types.ActionModuleWhitelistData) storage _actionModuleWhitelistData)\n\n159:     function actionModuleById() internal pure returns (mapping(uint256 => address) storage _actionModules) {\n\n180:         returns (mapping(address => bool) storage _referenceModuleWhitelisted)\n\n```\n\n[86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L86), [104](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L104), [113](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L113), [122](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L122), [132](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L132), [142](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L142), [152](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L152), [159](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L159), [180](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L180),\n\n```solidity\nFile: contracts/libraries/constants/Types.sol\n\n400:         mapping(uint256 => mapping(address => bool)) isApproved; // isApproved[configNumber][delegatedExecutor]\n\n400:         mapping(uint256 => mapping(address => bool)) isApproved; // isApproved[configNumber][delegatedExecutor]\n\n```\n\n[400](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L400), [400](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L400),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n42:     mapping(uint256 => Types.TokenData) private _tokenData;\n\n45:     mapping(address => uint256) private _balances;\n\n48:     mapping(uint256 => address) private _tokenApprovals;\n\n51:     mapping(address => mapping(address => bool)) private _operatorApprovals;\n\n51:     mapping(address => mapping(address => bool)) private _operatorApprovals;\n\n54:     mapping(address => mapping(uint256 => uint256)) private __DEPRECATED__ownedTokens;\n\n54:     mapping(address => mapping(uint256 => uint256)) private __DEPRECATED__ownedTokens;\n\n55:     mapping(uint256 => uint256) private __DEPRECATED__ownedTokensIndex;\n\n61:     mapping(uint256 => uint256) private __DEPRECATED__allTokensIndex;\n\n63:     mapping(address => uint256) private _nonces;\n\n```\n\n[42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L42), [45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L45), [48](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L48), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L51), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L51), [54](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L54), [54](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L54), [55](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L55), [61](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L61), [63](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L63),\n\n```solidity\nFile: contracts/base/LensHubStorage.sol\n\n23:     mapping(address => bool isWhitelisted) internal _followModuleWhitelisted; // Slot 14\n\n38:     mapping(uint256 profileId => mapping(uint256 pubId => Types.Publication publication)) internal _publications; // Slot 20\n\n51:     mapping(address => uint256) internal _tokenGuardianDisablingTimestamp; // Slot 25\n\n59:     mapping(uint256 blockerProfileId => mapping(uint256 blockedProfileId => bool isBlocked)) internal _blockedStatus; // Slot 27\n\n```\n\n[23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L23), [38](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L38), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L51), [59](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L59),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n22:     mapping(address => bool) internal _currencyWhitelisted;\n\n```\n\n[22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L22),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n35:     mapping(address => uint256) internal _tokenGuardianDisablingTimestamp;\n\n```\n\n[35](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L35),\n\n</details>\n\n### <a name=\"N-09\"></a>[N-09] Consistent usage of `require` vs custom `error`\nConsider using the same approach throughout the codebase to improve the consistency of the code.\n\n`require` used: 0 \n\n`cusntom error` used: 20 \n\n`require` used: 0 \n\n`cusntom error` used: 46 \n\n`require` used: 0 \n\n`cusntom error` used: 0 \n\n`require` used: 0 \n\n`cusntom error` used: 29 \n\n`require` used: 0 \n\n`cusntom error` used: 0 \n\n`require` used: 0 \n\n`cusntom error` used: 12 \n\n`require` used: 0 \n\n`cusntom error` used: 2 \n\n`require` used: 0 \n\n`cusntom error` used: 23 \n\n`require` used: 0 \n\n`cusntom error` used: 0 \n\n`require` used: 0 \n\n`cusntom error` used: 0 \n\n*Instances (10)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: Various files\n\n1: \n\n1: \n\n1: \n\n1: \n\n1: \n\n1: \n\n1: \n\n1: \n\n1: \n\n1: \n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L1), [1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L1), [1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L1), [1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L1), [1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L1), [1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L1), [1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L1), [1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L1), [1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L1), [1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ICollectModule.sol#L1),\n\n</details>\n\n### <a name=\"N-10\"></a>[N-10] `constant`/`immutable` variable names should use capital letters and underscore\nFor immutable variables in Solidity, the convention is to use CAPS_CASE or UPPER_CASE_WITH_UNDERSCORES.\n\n*Instances (8)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n21:     string constant EIP712_DOMAIN_VERSION = '2';\n\n22:     bytes32 constant EIP712_DOMAIN_VERSION_HASH = keccak256(bytes(EIP712_DOMAIN_VERSION));\n\n23:     bytes4 constant EIP1271_MAGIC_VALUE = 0x1626ba7e;\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L21), [22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L22), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L23),\n\n```solidity\nFile: contracts/libraries/constants/Typehash.sol\n\n17:     bytes32 constant EIP712_DOMAIN = keccak256('EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)');\n\n```\n\n[17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L17),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n12:     bytes4 internal constant INTERFACE_ID_ERC2981 = 0x2a55205a;\n\n```\n\n[12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L12),\n\n```solidity\nFile: contracts/misc/LensV2Migration.sol\n\n16:     LensHandles internal immutable lensHandles;\n\n17:     TokenHandleRegistry internal immutable tokenHandleRegistry;\n\n```\n\n[16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L16), [17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L17),\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n12:     address public immutable newImplementation;\n\n```\n\n[12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L12),\n\n</details>\n\n### <a name=\"N-11\"></a>[N-11] Constants in comparisons should appear on the left side\nDoing so will prevent [typo bugs](https://www.moserware.com/2008/01/constants-on-left-are-better-but-this.html).\n\n*Instances (58)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n/// @audit != 0\n64:         if (_followTokenIdByFollowerProfileId[followerProfileId] != 0) {\n\n/// @audit == 0\n68:         if (followTokenId == 0) {\n\n/// @audit != 0\n86:         if (currentFollowerProfileId != 0) {\n\n/// @audit == 0\n105:         if (followTokenId == 0) {\n\n/// @audit == 0\n173:         if (followerProfileId == 0) {\n\n/// @audit == 0\n175:             if (followerProfileId == 0) {\n\n/// @audit == 0\n189:         if (_followDataByFollowTokenId[followTokenId].followerProfileId == 0) {\n\n/// @audit != 0\n199:         if (followTokenId != 0) {\n\n/// @audit != 0\n217:         return _followTokenIdByFollowerProfileId[followerProfileId] != 0;\n\n/// @audit != 0\n373:         if (currentFollowerProfileId != 0) {\n\n/// @audit == 0\n401:             if (_followDataByFollowTokenId[followTokenId].originalFollowTimestamp == 0) {\n\n/// @audit != 0\n410:         if (followerProfileId != 0) {\n\n/// @audit != 0\n487:         if (_followDataByFollowTokenId[followTokenId].originalFollowTimestamp != 0) {\n\n```\n\n[64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L64), [68](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L68), [86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L86), [105](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L105), [173](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L173), [175](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L175), [189](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L189), [199](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L199), [217](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L217), [373](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L373), [401](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L401), [410](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L410), [487](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L487),\n\n```solidity\nFile: contracts/libraries/ActionLib.sol\n\n/// @audit == 0\n70:         if (actionModuleId == 0) {\n\n/// @audit != 0\n74:         return actionModuleIdBitmapMask & _publication.enabledActionModulesBitmap != 0;\n\n```\n\n[70](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L70), [74](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L74),\n\n```solidity\nFile: contracts/libraries/GovernanceLib.sol\n\n/// @audit == 0\n92:         if (actionModuleWhitelistData.id == 0) {\n\n```\n\n[92](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L92),\n\n```solidity\nFile: contracts/libraries/LegacyCollectLib.sol\n\n/// @audit != 0\n71:             if (collectParams.referrerProfileId != 0 || collectParams.referrerPubId != 0) {\n\n/// @audit != 0\n71:             if (collectParams.referrerProfileId != 0 || collectParams.referrerPubId != 0) {\n\n/// @audit == 0\n91:             referrerProfileId: collectParams.referrerProfileId == 0\n\n```\n\n[71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L71), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L71), [91](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L91),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n/// @audit != 0\n472:         if (signature.signer.code.length != 0) {\n\n```\n\n[472](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L472),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n/// @audit == 0\n70:             if (bytes(handle).length == 0) {\n\n/// @audit != 0\n129:         if (mintTimestamp != 0) {\n\n```\n\n[70](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L70), [129](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L129),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n/// @audit == 0\n173:         if (uint8(pubType) == 0) {\n\n/// @audit != 0\n175:             if (_publication.pointedProfileId != 0) {\n\n/// @audit > 0\n358:             if (commentParams.referrerProfileIds.length > 0) {\n\n/// @audit > 0\n346:                 if (commentParams.referrerProfileIds.length > 0) {\n\n/// @audit > 0\n411:             if (quoteParams.referrerProfileIds.length > 0) {\n\n/// @audit > 0\n399:                 if (quoteParams.referrerProfileIds.length > 0) {\n\n/// @audit > 0\n464:             if (mirrorParams.referrerProfileIds.length > 0) {\n\n/// @audit > 0\n452:                 if (mirrorParams.referrerProfileIds.length > 0) {\n\n/// @audit != 0\n498:             if (enabledActionModulesBitmap & actionModuleIdBitmapMask != 0) {\n\n```\n\n[173](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L173), [175](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L175), [358](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L358), [346](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L346), [411](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L411), [399](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L399), [464](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L464), [452](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L452), [498](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L498),\n\n```solidity\nFile: contracts/libraries/ValidationLib.sol\n\n/// @audit == 0\n149:         if (referrerPubId == 0) {\n\n/// @audit == 0\n221:                     _referrerPub.rootPubId == 0 ||\n\n```\n\n[149](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L149), [221](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L221),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n/// @audit == 0\n129:         if (mintTimestamp == 0) {\n\n/// @audit == 0\n479:                 if (reason.length == 0) {\n\n```\n\n[129](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L129), [479](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L479),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n/// @audit != 0\n64:         if (StorageLib.tokenGuardianDisablingTimestamp()[msg.sender] != 0) {\n\n/// @audit == 0\n78:         if (StorageLib.tokenGuardianDisablingTimestamp()[msg.sender] == 0) {\n\n/// @audit == 0\n145:             (StorageLib.tokenGuardianDisablingTimestamp()[wallet] == 0 ||\n\n```\n\n[64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L64), [78](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L78), [145](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L145),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n/// @audit != 0\n114:         if (_tokenGuardianDisablingTimestamp[msg.sender] != 0) {\n\n/// @audit == 0\n127:         if (_tokenGuardianDisablingTimestamp[msg.sender] == 0) {\n\n/// @audit == 0\n170:         if (bytes(localName).length == 0) {\n\n/// @audit == 0\n206:         if (localNameLength == 0 || localNameLength + SEPARATOR_LENGTH + NAMESPACE_LENGTH > MAX_HANDLE_LENGTH) {\n\n/// @audit == -\n211:         if (firstByte == '-' || firstByte == '_') {\n\n/// @audit == _\n211:         if (firstByte == '-' || firstByte == '_') {\n\n/// @audit != -\n217:             if (!_isAlphaNumeric(localNameAsBytes[i]) && localNameAsBytes[i] != '-' && localNameAsBytes[i] != '_') {\n\n/// @audit != _\n217:             if (!_isAlphaNumeric(localNameAsBytes[i]) && localNameAsBytes[i] != '-' && localNameAsBytes[i] != '_') {\n\n/// @audit == 0\n230:         if (localNameLength == 0 || localNameLength + SEPARATOR_LENGTH + NAMESPACE_LENGTH > MAX_HANDLE_LENGTH) {\n\n/// @audit == _\n234:         if (localNameAsBytes[0] == '_') {\n\n/// @audit != _\n240:             if (!_isAlphaNumeric(localNameAsBytes[i]) && localNameAsBytes[i] != '_') {\n\n/// @audit >= 0\n250:         return (char >= '0' && char <= '9') || (char >= 'a' && char <= 'z');\n\n/// @audit <= 9\n250:         return (char >= '0' && char <= '9') || (char >= 'a' && char <= 'z');\n\n/// @audit >= a\n250:         return (char >= '0' && char <= '9') || (char >= 'a' && char <= 'z');\n\n/// @audit <= z\n250:         return (char >= '0' && char <= '9') || (char >= 'a' && char <= 'z');\n\n/// @audit == 0\n256:             (_tokenGuardianDisablingTimestamp[wallet] == 0 ||\n\n```\n\n[114](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L114), [127](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L127), [170](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L170), [206](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L206), [211](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L211), [211](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L211), [217](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L217), [217](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L217), [230](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L230), [234](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L234), [240](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L240), [250](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L250), [250](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L250), [250](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L250), [250](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L250), [256](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L256),\n\n```solidity\nFile: contracts/namespaces/TokenHandleRegistry.sol\n\n/// @audit == 0\n100:         if (resolvedTokenId == 0 || !ILensHub(LENS_HUB).exists(resolvedTokenId)) {\n\n/// @audit == 0\n112:         if (defaultHandleId == 0 || !ILensHandles(LENS_HANDLES).exists(defaultHandleId)) {\n\n/// @audit != 0\n146:         if (tokenPointedByHandle.collection != address(0) || tokenPointedByHandle.id != 0) {\n\n/// @audit != 0\n154:         if (handlePointedByToken.collection != address(0) || handlePointedByToken.id != 0) {\n\n```\n\n[100](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L100), [112](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L112), [146](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L146), [154](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L154),\n\n</details>\n\n### <a name=\"N-12\"></a>[N-12] Contract implements interface without extending the interface\nNot extending the interface may lead to the wrong function signature being used, leading to unexpected behavior. If the interface is in fact being implemented, use the `override` keyword to indicate that fact\n\n*Instances (1)*:\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n/// @audit IERC2981.royaltyInfo()\n9: abstract contract ERC2981CollectionRoyalties is IERC2981 {\n\n```\n\n[9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L9),\n\n### <a name=\"N-13\"></a>[N-13] Custom error has no error details\nConsider adding parameters to the error to indicate which user or values caused the failure\n\n*Instances (63)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/libraries/constants/Errors.sol\n\n6:     error CannotInitImplementation();\n\n7:     error Initialized();\n\n8:     error SignatureExpired();\n\n9:     error SignatureInvalid();\n\n10:     error InvalidOwner();\n\n11:     error NotOwnerOrApproved();\n\n12:     error NotHub();\n\n13:     error TokenDoesNotExist();\n\n14:     error NotGovernance();\n\n15:     error NotGovernanceOrEmergencyAdmin();\n\n16:     error EmergencyAdminCanOnlyPauseFurther();\n\n17:     error NotProfileOwner();\n\n18:     error PublicationDoesNotExist();\n\n19:     error ProfileImageURILengthInvalid();\n\n20:     error CallerNotFollowNFT();\n\n21:     error CallerNotCollectNFT(); // Legacy\n\n22:     error ArrayMismatch();\n\n23:     error NotWhitelisted();\n\n24:     error InvalidParameter();\n\n25:     error ExecutorInvalid();\n\n26:     error Blocked();\n\n27:     error SelfBlock();\n\n28:     error NotFollowing();\n\n29:     error SelfFollow();\n\n30:     error InvalidReferrer();\n\n31:     error InvalidPointedPub();\n\n32:     error NonERC721ReceiverImplementer();\n\n33:     error AlreadyEnabled();\n\n36:     error MaxActionModuleIdReached(); // This means we need an upgrade\n\n39:     error InitParamsInvalid();\n\n40:     error ActionNotAllowed();\n\n42:     error CollectNotAllowed(); // Used in LegacyCollectLib (pending deprecation)\n\n45:     error Paused();\n\n46:     error PublishingPaused();\n\n49:     error GuardianEnabled();\n\n50:     error NotEOA();\n\n51:     error DisablingAlreadyTriggered();\n\n```\n\n[6](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L6), [7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L7), [8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L8), [9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L9), [10](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L10), [11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L11), [12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L12), [13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L13), [14](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L14), [15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L15), [16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L16), [17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L17), [18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L18), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L19), [20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L20), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L21), [22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L22), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L23), [24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L24), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L25), [26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L26), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L27), [28](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L28), [29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L29), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L30), [31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L31), [32](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L32), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L33), [36](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L36), [39](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L39), [40](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L40), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L42), [45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L45), [46](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L46), [49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L49), [50](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L50), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L51),\n\n```solidity\nFile: contracts/misc/ImmutableOwnable.sol\n\n9:     error OnlyOwner();\n\n10:     error OnlyOwnerOrHub();\n\n```\n\n[9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L9), [10](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L10),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n10:     error Unauthorized();\n\n```\n\n[10](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L10),\n\n```solidity\nFile: contracts/namespaces/constants/Errors.sol\n\n6:     error NotHandleOwner();\n\n7:     error NotTokenOwner();\n\n8:     error NotHandleNorTokenOwner();\n\n9:     error OnlyLensHub();\n\n10:     error NotLinked();\n\n11:     error DoesNotExist();\n\n15:     error HandleLengthInvalid();\n\n16:     error HandleContainsInvalidCharacters();\n\n17:     error HandleFirstCharInvalid();\n\n18:     error NotOwnerNorWhitelisted();\n\n19:     error NotOwner();\n\n20:     error NotHub();\n\n21:     error DoesNotExist();\n\n22:     error NotEOA();\n\n23:     error DisablingAlreadyTriggered();\n\n24:     error GuardianEnabled();\n\n25:     error AlreadyEnabled();\n\n```\n\n[6](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L6), [7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L7), [8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L8), [9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L9), [10](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L10), [11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L11), [15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L15), [16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L16), [17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L17), [18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L18), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L19), [20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L20), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L21), [22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L22), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L23), [24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L24), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L25),\n\n```solidity\nFile: contracts/interfaces/IFollowNFT.sol\n\n18:     error AlreadyFollowing();\n\n19:     error NotFollowing();\n\n20:     error FollowTokenDoesNotExist();\n\n21:     error AlreadyWrapped();\n\n22:     error OnlyWrappedFollowTokens();\n\n23:     error DoesNotHavePermissions();\n\n```\n\n[18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L18), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L19), [20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L20), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L21), [22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L22), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L23),\n\n</details>\n\n### <a name=\"N-14\"></a>[N-14] Empty Function Body - Consider commenting why\n\n*Instances (2)*:\n\n```solidity\nFile: contracts/LensHub.sol\n\n66:     constructor(\n67:            address moduleGlobals,\n68:            address followNFTImpl,\n69:            address collectNFTImpl, // We still pass the deprecated CollectNFTImpl for legacy Collects to work\n70:            address lensHandlesAddress,\n71:            address tokenHandleRegistryAddress,\n72:            address legacyFeeFollowModule,\n73:            address legacyProfileFollowModule,\n74:            address newFeeFollowModule,\n75:            uint256 tokenGuardianCooldown\n76:        )\n77:            LensProfiles(moduleGlobals, tokenGuardianCooldown)\n78:            LensV2Migration(\n79:                legacyFeeFollowModule,\n80:                legacyProfileFollowModule,\n81:                newFeeFollowModule,\n82:                lensHandlesAddress,\n83:                tokenHandleRegistryAddress\n84:            )\n85:            LensImplGetters(followNFTImpl, collectNFTImpl)\n86:        {}\n\n```\n\n[66](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L66),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n506:     function _beforeTokenTransfer(\n507:             address from,\n508:             address to,\n509:             uint256 tokenId\n510:         ) internal virtual {}\n\n```\n\n[506](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L506),\n\n### <a name=\"N-15\"></a>[N-15] Events are missing sender information\nWhen an action is triggered based on a user's action, not being able to filter based on who triggered the action makes event processing a lot more cumbersome. Including the `msg.sender` the events of these types of action will make events much more useful to end users.\n\n*Instances (42)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n430:         emit FollowApproval(approvedProfileId, followTokenId);\n\n```\n\n[430](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L430),\n\n```solidity\nFile: contracts/libraries/ActionLib.sol\n\n60:         emit Events.Acted(publicationActionParams, actionModuleReturnData, block.timestamp);\n\n```\n\n[60](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L60),\n\n```solidity\nFile: contracts/libraries/FollowLib.sol\n\n75:             emit Events.Unfollowed(unfollowerProfileId, idOfProfileToUnfollow, block.timestamp);\n\n93:         emit Events.FollowNFTDeployed(profileId, followNFT, block.timestamp);\n\n131:         emit Events.Followed(\n\n```\n\n[75](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L75), [93](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L93), [131](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L131),\n\n```solidity\nFile: contracts/libraries/GovernanceLib.sol\n\n73:         emit Events.ProfileCreatorWhitelisted(profileCreator, whitelist, block.timestamp);\n\n78:         emit Events.FollowModuleWhitelisted(followModule, whitelist, block.timestamp);\n\n83:         emit Events.ReferenceModuleWhitelisted(referenceModule, whitelist, block.timestamp);\n\n109:         emit Events.ActionModuleWhitelisted(actionModule, id, whitelist, block.timestamp);\n\n```\n\n[73](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L73), [78](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L78), [83](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L83), [109](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L109),\n\n```solidity\nFile: contracts/libraries/LegacyCollectLib.sol\n\n102:         emit CollectedLegacy({\n\n142:         emit Events.CollectNFTDeployed(profileId, pubId, collectNFT, block.timestamp);\n\n```\n\n[102](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L102), [142](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L142),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n86:             emit ProfileMigrated(profileId, profileOwner, handle, handleId);\n\n130:             emit Events.Followed({\n\n```\n\n[86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L86), [130](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L130),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n102:         emit Events.FollowModuleSet(profileId, followModule, followModuleReturnData, block.timestamp);\n\n107:         emit Events.ProfileMetadataSet(profileId, metadataURI, block.timestamp);\n\n125:         emit Events.ProfileImageURISet(profileId, imageURI, block.timestamp);\n\n151:                     emit Events.Unfollowed(idOfProfileToSetBlockStatus, byProfileId, block.timestamp);\n\n158:                 emit Events.Unblocked(byProfileId, idOfProfileToSetBlockStatus, block.timestamp);\n\n156:                 emit Events.Blocked(byProfileId, idOfProfileToSetBlockStatus, block.timestamp);\n\n245:         emit Events.DelegatedExecutorsConfigChanged(\n\n```\n\n[102](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L102), [107](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L107), [125](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L125), [151](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L151), [158](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L158), [156](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L156), [245](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L245),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n45:         emit Events.PostCreated(\n\n84:         emit Events.CommentCreated(\n\n128:         emit Events.MirrorCreated(mirrorParams, pubIdAssigned, referenceModuleReturnData, block.timestamp);\n\n158:         emit Events.QuoteCreated(\n\n```\n\n[45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L45), [84](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L84), [128](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L128), [158](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L158),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n367:         emit Transfer(address(0), to, tokenId);\n\n394:         emit Transfer(owner, address(0), tokenId);\n\n431:         emit Transfer(from, to, tokenId);\n\n441:         emit Approval(ownerOf(tokenId), to, tokenId);\n\n456:         emit ApprovalForAll(owner, operator, approved);\n\n```\n\n[367](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L367), [394](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L394), [431](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L431), [441](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L441), [456](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L456),\n\n```solidity\nFile: contracts/base/LensHubEventHooks.sol\n\n17:         emit Events.Unfollowed(unfollowerProfileId, idOfProfileUnfollowed, block.timestamp);\n\n36:         emit Events.CollectNFTTransferred(profileId, pubId, collectNFTId, from, to, block.timestamp);\n\n```\n\n[17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubEventHooks.sol#L17), [36](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubEventHooks.sol#L36),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n98:         emit Events.ModuleGlobalsGovernanceSet(prevGovernance, newGovernance, block.timestamp);\n\n105:         emit Events.ModuleGlobalsTreasurySet(prevTreasury, newTreasury, block.timestamp);\n\n112:         emit Events.ModuleGlobalsTreasuryFeeSet(prevTreasuryFee, newTreasuryFee, block.timestamp);\n\n119:         emit Events.ModuleGlobalsCurrencyWhitelisted(currency, prevWhitelisted, toWhitelist, block.timestamp);\n\n```\n\n[98](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L98), [105](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L105), [112](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L112), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L119),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n26:         emit ControllerContractUpdated(controllerContract, address(0));\n\n31:         emit ControllerContractUpdated(controllerContract, newControllerContract);\n\n```\n\n[26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L26), [31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L31),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n198:         emit HandlesEvents.HandleMinted(localName, NAMESPACE, tokenId, to, block.timestamp);\n\n```\n\n[198](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L198),\n\n```solidity\nFile: contracts/namespaces/TokenHandleRegistry.sol\n\n141:         emit RegistryEvents.HandleLinked(handle, token, block.timestamp);\n\n148:             emit RegistryEvents.HandleUnlinked(handle, tokenPointedByHandle, block.timestamp);\n\n156:             emit RegistryEvents.HandleUnlinked(handlePointedByToken, token, block.timestamp);\n\n164:         emit RegistryEvents.HandleUnlinked(handle, token, block.timestamp);\n\n```\n\n[141](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L141), [148](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L148), [156](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L156), [164](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L164),\n\n</details>\n\n### <a name=\"N-16\"></a>[N-16] Events that mark critical parameter changes should contain both the old and the new value\nThis should especially be done if the new value is not required to be different from the old value\n\n*Instances (2)*:\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n86:             emit ProfileMigrated(profileId, profileOwner, handle, handleId);\n\n```\n\n[86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L86),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n31:         emit ControllerContractUpdated(controllerContract, newControllerContract);\n\n```\n\n[31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L31),\n\n### <a name=\"N-17\"></a>[N-17] Events may be emitted out of order due to reentranc\nEnsure that events follow the best practice of check-effects-interaction, and are emitted before external calls\n\n*Instances (10)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/libraries/ActionLib.sol\n\n/// @audit processPublicationAction() prior to emission of \n60:         emit Events.Acted(publicationActionParams, actionModuleReturnData, block.timestamp);\n\n```\n\n[60](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L60),\n\n```solidity\nFile: contracts/libraries/FollowLib.sol\n\n/// @audit unfollow() prior to emission of \n75:             emit Events.Unfollowed(unfollowerProfileId, idOfProfileToUnfollow, block.timestamp);\n\n/// @audit encodeWithSelector() prior to emission of \n93:         emit Events.FollowNFTDeployed(profileId, followNFT, block.timestamp);\n\n/// @audit processFollow() prior to emission of \n131:         emit Events.Followed(\n\n```\n\n[75](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L75), [93](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L93), [131](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L131),\n\n```solidity\nFile: contracts/libraries/LegacyCollectLib.sol\n\n/// @audit processCollect() prior to emission of CollectedLegacy()\n102:         emit CollectedLegacy({\n\n/// @audit initialize() prior to emission of \n142:         emit Events.CollectNFTDeployed(profileId, pubId, collectNFT, block.timestamp);\n\n```\n\n[102](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L102), [142](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L142),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n/// @audit tryMigrate() prior to emission of \n130:             emit Events.Followed({\n\n```\n\n[130](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L130),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n/// @audit processBlock() prior to emission of \n151:                     emit Events.Unfollowed(idOfProfileToSetBlockStatus, byProfileId, block.timestamp);\n\n/// @audit processBlock() prior to emission of \n158:                 emit Events.Unblocked(byProfileId, idOfProfileToSetBlockStatus, block.timestamp);\n\n/// @audit processBlock() prior to emission of \n156:                 emit Events.Blocked(byProfileId, idOfProfileToSetBlockStatus, block.timestamp);\n\n```\n\n[151](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L151), [158](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L158), [156](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L156),\n\n</details>\n\n### <a name=\"N-18\"></a>[N-18] It is standard for all external and public functions to be override from an interface\nThis is to ensure the whole API is extracted in a interface.\n\n*Instances (230)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/LensHub.sol\n\n492:     function isFollowing(uint256 followerProfileId, uint256 followedProfileId) external view returns (bool) {\n\n498:     function isDelegatedExecutorApproved(\n499:             uint256 delegatorProfileId,\n500:             address delegatedExecutor,\n501:             uint64 configNumber\n502:         ) external view returns (bool) {\n\n507:     function isDelegatedExecutorApproved(uint256 delegatorProfileId, address delegatedExecutor)\n508:             external\n509:             view\n510:             returns (bool)\n511:         {\n\n516:     function getDelegatedExecutorsConfigNumber(uint256 delegatorProfileId) external view returns (uint64) {\n\n521:     function getDelegatedExecutorsPrevConfigNumber(uint256 delegatorProfileId) external view returns (uint64) {\n\n526:     function getDelegatedExecutorsMaxConfigNumberSet(uint256 delegatorProfileId) external view returns (uint64) {\n\n531:     function isBlocked(uint256 profileId, uint256 byProfileId) external view returns (bool) {\n\n```\n\n[492](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L492), [498](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L498), [507](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L507), [516](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L516), [521](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L521), [526](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L526), [531](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L531),\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n480:     function tryMigrate(\n481:             uint256 followerProfileId,\n482:             address followerProfileOwner,\n483:             uint256 idOfProfileFollowed,\n484:             uint256 followTokenId\n485:         ) external onlyHub returns (uint48) {\n\n```\n\n[480](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L480),\n\n```solidity\nFile: contracts/libraries/ActionLib.sol\n\n13:     function act(\n14:            Types.PublicationActionParams calldata publicationActionParams,\n15:            address transactionExecutor,\n16:            address actorProfileOwner\n17:        ) external returns (bytes memory) {\n\n```\n\n[13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L13),\n\n```solidity\nFile: contracts/libraries/FollowLib.sol\n\n15:     function follow(\n16:            uint256 followerProfileId,\n17:            address transactionExecutor,\n18:            uint256[] calldata idsOfProfilesToFollow,\n19:            uint256[] calldata followTokenIds,\n20:            bytes[] calldata followModuleDatas\n21:        ) external returns (uint256[] memory) {\n\n54:     function unfollow(\n55:            uint256 unfollowerProfileId,\n56:            address transactionExecutor,\n57:            uint256[] calldata idsOfProfilesToUnfollow\n58:        ) external {\n\n```\n\n[15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L15), [54](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L54),\n\n```solidity\nFile: contracts/libraries/GovernanceLib.sol\n\n16:     function setGovernance(address newGovernance) external {\n\n27:     function setEmergencyAdmin(address newEmergencyAdmin) external {\n\n39:     function initState(Types.ProtocolState newState) external {\n\n50:     function setState(Types.ProtocolState newState) external {\n\n71:     function whitelistProfileCreator(address profileCreator, bool whitelist) external {\n\n76:     function whitelistFollowModule(address followModule, bool whitelist) external {\n\n81:     function whitelistReferenceModule(address referenceModule, bool whitelist) external {\n\n86:     function whitelistActionModule(address actionModule, bool whitelist) external {\n\n```\n\n[16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L16), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L27), [39](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L39), [50](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L50), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L71), [76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L76), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L81), [86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L86),\n\n```solidity\nFile: contracts/libraries/LegacyCollectLib.sol\n\n45:     function collect(\n46:            Types.CollectParams calldata collectParams,\n47:            address transactionExecutor,\n48:            address collectorProfileOwner,\n49:            address collectNFTImpl\n50:        ) external returns (uint256) {\n\n```\n\n[45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L45),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n43:     function validateSetProfileMetadataURISignature(\n44:            Types.EIP712Signature calldata signature,\n45:            uint256 profileId,\n46:            string calldata metadataURI\n47:        ) external {\n\n64:     function validateSetFollowModuleSignature(\n65:            Types.EIP712Signature calldata signature,\n66:            uint256 profileId,\n67:            address followModule,\n68:            bytes calldata followModuleInitData\n69:        ) external {\n\n87:     function validateChangeDelegatedExecutorsConfigSignature(\n88:            Types.EIP712Signature calldata signature,\n89:            uint256 delegatorProfileId,\n90:            address[] calldata delegatedExecutors,\n91:            bool[] calldata approvals,\n92:            uint64 configNumber,\n93:            bool switchToGivenConfig\n94:        ) external {\n\n116:     function validateSetProfileImageURISignature(\n117:             Types.EIP712Signature calldata signature,\n118:             uint256 profileId,\n119:             string calldata imageURI\n120:         ) external {\n\n137:     function validatePostSignature(Types.EIP712Signature calldata signature, Types.PostParams calldata postParams)\n138:             external\n139:         {\n\n225:     function validateCommentSignature(\n226:             Types.EIP712Signature calldata signature,\n227:             Types.CommentParams calldata commentParams\n228:         ) external {\n\n256:     function validateQuoteSignature(Types.EIP712Signature calldata signature, Types.QuoteParams calldata quoteParams)\n257:             external\n258:         {\n\n286:     function validateMirrorSignature(Types.EIP712Signature calldata signature, Types.MirrorParams calldata mirrorParams)\n287:             external\n288:         {\n\n309:     function validateBurnSignature(Types.EIP712Signature calldata signature, uint256 tokenId) external {\n\n320:     function validateFollowSignature(\n321:             Types.EIP712Signature calldata signature,\n322:             uint256 followerProfileId,\n323:             uint256[] calldata idsOfProfilesToFollow,\n324:             uint256[] calldata followTokenIds,\n325:             bytes[] calldata datas\n326:         ) external {\n\n357:     function validateUnfollowSignature(\n358:             Types.EIP712Signature calldata signature,\n359:             uint256 unfollowerProfileId,\n360:             uint256[] calldata idsOfProfilesToUnfollow\n361:         ) external {\n\n378:     function validateSetBlockStatusSignature(\n379:             Types.EIP712Signature calldata signature,\n380:             uint256 byProfileId,\n381:             uint256[] calldata idsOfProfilesToSetBlockStatus,\n382:             bool[] calldata blockStatus\n383:         ) external {\n\n401:     function validateLegacyCollectSignature(\n402:             Types.EIP712Signature calldata signature,\n403:             Types.CollectParams calldata collectParams\n404:         ) external {\n\n425:     function validateActSignature(\n426:             Types.EIP712Signature calldata signature,\n427:             Types.PublicationActionParams calldata publicationActionParams\n428:         ) external {\n\n```\n\n[43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L43), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L64), [87](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L87), [116](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L116), [137](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L137), [225](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L225), [256](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L256), [286](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L286), [309](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L309), [320](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L320), [357](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L357), [378](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L378), [401](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L401), [425](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L425),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n20:     function getProfileData(uint256 profileId) external view returns (ProfileData memory);\n\n37:     function batchMigrateProfiles(\n38:            uint256[] calldata profileIds,\n39:            LensHandles lensHandles,\n40:            TokenHandleRegistry tokenHandleRegistry\n41:        ) external {\n\n94:     function batchMigrateFollows(\n95:            uint256[] calldata followerProfileIds,\n96:            uint256[] calldata idsOfProfileFollowed,\n97:            uint256[] calldata followTokenIds\n98:        ) external {\n\n141:     function batchMigrateFollowModules(\n142:             uint256[] calldata profileIds,\n143:             address legacyFeeFollowModule,\n144:             address legacyProfileFollowModule,\n145:             address newFeeFollowModule\n146:         ) external {\n\n```\n\n[20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L20), [37](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L37), [94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L94), [141](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L141),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n39:     function createProfile(Types.CreateProfileParams calldata createProfileParams, uint256 profileId) external {\n\n81:     function setProfileImageURI(uint256 profileId, string calldata imageURI) external {\n\n92:     function setFollowModule(\n93:            uint256 profileId,\n94:            address followModule,\n95:            bytes calldata followModuleInitData\n96:        ) external {\n\n105:     function setProfileMetadataURI(uint256 profileId, string calldata metadataURI) external {\n\n128:     function setBlockStatus(\n129:             uint256 byProfileId,\n130:             uint256[] calldata idsOfProfilesToSetBlockStatus,\n131:             bool[] calldata blockStatus\n132:         ) external {\n\n166:     function switchToNewFreshDelegatedExecutorsConfig(uint256 profileId) external {\n\n180:     function changeDelegatedExecutorsConfig(\n181:             uint256 delegatorProfileId,\n182:             address[] calldata delegatedExecutors,\n183:             bool[] calldata approvals\n184:         ) external {\n\n198:     function changeGivenDelegatedExecutorsConfig(\n199:             uint256 delegatorProfileId,\n200:             address[] calldata delegatedExecutors,\n201:             bool[] calldata approvals,\n202:             uint64 configNumber,\n203:             bool switchToGivenConfig\n204:         ) external {\n\n215:     function isExecutorApproved(uint256 delegatorProfileId, address delegatedExecutor) external view returns (bool) {\n\n```\n\n[39](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L39), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L81), [92](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L92), [105](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L105), [128](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L128), [166](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L166), [180](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L180), [198](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L198), [215](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L215),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n22:     function post(Types.PostParams calldata postParams, address transactionExecutor) external returns (uint256) {\n\n63:     function comment(Types.CommentParams calldata commentParams, address transactionExecutor)\n64:            external\n65:            returns (uint256)\n66:        {\n\n103:     function mirror(Types.MirrorParams calldata mirrorParams, address transactionExecutor) external returns (uint256) {\n\n140:     function quote(Types.QuoteParams calldata quoteParams, address transactionExecutor) external returns (uint256) {\n\n190:     function getContentURI(uint256 profileId, uint256 pubId) external view returns (string memory) {\n\n```\n\n[22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L22), [63](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L63), [103](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L103), [140](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L140), [190](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L190),\n\n```solidity\nFile: contracts/libraries/ValidationLib.sol\n\n121:     function validateLegacyCollectReferrer(\n122:             uint256 referrerProfileId,\n123:             uint256 referrerPubId,\n124:             uint256 publicationCollectedProfileId,\n125:             uint256 publicationCollectedId\n126:         ) external view {\n\n```\n\n[121](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L121),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n17:     function supportsInterface(bytes4 interfaceId) public view virtual returns (bool) {\n\n26:     function setRoyalty(uint256 royaltiesInBasisPoints) external {\n\n39:     function royaltyInfo(uint256 tokenId, uint256 salePrice) external view returns (address, uint256) {\n\n```\n\n[17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L17), [26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L26), [39](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L39),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n79:     function tokenURI(uint256 tokenId) external view virtual returns (string memory);\n\n```\n\n[79](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L79),\n\n```solidity\nFile: contracts/base/LensHubEventHooks.sol\n\n25:     function emitCollectNFTTransferEvent(\n26:            uint256 profileId,\n27:            uint256 pubId,\n28:            uint256 collectNFTId,\n29:            address from,\n30:            address to\n31:        ) external {\n\n```\n\n[25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubEventHooks.sol#L25),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n58:     function getTokenGuardianDisablingTimestamp(address wallet) external view returns (uint256) {\n\n63:     function DANGER__disableTokenGuardian() external onlyEOA {\n\n77:     function enableTokenGuardian() external onlyEOA {\n\n```\n\n[58](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L58), [63](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L63), [77](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L77),\n\n```solidity\nFile: contracts/misc/LensV2Migration.sol\n\n33:     function batchMigrateProfiles(uint256[] calldata profileIds) external {\n\n37:     function batchMigrateFollows(\n38:            uint256[] calldata followerProfileIds,\n39:            uint256[] calldata idsOfProfileFollowed,\n40:            uint256[] calldata followTokenIds\n41:        ) external {\n\n45:     function batchMigrateFollowModules(uint256[] calldata profileIds) external {\n\n```\n\n[33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L33), [37](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L37), [45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L45),\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n44:     function executeLensV2Upgrade() external onlyOwner {\n\n```\n\n[44](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L44),\n\n```solidity\nFile: contracts/misc/ProfileCreationProxy.sol\n\n33:     function proxyCreateProfile(Types.CreateProfileParams calldata createProfileParams)\n34:            external\n35:            onlyOwner\n36:            returns (uint256)\n37:        {\n\n41:     function proxyCreateProfileWithHandle(Types.CreateProfileParams memory createProfileParams, string calldata handle)\n42:            external\n43:            onlyOwner\n44:            returns (uint256, uint256)\n45:        {\n\n64:     function proxyCreateHandle(address to, string calldata handle) external onlyOwner returns (uint256) {\n\n```\n\n[33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L33), [41](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L41), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L64),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n25:     function clearControllerContract() external onlyOwnerOrControllerContract {\n\n30:     function setControllerContract(address newControllerContract) external onlyOwner {\n\n```\n\n[25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L25), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L30),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n9:     function whitelistCollectModule(address collectModule, bool whitelist) external;\n\n23:     function lensHub_setGovernance(address newGovernance) external onlyOwner {\n\n27:     function lensHub_setEmergencyAdmin(address newEmergencyAdmin) external onlyOwner {\n\n35:     function lensHub_whitelistProfileCreator(address profileCreator, bool whitelist)\n36:            external\n37:            onlyOwnerOrControllerContract\n38:        {\n\n42:     function lensHub_whitelistFollowModule(address followModule, bool whitelist)\n43:            external\n44:            onlyOwnerOrControllerContract\n45:        {\n\n49:     function lensHub_whitelistReferenceModule(address referenceModule, bool whitelist)\n50:            external\n51:            onlyOwnerOrControllerContract\n52:        {\n\n56:     function lensHub_whitelistActionModule(address actionModule, bool whitelist)\n57:            external\n58:            onlyOwnerOrControllerContract\n59:        {\n\n64:     function lensHub_whitelistCollectModule(address collectModule, bool whitelist)\n65:            external\n66:            onlyOwnerOrControllerContract\n67:        {\n\n73:     function executeAsGovernance(address target, bytes calldata data)\n74:            external\n75:            payable\n76:            onlyOwnerOrControllerContract\n77:            returns (bytes memory)\n78:        {\n\n```\n\n[9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L9), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L23), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L27), [35](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L35), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L42), [49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L49), [56](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L56), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L64), [73](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L73),\n\n```solidity\nFile: contracts/misc/access/ProxyAdmin.sol\n\n21:     function currentImplementation() external returns (address) {\n\n29:     function rollbackLastUpgrade() external onlyOwner {\n\n33:     function proxy_changeAdmin(address newAdmin) external onlyOwner {\n\n41:     function proxy_upgrade(address newImplementation) external onlyOwnerOrControllerContract {\n\n47:     function proxy_upgradeAndCall(address newImplementation, bytes calldata data)\n48:            external\n49:            onlyOwnerOrControllerContract\n50:        {\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L21), [29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L29), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L33), [41](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L41), [47](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L47),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n87:     function mintHandle(address to, string calldata localName)\n88:            external\n89:            onlyOwnerOrWhitelistedProfileCreator\n90:            returns (uint256)\n91:        {\n\n96:     function migrateHandle(address to, string calldata localName) external onlyHub returns (uint256) {\n\n101:     function burn(uint256 tokenId) external {\n\n113:     function DANGER__disableTokenGuardian() external onlyEOA {\n\n126:     function enableTokenGuardian() external onlyEOA {\n\n155:     function exists(uint256 tokenId) external view returns (bool) {\n\n159:     function getNamespace() external pure returns (string memory) {\n\n163:     function getNamespaceHash() external pure returns (bytes32) {\n\n168:     function getLocalName(uint256 tokenId) public view returns (string memory) {\n\n177:     function getHandle(uint256 tokenId) public view returns (string memory) {\n\n182:     function getTokenId(string memory localName) public pure returns (uint256) {\n\n186:     function getTokenGuardianDisablingTimestamp(address wallet) external view returns (uint256) {\n\n```\n\n[87](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L87), [96](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L96), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L101), [113](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L113), [126](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L126), [155](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L155), [159](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L159), [163](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L163), [168](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L168), [177](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L177), [182](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L182), [186](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L186),\n\n```solidity\nFile: contracts/namespaces/TokenHandleRegistry.sol\n\n50:     function migrationLink(uint256 handleId, uint256 tokenId) external {\n\n61:     function link(\n62:            uint256 handleId,\n63:            uint256 tokenId\n64:        ) external onlyTokenOwner(tokenId, msg.sender) onlyHandleOwner(handleId, msg.sender) {\n\n72:     function unlink(uint256 handleId, uint256 tokenId) external {\n\n94:     function resolve(uint256 handleId) external view returns (uint256) {\n\n107:     function getDefaultHandle(uint256 tokenId) external view returns (uint256) {\n\n```\n\n[50](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L50), [61](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L61), [72](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L72), [94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L94), [107](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L107),\n\n```solidity\nFile: contracts/interfaces/ICollectModule.sol\n\n31:     function initializePublicationCollectModule(\n\n47:     function processCollect(Types.ProcessCollectParams calldata processCollectParams) external returns (bytes memory);\n\n```\n\n[31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ICollectModule.sol#L31), [47](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ICollectModule.sol#L47),\n\n```solidity\nFile: contracts/interfaces/ICollectNFT.sol\n\n21:     function initialize(uint256 profileId, uint256 pubId) external;\n\n32:     function mint(address to) external returns (uint256);\n\n39:     function getSourcePublicationPointer() external view returns (uint256, uint256);\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ICollectNFT.sol#L21), [32](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ICollectNFT.sol#L32), [39](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ICollectNFT.sol#L39),\n\n```solidity\nFile: contracts/interfaces/IERC721Burnable.sol\n\n18:     function burn(uint256 tokenId) external;\n\n```\n\n[18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IERC721Burnable.sol#L18),\n\n```solidity\nFile: contracts/interfaces/IERC721MetaTx.sol\n\n19:     function nonces(address signer) external view returns (uint256);\n\n26:     function getDomainSeparator() external view returns (bytes32);\n\n```\n\n[19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IERC721MetaTx.sol#L19), [26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IERC721MetaTx.sol#L26),\n\n```solidity\nFile: contracts/interfaces/IERC721Timestamped.sol\n\n23:     function mintTimestampOf(uint256 tokenId) external view returns (uint256);\n\n33:     function tokenDataOf(uint256 tokenId) external view returns (Types.TokenData memory);\n\n42:     function exists(uint256 tokenId) external view returns (bool);\n\n49:     function totalSupply() external view returns (uint256);\n\n```\n\n[23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IERC721Timestamped.sol#L23), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IERC721Timestamped.sol#L33), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IERC721Timestamped.sol#L42), [49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IERC721Timestamped.sol#L49),\n\n```solidity\nFile: contracts/interfaces/IFollowModule.sol\n\n28:     function initializeFollowModule(\n\n48:     function processFollow(\n\n```\n\n[28](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowModule.sol#L28), [48](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowModule.sol#L48),\n\n```solidity\nFile: contracts/interfaces/IFollowNFT.sol\n\n33:     function initialize(uint256 profileId) external;\n\n46:     function follow(\n\n59:     function unfollow(uint256 unfollowerProfileId, address transactionExecutor) external;\n\n69:     function removeFollower(uint256 followTokenId) external;\n\n83:     function approveFollow(uint256 approvedProfileId, uint256 followTokenId) external;\n\n94:     function wrap(uint256 followTokenId) external;\n\n106:     function wrap(uint256 followTokenId, address wrappedTokenReceiver) external;\n\n114:     function unwrap(uint256 followTokenId) external;\n\n125:     function processBlock(uint256 followerProfileId) external returns (bool);\n\n138:     function getFollowerProfileId(uint256 followTokenId) external view returns (uint256);\n\n147:     function getOriginalFollowTimestamp(uint256 followTokenId) external view returns (uint256);\n\n156:     function getFollowTimestamp(uint256 followTokenId) external view returns (uint256);\n\n165:     function getProfileIdAllowedToRecover(uint256 followTokenId) external view returns (uint256);\n\n174:     function getFollowData(uint256 followTokenId) external view returns (Types.FollowData memory);\n\n183:     function isFollowing(uint256 followerProfileId) external view returns (bool);\n\n192:     function getFollowTokenId(uint256 followerProfileId) external view returns (uint256);\n\n201:     function getFollowApproved(uint256 followTokenId) external view returns (uint256);\n\n209:     function getFollowerCount() external view returns (uint256);\n\n```\n\n[33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L33), [46](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L46), [59](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L59), [69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L69), [83](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L83), [94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L94), [106](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L106), [114](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L114), [125](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L125), [138](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L138), [147](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L147), [156](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L156), [165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L165), [174](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L174), [183](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L183), [192](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L192), [201](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L201), [209](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L209),\n\n```solidity\nFile: contracts/interfaces/ILegacyCollectModule.sol\n\n23:     function initializePublicationCollectModule(\n\n38:     function processCollect(\n\n```\n\n[23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyCollectModule.sol#L23), [38](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyCollectModule.sol#L38),\n\n```solidity\nFile: contracts/interfaces/ILegacyCollectNFT.sol\n\n23:     function initialize(\n\n38:     function mint(address to) external returns (uint256);\n\n45:     function getSourcePublicationPointer() external view returns (uint256, uint256);\n\n```\n\n[23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyCollectNFT.sol#L23), [38](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyCollectNFT.sol#L38), [45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyCollectNFT.sol#L45),\n\n```solidity\nFile: contracts/interfaces/ILegacyFollowModule.sol\n\n20:     function initializeFollowModule(uint256 profileId, bytes calldata data) external returns (bytes memory);\n\n29:     function processFollow(\n\n48:     function followModuleTransferHook(\n\n77:     function isFollowing(\n\n```\n\n[20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyFollowModule.sol#L20), [29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyFollowModule.sol#L29), [48](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyFollowModule.sol#L48), [77](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyFollowModule.sol#L77),\n\n```solidity\nFile: contracts/interfaces/ILegacyReferenceModule.sol\n\n23:     function initializeReferenceModule(\n\n37:     function processComment(\n\n52:     function processMirror(\n\n```\n\n[23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyReferenceModule.sol#L23), [37](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyReferenceModule.sol#L37), [52](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyReferenceModule.sol#L52),\n\n```solidity\nFile: contracts/interfaces/ILensGovernable.sol\n\n20:     function setGovernance(address newGovernance) external;\n\n28:     function setEmergencyAdmin(address newEmergencyAdmin) external;\n\n39:     function setState(Types.ProtocolState newState) external;\n\n48:     function whitelistProfileCreator(address profileCreator, bool whitelist) external;\n\n57:     function whitelistFollowModule(address followModule, bool whitelist) external;\n\n66:     function whitelistReferenceModule(address referenceModule, bool whitelist) external;\n\n76:     function whitelistActionModule(address actionModule, bool whitelist) external;\n\n83:     function getGovernance() external view returns (address);\n\n92:     function getState() external view returns (Types.ProtocolState);\n\n101:     function isProfileCreatorWhitelisted(address profileCreator) external view returns (bool);\n\n110:     function isFollowModuleWhitelisted(address followModule) external view returns (bool);\n\n119:     function isReferenceModuleWhitelisted(address referenceModule) external view returns (bool);\n\n129:     function getActionModuleWhitelistData(address actionModule)\n\n```\n\n[20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L20), [28](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L28), [39](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L39), [48](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L48), [57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L57), [66](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L66), [76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L76), [83](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L83), [92](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L92), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L101), [110](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L110), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L119), [129](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensGovernable.sol#L129),\n\n```solidity\nFile: contracts/interfaces/ILensHandles.sol\n\n25:     function mintHandle(address to, string calldata localName) external returns (uint256);\n\n33:     function burn(uint256 tokenId) external;\n\n40:     function getNamespace() external pure returns (string memory);\n\n47:     function getNamespaceHash() external pure returns (bytes32);\n\n57:     function exists(uint256 tokenId) external view returns (bool);\n\n```\n\n[25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHandles.sol#L25), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHandles.sol#L33), [40](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHandles.sol#L40), [47](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHandles.sol#L47), [57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHandles.sol#L57),\n\n```solidity\nFile: contracts/interfaces/ILensHubEventHooks.sol\n\n20:     function emitUnfollowedEvent(uint256 unfollowerProfileId, uint256 idOfProfileUnfollowed) external;\n\n```\n\n[20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHubEventHooks.sol#L20),\n\n```solidity\nFile: contracts/interfaces/ILensHubInitializable.sol\n\n23:     function initialize(\n\n```\n\n[23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHubInitializable.sol#L23),\n\n```solidity\nFile: contracts/interfaces/ILensImplGetters.sol\n\n18:     function getFollowNFTImpl() external view returns (address);\n\n26:     function getCollectNFTImpl() external view returns (address);\n\n```\n\n[18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensImplGetters.sol#L18), [26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensImplGetters.sol#L26),\n\n```solidity\nFile: contracts/interfaces/ILensProfiles.sol\n\n15:     function DANGER__disableTokenGuardian() external;\n\n22:     function enableTokenGuardian() external;\n\n31:     function getTokenGuardianDisablingTimestamp(address wallet) external view returns (uint256);\n\n```\n\n[15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProfiles.sol#L15), [22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProfiles.sol#L22), [31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProfiles.sol#L31),\n\n```solidity\nFile: contracts/interfaces/ILensProtocol.sol\n\n21:     function createProfile(Types.CreateProfileParams calldata createProfileParams) external returns (uint256);\n\n30:     function setProfileMetadataURI(uint256 profileId, string calldata metadataURI) external;\n\n35:     function setProfileMetadataURIWithSig(\n\n49:     function setFollowModule(\n\n58:     function setFollowModuleWithSig(\n\n77:     function changeDelegatedExecutorsConfig(\n\n93:     function changeDelegatedExecutorsConfig(\n\n102:     function changeDelegatedExecutorsConfigWithSig(\n\n118:     function setProfileImageURI(uint256 profileId, string calldata imageURI) external;\n\n123:     function setProfileImageURIWithSig(\n\n141:     function post(Types.PostParams calldata postParams) external returns (uint256);\n\n146:     function postWithSig(Types.PostParams calldata postParams, Types.EIP712Signature calldata signature)\n\n163:     function comment(Types.CommentParams calldata commentParams) external returns (uint256);\n\n168:     function commentWithSig(Types.CommentParams calldata commentParams, Types.EIP712Signature calldata signature)\n\n184:     function mirror(Types.MirrorParams calldata mirrorParams) external returns (uint256);\n\n189:     function mirrorWithSig(Types.MirrorParams calldata mirrorParams, Types.EIP712Signature calldata signature)\n\n207:     function quote(Types.QuoteParams calldata quoteParams) external returns (uint256);\n\n212:     function quoteWithSig(Types.QuoteParams calldata quoteParams, Types.EIP712Signature calldata signature)\n\n230:     function follow(\n\n240:     function followWithSig(\n\n255:     function unfollow(uint256 unfollowerProfileId, uint256[] calldata idsOfProfilesToUnfollow) external;\n\n260:     function unfollowWithSig(\n\n279:     function setBlockStatus(\n\n288:     function setBlockStatusWithSig(\n\n306:     function collect(Types.CollectParams calldata collectParams) external returns (uint256);\n\n312:     function collectWithSig(Types.CollectParams calldata collectParams, Types.EIP712Signature calldata signature)\n\n326:     function act(Types.PublicationActionParams calldata publicationActionParams) external returns (bytes memory);\n\n331:     function actWithSig(\n\n348:     function isFollowing(uint256 followerProfileId, uint256 followedProfileId) external view returns (bool);\n\n361:     function isDelegatedExecutorApproved(\n\n377:     function isDelegatedExecutorApproved(uint256 delegatorProfileId, address delegatedExecutor)\n\n389:     function getDelegatedExecutorsConfigNumber(uint256 delegatorProfileId) external view returns (uint64);\n\n400:     function getDelegatedExecutorsPrevConfigNumber(uint256 delegatorProfileId) external view returns (uint64);\n\n412:     function getDelegatedExecutorsMaxConfigNumberSet(uint256 delegatorProfileId) external view returns (uint64);\n\n423:     function isBlocked(uint256 profileId, uint256 byProfileId) external view returns (bool);\n\n432:     function getActionModuleById(uint256 id) external view returns (address);\n\n443:     function getContentURI(uint256 profileId, uint256 pubId) external view returns (string memory);\n\n452:     function getProfile(uint256 profileId) external view returns (Types.Profile memory);\n\n462:     function getPublication(uint256 profileId, uint256 pubId) external view returns (Types.Publication memory);\n\n478:     function getPublicationType(uint256 profileId, uint256 pubId) external view returns (Types.PublicationType);\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L21), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L30), [35](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L35), [49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L49), [58](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L58), [77](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L77), [93](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L93), [102](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L102), [118](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L118), [123](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L123), [141](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L141), [146](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L146), [163](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L163), [168](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L168), [184](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L184), [189](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L189), [207](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L207), [212](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L212), [230](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L230), [240](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L240), [255](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L255), [260](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L260), [279](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L279), [288](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L288), [306](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L306), [312](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L312), [326](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L326), [331](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L331), [348](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L348), [361](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L361), [377](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L377), [389](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L389), [400](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L400), [412](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L412), [423](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L423), [432](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L432), [443](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L443), [452](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L452), [462](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L462), [478](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L478),\n\n```solidity\nFile: contracts/interfaces/IModuleGlobals.sol\n\n24:     function setGovernance(address newGovernance) external;\n\n32:     function setTreasury(address newTreasury) external;\n\n40:     function setTreasuryFee(uint16 newTreasuryFee) external;\n\n49:     function whitelistCurrency(address currency, bool toWhitelist) external;\n\n62:     function isCurrencyWhitelisted(address currency) external view returns (bool);\n\n69:     function getGovernance() external view returns (address);\n\n76:     function getTreasury() external view returns (address);\n\n83:     function getTreasuryFee() external view returns (uint16);\n\n90:     function getTreasuryData() external view returns (address, uint16);\n\n```\n\n[24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L24), [32](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L32), [40](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L40), [49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L49), [62](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L62), [69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L69), [76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L76), [83](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L83), [90](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L90),\n\n```solidity\nFile: contracts/interfaces/IPublicationActionModule.sol\n\n33:     function initializePublicationAction(\n\n50:     function processPublicationAction(Types.ProcessActionParams calldata processActionParams)\n\n```\n\n[33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IPublicationActionModule.sol#L33), [50](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IPublicationActionModule.sol#L50),\n\n```solidity\nFile: contracts/interfaces/IReferenceModule.sol\n\n30:     function initializeReferenceModule(\n\n47:     function processComment(Types.ProcessCommentParams calldata processCommentParams) external returns (bytes memory);\n\n59:     function processQuote(Types.ProcessQuoteParams calldata processQuoteParams) external returns (bytes memory);\n\n71:     function processMirror(Types.ProcessMirrorParams calldata processMirrorParams) external returns (bytes memory);\n\n```\n\n[30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IReferenceModule.sol#L30), [47](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IReferenceModule.sol#L47), [59](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IReferenceModule.sol#L59), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IReferenceModule.sol#L71),\n\n```solidity\nFile: contracts/interfaces/ITokenHandleRegistry.sol\n\n26:     function migrationLink(uint256 handleId, uint256 tokenId) external;\n\n43:     function link(uint256 handleId, uint256 tokenId) external;\n\n58:     function unlink(uint256 handleId, uint256 tokenId) external;\n\n73:     function resolve(uint256 handleId) external view returns (uint256);\n\n88:     function getDefaultHandle(uint256 tokenId) external view returns (uint256);\n\n```\n\n[26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ITokenHandleRegistry.sol#L26), [43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ITokenHandleRegistry.sol#L43), [58](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ITokenHandleRegistry.sol#L58), [73](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ITokenHandleRegistry.sol#L73), [88](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ITokenHandleRegistry.sol#L88),\n\n</details>\n\n### <a name=\"N-19\"></a>[N-19] Function names should differ to make the code more readable\nIn Solidity, while function overriding allows for functions with the same name to coexist, it is advisable to avoid this practice to enhance code readability and maintainability. Having multiple functions with the same name, even with different parameters or in inherited contracts, can cause confusion and increase the likelihood of errors during development, testing, and debugging. Using distinct and descriptive function names not only clarifies the purpose and behavior of each function, but also helps prevent unintended function calls or incorrect overriding. By adopting a clear and consistent naming convention, developers can create more comprehensible and maintainable smart contracts.\n\n*Instances (8)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/LensHub.sol\n\n/// @audit function name used on lines  149\n165:     function changeDelegatedExecutorsConfig(\n\n/// @audit function name used on lines  498\n507:     function isDelegatedExecutorApproved(uint256 delegatorProfileId, address delegatedExecutor)\n\n```\n\n[165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L165), [507](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L507),\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n/// @audit function name used on lines  156\n164:     function wrap(uint256 followTokenId) external override {\n\n```\n\n[164](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L164),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n/// @audit function name used on lines  203\n214:     function _asReferencePubParams(Types.CommentParams calldata commentParams)\n\n```\n\n[214](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L214),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n/// @audit function name used on lines  234\n245:     function safeTransferFrom(\n\n```\n\n[245](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L245),\n\n```solidity\nFile: contracts/interfaces/IFollowNFT.sol\n\n/// @audit function name used on lines  94\n106:     function wrap(uint256 followTokenId, address wrappedTokenReceiver) external;\n\n```\n\n[106](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L106),\n\n```solidity\nFile: contracts/interfaces/ILensProtocol.sol\n\n/// @audit function name used on lines  77\n93:     function changeDelegatedExecutorsConfig(\n\n/// @audit function name used on lines  361\n377:     function isDelegatedExecutorApproved(uint256 delegatorProfileId, address delegatedExecutor)\n\n```\n\n[93](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L93), [377](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L377),\n\n</details>\n\n### <a name=\"N-20\"></a>[N-20] Some variables have a implicit default visibility\nConsider always adding an explicit visibility modifier for variables, as the default is `internal`.\n\n*Instances (53)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n21:     string constant FOLLOW_NFT_NAME_SUFFIX = '-Follower';\n\n22:     string constant FOLLOW_NFT_SYMBOL_SUFFIX = '-Fl';\n\n24:     uint256[5] ___DEPRECATED_SLOTS; // Deprecated slots, previously used for delegations.\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L21), [22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L22), [24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L24),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n21:     string constant EIP712_DOMAIN_VERSION = '2';\n\n22:     bytes32 constant EIP712_DOMAIN_VERSION_HASH = keccak256(bytes(EIP712_DOMAIN_VERSION));\n\n23:     bytes4 constant EIP1271_MAGIC_VALUE = 0x1626ba7e;\n\n38:     bytes32 constant LENS_HUB_CACHED_POLYGON_DOMAIN_SEPARATOR =\n\n41:     address constant LENS_HUB_ADDRESS = 0xDb46d1Dc155634FbC732f92E853b10B288AD5a1d;\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L21), [22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L22), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L23), [38](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L38), [41](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L41),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n14:     uint16 constant MAX_PROFILE_IMAGE_URI_LENGTH = 6000;\n\n```\n\n[14](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L14),\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n11:     uint256 constant TOKEN_DATA_MAPPING_SLOT = 2;\n\n19:     uint256 constant SIG_NONCES_MAPPING_SLOT = 10;\n\n20:     uint256 constant LAST_INITIALIZED_REVISION_SLOT = 11; // VersionedInitializable's `lastInitializedRevision` field.\n\n21:     uint256 constant PROTOCOL_STATE_SLOT = 12;\n\n22:     uint256 constant PROFILE_CREATOR_WHITELIST_MAPPING_SLOT = 13;\n\n23:     uint256 constant FOLLOW_MODULE_WHITELIST_MAPPING_SLOT = 14;\n\n24:     uint256 constant ACTION_MODULE_WHITELIST_DATA_MAPPING_SLOT = 15;\n\n25:     uint256 constant REFERENCE_MODULE_WHITELIST_MAPPING_SLOT = 16;\n\n27:     uint256 constant PROFILE_ID_BY_HANDLE_HASH_MAPPING_SLOT = 18; // Deprecated slot, but still needed for V2 migration.\n\n28:     uint256 constant PROFILES_MAPPING_SLOT = 19;\n\n29:     uint256 constant PUBLICATIONS_MAPPING_SLOT = 20;\n\n31:     uint256 constant PROFILE_COUNTER_SLOT = 22;\n\n32:     uint256 constant GOVERNANCE_SLOT = 23;\n\n33:     uint256 constant EMERGENCY_ADMIN_SLOT = 24;\n\n37:     uint256 constant TOKEN_GUARDIAN_DISABLING_TIMESTAMP_MAPPING_SLOT = 25;\n\n41:     uint256 constant DELEGATED_EXECUTOR_CONFIG_MAPPING_SLOT = 26;\n\n42:     uint256 constant BLOCKED_STATUS_MAPPING_SLOT = 27;\n\n43:     uint256 constant ACTION_MODULES_SLOT = 28;\n\n44:     uint256 constant MAX_ACTION_MODULE_ID_USED_SLOT = 29;\n\n45:     uint256 constant PROFILE_ROYALTIES_BPS_SLOT = 30;\n\n47:     uint256 constant MAX_ACTION_MODULE_ID_SUPPORTED = 255;\n\n```\n\n[11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L11), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L19), [20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L20), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L21), [22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L22), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L23), [24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L24), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L25), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L27), [28](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L28), [29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L29), [31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L31), [32](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L32), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L33), [37](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L37), [41](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L41), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L42), [43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L43), [44](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L44), [45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L45), [47](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L47),\n\n```solidity\nFile: contracts/libraries/constants/Typehash.sol\n\n7:     bytes32 constant ACT = keccak256('Act(uint256 publicationActedProfileId,uint256 publicationActedId,uint256 actorProfileId,uint256[] referrerProfileIds,uint256[] referrerPubIds,address actionModuleAddress,bytes actionModuleData,uint256 nonce,uint256 deadline)');\n\n9:     bytes32 constant BURN = keccak256('Burn(uint256 tokenId,uint256 nonce,uint256 deadline)');\n\n11:     bytes32 constant CHANGE_DELEGATED_EXECUTORS_CONFIG = keccak256('ChangeDelegatedExecutorsConfig(uint256 delegatorProfileId,address[] delegatedExecutors,bool[] approvals,uint64 configNumber,bool switchToGivenConfig,uint256 nonce,uint256 deadline)');\n\n13:     bytes32 constant LEGACY_COLLECT = keccak256('Collect(uint256 publicationCollectedProfileId,uint256 publicationCollectedId,uint256 collectorProfileId,uint256 referrerProfileId,uint256 referrerPubId,bytes collectModuleData,uint256 nonce,uint256 deadline)');\n\n15:     bytes32 constant COMMENT = keccak256('Comment(uint256 profileId,string contentURI,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileIds,uint256[] referrerPubIds,bytes referenceModuleData,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n17:     bytes32 constant EIP712_DOMAIN = keccak256('EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)');\n\n19:     bytes32 constant FOLLOW = keccak256('Follow(uint256 followerProfileId,uint256[] idsOfProfilesToFollow,uint256[] followTokenIds,bytes[] datas,uint256 nonce,uint256 deadline)');\n\n21:     bytes32 constant MIRROR = keccak256('Mirror(uint256 profileId,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileId,uint256[] referrerPubId,bytes referenceModuleData,uint256 nonce,uint256 deadline)');\n\n23:     bytes32 constant POST = keccak256('Post(uint256 profileId,string contentURI,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n25:     bytes32 constant QUOTE = keccak256('Quote(uint256 profileId,string contentURI,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileIds,uint256[] referrerPubIds,bytes referenceModuleData,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n27:     bytes32 constant SET_BLOCK_STATUS = keccak256('SetBlockStatus(uint256 byProfileId,uint256[] idsOfProfilesToSetBlockStatus,bool[] blockStatus,uint256 nonce,uint256 deadline)');\n\n29:     bytes32 constant SET_FOLLOW_MODULE = keccak256('SetFollowModule(uint256 profileId,address followModule,bytes followModuleInitData,uint256 nonce,uint256 deadline)');\n\n31:     bytes32 constant SET_PROFILE_IMAGE_URI = keccak256('SetProfileImageURI(uint256 profileId,string imageURI,uint256 nonce,uint256 deadline)');\n\n33:     bytes32 constant SET_PROFILE_METADATA_URI = keccak256('SetProfileMetadataURI(uint256 profileId,string metadata,uint256 nonce,uint256 deadline)');\n\n35:     bytes32 constant UNFOLLOW = keccak256('Unfollow(uint256 unfollowerProfileId,uint256[] idsOfProfilesToUnfollow,uint256 nonce,uint256 deadline)');\n\n```\n\n[7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L7), [9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L9), [11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L11), [13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L13), [15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L15), [17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L17), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L19), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L21), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L23), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L25), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L27), [29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L29), [31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L31), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L33), [35](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L35),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n29:     IModuleGlobals immutable MODULE_GLOBALS;\n\n```\n\n[29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L29),\n\n```solidity\nFile: contracts/base/upgradeability/FollowNFTProxy.sol\n\n11:     address immutable HUB;\n\n```\n\n[11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L11),\n\n```solidity\nFile: contracts/misc/ProfileCreationProxy.sol\n\n20:     ILensHandles immutable LENS_HANDLES;\n\n21:     ITokenHandleRegistry immutable TOKEN_HANDLE_REGISTRY;\n\n```\n\n[20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L20), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L21),\n\n```solidity\nFile: contracts/namespaces/TokenHandleRegistry.sol\n\n21:     address immutable LENS_HUB;\n\n22:     address immutable LENS_HANDLES;\n\n25:     mapping(bytes32 handle => RegistryTypes.Token token) handleToToken;\n\n26:     mapping(bytes32 token => RegistryTypes.Handle handle) tokenToHandle;\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L21), [22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L22), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L25), [26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L26),\n\n</details>\n\n### <a name=\"N-21\"></a>[N-21] Imports could be organized more systematically\nThe contract's interface should be imported first, followed by each of the interfaces it uses, followed by all other files. The examples below do not follow this layout.\n\n*Instances (34)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/LensHub.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L1),\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n8: import {HubRestricted} from 'contracts/base/HubRestricted.sol';\n\n```\n\n[8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L8),\n\n```solidity\nFile: contracts/libraries/ActionLib.sol\n\n7: import {ValidationLib} from 'contracts/libraries/ValidationLib.sol';\n\n```\n\n[7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L7),\n\n```solidity\nFile: contracts/libraries/FollowLib.sol\n\n1: // SPDX-License-Identifier: MIT\n\n10: import {StorageLib} from 'contracts/libraries/StorageLib.sol';\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L1), [10](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L10),\n\n```solidity\nFile: contracts/libraries/LegacyCollectLib.sol\n\n8: import {Events} from 'contracts/libraries/constants/Events.sol';\n\n```\n\n[8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L8),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L1),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n10: import {TokenHandleRegistry} from 'contracts/namespaces/TokenHandleRegistry.sol';\n\n```\n\n[10](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L10),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n9: import {StorageLib} from 'contracts/libraries/StorageLib.sol';\n\n```\n\n[9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L9),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n8: import {Errors} from 'contracts/libraries/constants/Errors.sol';\n\n11: import {StorageLib} from 'contracts/libraries/StorageLib.sol';\n\n```\n\n[8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L8), [11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L11),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n5: import {Errors} from 'contracts/libraries/constants/Errors.sol';\n\n```\n\n[5](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L5),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n7: import {MetaTxLib} from 'contracts/libraries/MetaTxLib.sol';\n\n16: import {ERC165} from '@openzeppelin/contracts/utils/introspection/ERC165.sol';\n\n```\n\n[7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L7), [16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L16),\n\n```solidity\nFile: contracts/base/LensGovernable.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L1),\n\n```solidity\nFile: contracts/base/LensHubEventHooks.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubEventHooks.sol#L1),\n\n```solidity\nFile: contracts/base/LensImplGetters.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensImplGetters.sol#L1),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L1),\n\n```solidity\nFile: contracts/base/upgradeability/FollowNFTProxy.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L1),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n6: import {Errors} from 'contracts/libraries/constants/Errors.sol';\n\n```\n\n[6](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L6),\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n6: import {Governance} from 'contracts/misc/access/Governance.sol';\n\n```\n\n[6](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L6),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n6: import {Events} from 'contracts/libraries/constants/Events.sol';\n\n```\n\n[6](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L6),\n\n```solidity\nFile: contracts/misc/ProfileCreationProxy.sol\n\n1: // SPDX-License-Identifier: MIT\n\n6: import {Types} from 'contracts/libraries/constants/Types.sol';\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L1), [6](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L6),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L1),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n5: import {ERC721} from '@openzeppelin/contracts/token/ERC721/ERC721.sol';\n\n10: import {HandleTokenURILib} from 'contracts/libraries/token-uris/HandleTokenURILib.sol';\n\n12: import {Address} from '@openzeppelin/contracts/utils/Address.sol';\n\n```\n\n[5](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L5), [10](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L10), [12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L12),\n\n```solidity\nFile: contracts/namespaces/TokenHandleRegistry.sol\n\n1: // SPDX-License-Identifier: MIT\n\n9: import {RegistryEvents} from 'contracts/namespaces/constants/Events.sol';\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L1), [9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L9),\n\n```solidity\nFile: contracts/interfaces/ILensERC721.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensERC721.sol#L1),\n\n```solidity\nFile: contracts/interfaces/ILensHandles.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHandles.sol#L1),\n\n```solidity\nFile: contracts/interfaces/ILensHub.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHub.sol#L1),\n\n```solidity\nFile: contracts/interfaces/ILensProfiles.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProfiles.sol#L1),\n\n</details>\n\n### <a name=\"N-22\"></a>[N-22] Inconsistent spacing in comments\nSome lines use // x and some use //x. The instances below point out the usages that don't follow the majority, within each file\n\n*Instances (4)*:\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n21:  * @dev Implementation of https://eips.ethereum.org/EIPS/eip-721[ERC721] Non-Fungible Token Standard, including\n\n223:         //solhint-disable-next-line max-line-length\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L21), [223](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L223),\n\n```solidity\nFile: contracts/base/LensGovernable.sol\n\n40:     ///@inheritdoc ILensGovernable\n\n```\n\n[40](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L40),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n89:     //@inheritdoc IModuleGlobals\n\n```\n\n[89](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L89),\n\n### <a name=\"N-23\"></a>[N-23] Large or complicated code bases should implement invariant tests\nLarge code bases, or code with lots of inline-assembly, complicated math, or complicated interactions between multiple contracts, should implement[invariant fuzzing tests](https://medium.com/coinmonks/smart-contract-fuzzing-d9b88e0b0a05). Invariant fuzzers such as Echidna require the test writer to come up with invariants which should not be violated under any circumstances, and the fuzzer tests various inputs and function calls to ensure that the invariants always hold. Even code with 100% code coverage can still have bugs due to the order of the operations a user performs, and invariant fuzzers, with properly and extensively-written invariants, can close this testing gap significantly.\n\n*Instances (10)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: Various Files\n\n0: undefined\n\n0: undefined\n\n0: undefined\n\n0: undefined\n\n0: undefined\n\n0: undefined\n\n0: undefined\n\n0: undefined\n\n0: undefined\n\n0: undefined\n\n```\n\n[0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ICollectModule.sol#L0),\n\n</details>\n\n### <a name=\"N-24\"></a>[N-24] Lines are too long\nUsually lines in source code are limited to [80](https://softwareengineering.stackexchange.com/questions/148677/why-is-80-characters-the-standard-limit-for-code-width)characters. Today's screens are much larger so it's reasonable to stretch this in some cases. The solidity style guide recommends a maximumum line length of [120 characters](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#maximum-line-length), so the lines below should be split when they reach that length.\n\n*Instances (28)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/libraries/GovernanceLib.sol\n\n51:         // NOTE: This does not follow the CEI-pattern, but there is no interaction and this allows to abstract `_setState` logic.\n\n```\n\n[51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L51),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n33:      * We would still perform the migration in batches by ourselves, but good to allow users to migrate on their own if they want to.\n\n```\n\n[33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L33),\n\n```solidity\nFile: contracts/libraries/constants/Typehash.sol\n\n7:     bytes32 constant ACT = keccak256('Act(uint256 publicationActedProfileId,uint256 publicationActedId,uint256 actorProfileId,uint256[] referrerProfileIds,uint256[] referrerPubIds,address actionModuleAddress,bytes actionModuleData,uint256 nonce,uint256 deadline)');\n\n11:     bytes32 constant CHANGE_DELEGATED_EXECUTORS_CONFIG = keccak256('ChangeDelegatedExecutorsConfig(uint256 delegatorProfileId,address[] delegatedExecutors,bool[] approvals,uint64 configNumber,bool switchToGivenConfig,uint256 nonce,uint256 deadline)');\n\n13:     bytes32 constant LEGACY_COLLECT = keccak256('Collect(uint256 publicationCollectedProfileId,uint256 publicationCollectedId,uint256 collectorProfileId,uint256 referrerProfileId,uint256 referrerPubId,bytes collectModuleData,uint256 nonce,uint256 deadline)');\n\n15:     bytes32 constant COMMENT = keccak256('Comment(uint256 profileId,string contentURI,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileIds,uint256[] referrerPubIds,bytes referenceModuleData,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n17:     bytes32 constant EIP712_DOMAIN = keccak256('EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)');\n\n19:     bytes32 constant FOLLOW = keccak256('Follow(uint256 followerProfileId,uint256[] idsOfProfilesToFollow,uint256[] followTokenIds,bytes[] datas,uint256 nonce,uint256 deadline)');\n\n21:     bytes32 constant MIRROR = keccak256('Mirror(uint256 profileId,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileId,uint256[] referrerPubId,bytes referenceModuleData,uint256 nonce,uint256 deadline)');\n\n23:     bytes32 constant POST = keccak256('Post(uint256 profileId,string contentURI,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n25:     bytes32 constant QUOTE = keccak256('Quote(uint256 profileId,string contentURI,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileIds,uint256[] referrerPubIds,bytes referenceModuleData,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n27:     bytes32 constant SET_BLOCK_STATUS = keccak256('SetBlockStatus(uint256 byProfileId,uint256[] idsOfProfilesToSetBlockStatus,bool[] blockStatus,uint256 nonce,uint256 deadline)');\n\n29:     bytes32 constant SET_FOLLOW_MODULE = keccak256('SetFollowModule(uint256 profileId,address followModule,bytes followModuleInitData,uint256 nonce,uint256 deadline)');\n\n31:     bytes32 constant SET_PROFILE_IMAGE_URI = keccak256('SetProfileImageURI(uint256 profileId,string imageURI,uint256 nonce,uint256 deadline)');\n\n33:     bytes32 constant SET_PROFILE_METADATA_URI = keccak256('SetProfileMetadataURI(uint256 profileId,string metadata,uint256 nonce,uint256 deadline)');\n\n35:     bytes32 constant UNFOLLOW = keccak256('Unfollow(uint256 unfollowerProfileId,uint256[] idsOfProfilesToUnfollow,uint256 nonce,uint256 deadline)');\n\n```\n\n[7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L7), [11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L11), [13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L13), [15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L15), [17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L17), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L19), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L21), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L23), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L25), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L27), [29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L29), [31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L31), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L33), [35](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L35),\n\n```solidity\nFile: contracts/libraries/constants/Types.sol\n\n150:         uint256 enabledActionModulesBitmap; // In future this can be (uint256 => uint256) mapping if we need >256 modules\n\n194:      * @param referrerProfileId The profile token ID of the publication that referred to the publication being commented on/quoted.\n\n223:      * @param referrerProfileId The profile token ID of the publication that referred to the publication being commented on/quoted.\n\n252:      * @param referrerProfileId The profile token ID of the publication that referred to the publication being commented on/quoted.\n\n```\n\n[150](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L150), [194](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L194), [223](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L223), [252](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L252),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n298:      * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.\n\n```\n\n[298](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L298),\n\n```solidity\nFile: contracts/base/LensHubStorage.sol\n\n28:     mapping(address actionModule => Types.ActionModuleWhitelistData whitelistData) internal _actionModuleWhitelistData; // Slot 15\n\n38:     mapping(uint256 profileId => mapping(uint256 pubId => Types.Publication publication)) internal _publications; // Slot 20\n\n42:     uint256 internal _profileCounter; // Slot 22 - different from totalSupply, as this is not decreased when burning profiles\n\n59:     mapping(uint256 blockerProfileId => mapping(uint256 blockedProfileId => bool isBlocked)) internal _blockedStatus; // Slot 27\n\n```\n\n[28](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L28), [38](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L38), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L42), [59](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L59),\n\n```solidity\nFile: contracts/interfaces/ICollectNFT.sol\n\n14:      * @notice Initializes the collect NFT, setting the feed as the privileged minter, storing the collected publication pointer\n\n```\n\n[14](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ICollectNFT.sol#L14),\n\n```solidity\nFile: contracts/interfaces/IFollowNFT.sol\n\n181:      * @return uint256 The ID of the profile set as a follower in the given token, zero if it is not being used to follow.\n\n```\n\n[181](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L181),\n\n```solidity\nFile: contracts/interfaces/ILegacyCollectModule.sol\n\n32:      * @param referrerProfileId The LensHub profile token ID of the referrer's profile (only different in case of mirrors).\n\n```\n\n[32](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyCollectModule.sol#L32),\n\n</details>\n\n### <a name=\"N-25\"></a>[N-25] Long functions should be refactored into multiple functions\nConsider splitting long functions into multiple, smaller functions to improve the code readability.\n\n*Instances (4)*:\n\n```solidity\nFile: contracts/libraries/LegacyCollectLib.sol\n\n/// @audit number of line: 68\n45:     function collect(\n\n```\n\n[45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L45),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n/// @audit number of line: 51\n313:     function _processCommentIfNeeded(\n\n/// @audit number of line: 51\n366:     function _processQuoteIfNeeded(\n\n/// @audit number of line: 51\n419:     function _processMirrorIfNeeded(\n\n```\n\n[313](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L313), [366](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L366), [419](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L419),\n\n### <a name=\"N-26\"></a>[N-26] NatSpec documentation for contract is missing\nIt is recommended that Solidity contracts are fully annotated using NatSpec for all public interfaces (everything in the ABI). It is clearly stated in the Solidity official documentation. In complex projects such as Defi, the interpretation of all functions and their arguments and returns is important for code readability and auditability.[source](https://docs.soliditylang.org/en/v0.8.15/natspec-format.html)\n\n*Instances (32)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n18: contract FollowNFT is HubRestricted, LensBaseERC721, ERC2981CollectionRoyalties, IFollowNFT {\n\n```\n\n[18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L18),\n\n```solidity\nFile: contracts/libraries/ActionLib.sol\n\n12: library ActionLib {\n\n```\n\n[12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L12),\n\n```solidity\nFile: contracts/libraries/FollowLib.sol\n\n14: library FollowLib {\n\n```\n\n[14](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L14),\n\n```solidity\nFile: contracts/libraries/GovernanceLib.sol\n\n10: library GovernanceLib {\n\n```\n\n[10](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L10),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n13: interface ILegacyFeeFollowModule {\n\n23: library MigrationLib {\n\n```\n\n[13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L13), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L23),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n13: library ProfileLib {\n\n```\n\n[13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L13),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n14: library PublicationLib {\n\n```\n\n[14](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L14),\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n8: library StorageLib {\n\n```\n\n[8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L8),\n\n```solidity\nFile: contracts/libraries/constants/Errors.sol\n\n5: library Errors {\n\n```\n\n[5](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L5),\n\n```solidity\nFile: contracts/libraries/constants/Events.sol\n\n7: library Events {\n\n```\n\n[7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L7),\n\n```solidity\nFile: contracts/libraries/constants/Typehash.sol\n\n5: library Typehash {\n\n```\n\n[5](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L5),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n9: abstract contract ERC2981CollectionRoyalties is IERC2981 {\n\n```\n\n[9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L9),\n\n```solidity\nFile: contracts/base/LensGovernable.sol\n\n11: abstract contract LensGovernable is ILensGovernable {\n\n```\n\n[11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L11),\n\n```solidity\nFile: contracts/base/LensHubEventHooks.sol\n\n10: abstract contract LensHubEventHooks is ILensHubEventHooks {\n\n```\n\n[10](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubEventHooks.sol#L10),\n\n```solidity\nFile: contracts/base/LensImplGetters.sol\n\n7: contract LensImplGetters is ILensImplGetters {\n\n```\n\n[7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensImplGetters.sol#L7),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n26: abstract contract LensProfiles is LensBaseERC721, ERC2981CollectionRoyalties, ILensProfiles {\n\n```\n\n[26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L26),\n\n```solidity\nFile: contracts/base/upgradeability/FollowNFTProxy.sol\n\n9: contract FollowNFTProxy is Proxy {\n\n```\n\n[9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L9),\n\n```solidity\nFile: contracts/misc/ImmutableOwnable.sol\n\n5: contract ImmutableOwnable {\n\n```\n\n[5](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L5),\n\n```solidity\nFile: contracts/misc/LensV2Migration.sol\n\n11: contract LensV2Migration {\n\n```\n\n[11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L11),\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n9: contract LensV2UpgradeContract is ImmutableOwnable {\n\n```\n\n[9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L9),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n7: contract ControllableByContract is Ownable {\n\n```\n\n[7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L7),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n8: interface ILensHub_V1 {\n\n12: contract Governance is ControllableByContract {\n\n```\n\n[8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L8), [12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L12),\n\n```solidity\nFile: contracts/misc/access/ProxyAdmin.sol\n\n8: contract ProxyAdmin is ControllableByContract {\n\n```\n\n[8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L8),\n\n```solidity\nFile: contracts/namespaces/constants/Errors.sol\n\n5: library RegistryErrors {\n\n14: library HandlesErrors {\n\n```\n\n[5](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L5), [14](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L14),\n\n```solidity\nFile: contracts/namespaces/constants/Events.sol\n\n7: library HandlesEvents {\n\n27: library RegistryEvents {\n\n```\n\n[7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Events.sol#L7), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Events.sol#L27),\n\n```solidity\nFile: contracts/interfaces/ILensERC721.sol\n\n11: interface ILensERC721 is IERC721, IERC721Timestamped, IERC721Burnable, IERC721MetaTx, IERC721Metadata {}\n\n```\n\n[11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensERC721.sol#L11),\n\n```solidity\nFile: contracts/interfaces/ILensHub.sol\n\n11: interface ILensHub is ILensProfiles, ILensProtocol, ILensGovernable, ILensHubEventHooks, ILensImplGetters {}\n\n```\n\n[11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHub.sol#L11),\n\n```solidity\nFile: contracts/interfaces/ILensProfiles.sol\n\n7: interface ILensProfiles is ILensERC721 {\n\n```\n\n[7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProfiles.sol#L7),\n\n</details>\n\n### <a name=\"N-27\"></a>[N-27] NatSpec documentation for function is missing\nIt is recommended that Solidity contracts are fully annotated using NatSpec for all public interfaces (everything in the ABI). It is clearly stated in the Solidity official documentation. In complex projects such as Defi, the interpretation of all functions and their arguments and returns is important for code readability and auditability.[source](https://docs.soliditylang.org/en/v0.8.15/natspec-format.html)\n\n*Instances (207)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/LensHub.sol\n\n66:     constructor(\n\n165:     function changeDelegatedExecutorsConfig(\n\n566:     function getActionModuleById(uint256 id) external view override returns (address) {\n\n```\n\n[66](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L66), [165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L165), [566](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L566),\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n43:     constructor(address hub) HubRestricted(hub) {\n\n168:     function _wrap(uint256 followTokenId, address wrappedTokenReceiver) internal {\n\n255:     function burn(uint256 followTokenId) public override {\n\n274:     function name() public view override returns (string memory) {\n\n278:     function symbol() public view override returns (string memory) {\n\n297:     function _followMintingNewToken(uint256 followerProfileId) internal returns (uint256) {\n\n311:     function _followWithWrappedToken(\n\n341:     function _followWithUnwrappedTokenFromBurnedProfile(\n\n357:     function _followByRecoveringToken(uint256 followerProfileId, uint256 followTokenId) internal returns (uint256) {\n\n368:     function _replaceFollower(\n\n386:     function _baseFollow(\n\n408:     function _unfollowIfHasFollower(uint256 followTokenId) internal {\n\n416:     function _unfollow(uint256 unfollower, uint256 followTokenId) internal {\n\n428:     function _approveFollow(uint256 approvedProfileId, uint256 followTokenId) internal {\n\n449:     function _getReceiver(\n\n455:     function _beforeRoyaltiesSet(\n\n463:     function _isFollowTokenWrapped(uint256 followTokenId) internal view returns (bool) {\n\n467:     function _getRoyaltiesInBasisPointsSlot() internal pure override returns (uint256) {\n\n```\n\n[43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L43), [168](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L168), [255](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L255), [274](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L274), [278](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L278), [297](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L297), [311](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L311), [341](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L341), [357](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L357), [368](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L368), [386](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L386), [408](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L408), [416](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L416), [428](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L428), [449](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L449), [455](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L455), [463](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L463), [467](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L467),\n\n```solidity\nFile: contracts/libraries/ActionLib.sol\n\n13:     function act(\n\n65:     function _isActionEnabled(Types.Publication storage _publication, uint256 actionModuleId)\n\n```\n\n[13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L13), [65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L65),\n\n```solidity\nFile: contracts/libraries/FollowLib.sol\n\n15:     function follow(\n\n54:     function unfollow(\n\n98:     function _follow(\n\n```\n\n[15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L15), [54](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L54), [98](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L98),\n\n```solidity\nFile: contracts/libraries/GovernanceLib.sol\n\n64:     function _setState(Types.ProtocolState newState) private returns (Types.ProtocolState) {\n\n71:     function whitelistProfileCreator(address profileCreator, bool whitelist) external {\n\n76:     function whitelistFollowModule(address followModule, bool whitelist) external {\n\n81:     function whitelistReferenceModule(address referenceModule, bool whitelist) external {\n\n86:     function whitelistActionModule(address actionModule, bool whitelist) external {\n\n```\n\n[64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L64), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L71), [76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L76), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L81), [86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L86),\n\n```solidity\nFile: contracts/libraries/LegacyCollectLib.sol\n\n45:     function collect(\n\n115:     function _getOrDeployCollectNFT(\n\n```\n\n[45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L45), [115](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L115),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n43:     function validateSetProfileMetadataURISignature(\n\n64:     function validateSetFollowModuleSignature(\n\n87:     function validateChangeDelegatedExecutorsConfigSignature(\n\n116:     function validateSetProfileImageURISignature(\n\n137:     function validatePostSignature(Types.EIP712Signature calldata signature, Types.PostParams calldata postParams)\n\n160:     function _hashActionModulesInitDatas(bytes[] memory actionModulesInitDatas) private pure returns (bytes32) {\n\n190:     function _abiEncode(ReferenceParamsForAbiEncode memory referenceParamsForAbiEncode)\n\n225:     function validateCommentSignature(\n\n256:     function validateQuoteSignature(Types.EIP712Signature calldata signature, Types.QuoteParams calldata quoteParams)\n\n286:     function validateMirrorSignature(Types.EIP712Signature calldata signature, Types.MirrorParams calldata mirrorParams)\n\n309:     function validateBurnSignature(Types.EIP712Signature calldata signature, uint256 tokenId) external {\n\n320:     function validateFollowSignature(\n\n357:     function validateUnfollowSignature(\n\n378:     function validateSetBlockStatusSignature(\n\n401:     function validateLegacyCollectSignature(\n\n425:     function validateActSignature(\n\n450:     function calculateDomainSeparator() internal view returns (bytes32) {\n\n```\n\n[43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L43), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L64), [87](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L87), [116](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L116), [137](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L137), [160](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L160), [190](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L190), [225](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L225), [256](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L256), [286](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L286), [309](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L309), [320](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L320), [357](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L357), [378](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L378), [401](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L401), [425](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L425), [450](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L450),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n20:     function getProfileData(uint256 profileId) external view returns (ProfileData memory);\n\n94:     function batchMigrateFollows(\n\n114:     function _migrateFollow(\n\n141:     function batchMigrateFollowModules(\n\n```\n\n[20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L20), [94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L94), [114](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L114), [141](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L141),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n16:     function ownerOf(uint256 profileId) internal view returns (address) {\n\n24:     function exists(uint256 profileId) internal view returns (bool) {\n\n105:     function setProfileMetadataURI(uint256 profileId, string calldata metadataURI) external {\n\n110:     function _initFollowModule(\n\n120:     function _setProfileImageURI(uint256 profileId, string calldata imageURI) private {\n\n128:     function setBlockStatus(\n\n166:     function switchToNewFreshDelegatedExecutorsConfig(uint256 profileId) external {\n\n180:     function changeDelegatedExecutorsConfig(\n\n198:     function changeGivenDelegatedExecutorsConfig(\n\n215:     function isExecutorApproved(uint256 delegatorProfileId, address delegatedExecutor) external view returns (bool) {\n\n222:     function _changeDelegatedExecutorsConfig(\n\n255:     function _prepareStorageToApplyChangesUnderGivenConfig(\n\n```\n\n[16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L16), [24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L24), [105](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L105), [110](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L110), [120](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L120), [128](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L128), [166](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L166), [180](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L180), [198](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L198), [215](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L215), [222](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L222), [255](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L255),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n170:     function getPublicationType(uint256 profileId, uint256 pubId) internal view returns (Types.PublicationType) {\n\n190:     function getContentURI(uint256 profileId, uint256 pubId) external view returns (string memory) {\n\n203:     function _asReferencePubParams(Types.QuoteParams calldata quoteParams)\n\n214:     function _asReferencePubParams(Types.CommentParams calldata commentParams)\n\n225:     function _createReferencePublication(\n\n272:     function _fillReferencePublicationStorage(\n\n291:     function _fillRootOfPublicationInStorage(\n\n313:     function _processCommentIfNeeded(\n\n366:     function _processQuoteIfNeeded(\n\n419:     function _processMirrorIfNeeded(\n\n472:     function _initPubActionModules(\n\n521:     function _initPubReferenceModule(\n\n```\n\n[170](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L170), [190](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L190), [203](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L203), [214](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L214), [225](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L225), [272](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L272), [291](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L291), [313](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L313), [366](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L366), [419](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L419), [472](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L472), [521](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L521),\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n49:     function getPublication(uint256 profileId, uint256 pubId)\n\n63:     function getProfile(uint256 profileId) internal pure returns (Types.Profile storage _profiles) {\n\n71:     function getDelegatedExecutorsConfig(uint256 delegatorProfileId)\n\n83:     function tokenGuardianDisablingTimestamp()\n\n93:     function getTokenData(uint256 tokenId) internal pure returns (Types.TokenData storage _tokenData) {\n\n101:     function blockedStatus(uint256 blockerProfileId)\n\n113:     function nonces() internal pure returns (mapping(address => uint256) storage _nonces) {\n\n119:     function profileIdByHandleHash()\n\n129:     function profileCreatorWhitelisted()\n\n139:     function followModuleWhitelisted()\n\n149:     function actionModuleWhitelistData()\n\n159:     function actionModuleById() internal pure returns (mapping(uint256 => address) storage _actionModules) {\n\n165:     function incrementMaxActionModuleIdUsed() internal returns (uint256) {\n\n177:     function referenceModuleWhitelisted()\n\n187:     function getGovernance() internal view returns (address _governance) {\n\n193:     function setGovernance(address newGovernance) internal {\n\n199:     function getEmergencyAdmin() internal view returns (address _emergencyAdmin) {\n\n205:     function setEmergencyAdmin(address newEmergencyAdmin) internal {\n\n211:     function getState() internal view returns (Types.ProtocolState _state) {\n\n217:     function setState(Types.ProtocolState newState) internal {\n\n223:     function getLastInitializedRevision() internal view returns (uint256 _lastInitializedRevision) {\n\n229:     function setLastInitializedRevision(uint256 newLastInitializedRevision) internal {\n\n```\n\n[49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L49), [63](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L63), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L71), [83](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L83), [93](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L93), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L101), [113](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L113), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L119), [129](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L129), [139](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L139), [149](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L149), [159](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L159), [165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L165), [177](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L177), [187](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L187), [193](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L193), [199](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L199), [205](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L205), [211](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L211), [217](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L217), [223](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L223), [229](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L229),\n\n```solidity\nFile: contracts/libraries/ValidationLib.sol\n\n16:     function validatePointedPub(uint256 profileId, uint256 pubId) internal view {\n\n24:     function validateAddressIsProfileOwner(address expectedProfileOwner, uint256 profileId) internal view {\n\n30:     function validateAddressIsProfileOwnerOrDelegatedExecutor(\n\n42:     function validateAddressIsDelegatedExecutor(address expectedDelegatedExecutor, uint256 delegatorProfileId)\n\n51:     function validateReferenceModuleWhitelisted(address referenceModule) internal view {\n\n57:     function validateFollowModuleWhitelisted(address followModule) internal view {\n\n63:     function validateProfileCreatorWhitelisted(address profileCreator) internal view {\n\n69:     function validateNotBlocked(uint256 profile, uint256 byProfile) internal view {\n\n75:     function validateProfileExists(uint256 profileId) internal view {\n\n81:     function validateCallerIsGovernance() internal view {\n\n87:     function validateReferrersAndGetReferrersPubTypes(\n\n121:     function validateLegacyCollectReferrer(\n\n143:     function _validateReferrerAndGetReferrerPubType(\n\n181:     function _validateReferrerAsPost(\n\n```\n\n[16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L16), [24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L24), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L30), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L42), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L51), [57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L57), [63](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L63), [69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L69), [75](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L75), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L81), [87](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L87), [121](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L121), [143](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L143), [181](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L181),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n43:     function _setRoyalty(uint256 royaltiesInBasisPoints) internal virtual {\n\n51:     function _getRoyaltyAmount(\n\n58:     function _storeRoyaltiesInBasisPoints(uint256 royaltiesInBasisPoints) internal virtual {\n\n65:     function _loadRoyaltiesInBasisPoints() internal view virtual returns (uint256) {\n\n74:     function _beforeRoyaltiesSet(uint256 royaltiesInBasisPoints) internal view virtual;\n\n76:     function _getRoyaltiesInBasisPointsSlot() internal view virtual returns (uint256);\n\n78:     function _getReceiver(uint256 tokenId) internal view virtual returns (address);\n\n```\n\n[43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L43), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L51), [58](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L58), [65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L65), [74](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L74), [76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L76), [78](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L78),\n\n```solidity\nFile: contracts/base/HubRestricted.sol\n\n24:     constructor(address hub) {\n\n```\n\n[24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/HubRestricted.sol#L24),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n94:     function nonces(address signer) public view override returns (uint256) {\n\n166:     function totalSupply() external view virtual override returns (uint256) {\n\n```\n\n[94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L94), [166](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L166),\n\n```solidity\nFile: contracts/base/LensImplGetters.sol\n\n11:     constructor(address followNFTImpl, address collectNFTImpl) {\n\n```\n\n[11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensImplGetters.sol#L11),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n33:     constructor(address moduleGlobals, uint256 tokenGuardianCooldown) {\n\n112:     function approve(address to, uint256 tokenId) public override(LensBaseERC721, IERC721) {\n\n120:     function setApprovalForAll(address operator, bool approved) public override(LensBaseERC721, IERC721) {\n\n142:     function _hasTokenGuardianEnabled(address wallet) internal view returns (bool) {\n\n149:     function _getRoyaltiesInBasisPointsSlot() internal pure override returns (uint256) {\n\n153:     function _getReceiver(\n\n159:     function _beforeRoyaltiesSet(\n\n165:     function _beforeTokenTransfer(\n\n```\n\n[33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L33), [112](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L112), [120](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L120), [142](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L142), [149](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L149), [153](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L153), [159](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L159), [165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L165),\n\n```solidity\nFile: contracts/base/upgradeability/FollowNFTProxy.sol\n\n13:     constructor(bytes memory data) {\n\n18:     function _implementation() internal view override returns (address) {\n\n```\n\n[13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L13), [18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L18),\n\n```solidity\nFile: contracts/misc/ImmutableOwnable.sol\n\n26:     constructor(address owner, address lensHub) {\n\n```\n\n[26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L26),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n38:     constructor(address hub) {\n\n69:     function tokenURI(uint256 tokenId) public view override returns (string memory) {\n\n102:     function _getReceiver(\n\n108:     function _beforeRoyaltiesSet(\n\n116:     function _getRoyaltiesInBasisPointsSlot() internal pure override returns (uint256) {\n\n```\n\n[38](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L38), [69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L69), [102](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L102), [108](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L108), [116](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L116),\n\n```solidity\nFile: contracts/misc/LensV2Migration.sol\n\n19:     constructor(\n\n33:     function batchMigrateProfiles(uint256[] calldata profileIds) external {\n\n37:     function batchMigrateFollows(\n\n45:     function batchMigrateFollowModules(uint256[] calldata profileIds) external {\n\n```\n\n[19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L19), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L33), [37](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L37), [45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L45),\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n20:     constructor(\n\n44:     function executeLensV2Upgrade() external onlyOwner {\n\n50:     function _upgrade() internal {\n\n64:     function _unwhitelistOldFollowModules() internal {\n\n75:     function _unwhitelistOldReferenceModules() internal {\n\n86:     function _unwhitelistOldCollectModules() internal {\n\n97:     function _whitelistNewFollowModules() internal {\n\n108:     function _whitelistNewReferenceModules() internal {\n\n119:     function _whitelistNewActionModules() internal {\n\n```\n\n[20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L20), [44](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L44), [50](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L50), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L64), [75](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L75), [86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L86), [97](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L97), [108](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L108), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L119),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n90:     function getTreasuryData() external view override returns (address, uint16) {\n\n94:     function _setGovernance(address newGovernance) internal {\n\n101:     function _setTreasury(address newTreasury) internal {\n\n108:     function _setTreasuryFee(uint16 newTreasuryFee) internal {\n\n115:     function _whitelistCurrency(address currency, bool toWhitelist) internal {\n\n```\n\n[90](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L90), [94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L94), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L101), [108](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L108), [115](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L115),\n\n```solidity\nFile: contracts/misc/ProfileCreationProxy.sol\n\n23:     constructor(\n\n33:     function proxyCreateProfile(Types.CreateProfileParams calldata createProfileParams)\n\n41:     function proxyCreateProfileWithHandle(Types.CreateProfileParams memory createProfileParams, string calldata handle)\n\n64:     function proxyCreateHandle(address to, string calldata handle) external onlyOwner returns (uint256) {\n\n```\n\n[23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L23), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L33), [41](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L41), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L64),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n21:     constructor(address owner) Ownable() {\n\n25:     function clearControllerContract() external onlyOwnerOrControllerContract {\n\n30:     function setControllerContract(address newControllerContract) external onlyOwner {\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L21), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L25), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L30),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n9:     function whitelistCollectModule(address collectModule, bool whitelist) external;\n\n15:     constructor(address lensHubAddress_, address governanceOwner_) ControllableByContract(governanceOwner_) {\n\n27:     function lensHub_setEmergencyAdmin(address newEmergencyAdmin) external onlyOwner {\n\n42:     function lensHub_whitelistFollowModule(address followModule, bool whitelist)\n\n49:     function lensHub_whitelistReferenceModule(address referenceModule, bool whitelist)\n\n56:     function lensHub_whitelistActionModule(address actionModule, bool whitelist)\n\n64:     function lensHub_whitelistCollectModule(address collectModule, bool whitelist)\n\n73:     function executeAsGovernance(address target, bytes calldata data)\n\n```\n\n[9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L9), [15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L15), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L27), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L42), [49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L49), [56](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L56), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L64), [73](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L73),\n\n```solidity\nFile: contracts/misc/access/ProxyAdmin.sol\n\n12:     constructor(\n\n21:     function currentImplementation() external returns (address) {\n\n33:     function proxy_changeAdmin(address newAdmin) external onlyOwner {\n\n47:     function proxy_upgradeAndCall(address newImplementation, bytes calldata data)\n\n```\n\n[12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L12), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L21), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L33), [47](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L47),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n62:     constructor(\n\n70:     function name() public pure override returns (string memory) {\n\n74:     function symbol() public pure override returns (string memory) {\n\n96:     function migrateHandle(address to, string calldata localName) external onlyHub returns (uint256) {\n\n101:     function burn(uint256 tokenId) external {\n\n126:     function enableTokenGuardian() external onlyEOA {\n\n139:     function approve(address to, uint256 tokenId) public override(IERC721, ERC721) {\n\n147:     function setApprovalForAll(address operator, bool approved) public override(IERC721, ERC721) {\n\n155:     function exists(uint256 tokenId) external view returns (bool) {\n\n159:     function getNamespace() external pure returns (string memory) {\n\n163:     function getNamespaceHash() external pure returns (bytes32) {\n\n168:     function getLocalName(uint256 tokenId) public view returns (string memory) {\n\n177:     function getHandle(uint256 tokenId) public view returns (string memory) {\n\n182:     function getTokenId(string memory localName) public pure returns (uint256) {\n\n186:     function getTokenGuardianDisablingTimestamp(address wallet) external view returns (uint256) {\n\n202:     function _validateLocalNameMigration(string memory localName) internal view {\n\n226:     function _validateLocalName(string memory localName) internal view {\n\n249:     function _isAlphaNumeric(bytes1 char) internal pure returns (bool) {\n\n253:     function _hasTokenGuardianEnabled(address wallet) internal view returns (bool) {\n\n260:     function _beforeTokenTransfer(\n\n```\n\n[62](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L62), [70](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L70), [74](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L74), [96](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L96), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L101), [126](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L126), [139](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L139), [147](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L147), [155](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L155), [159](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L159), [163](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L163), [168](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L168), [177](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L177), [182](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L182), [186](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L186), [202](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L202), [226](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L226), [249](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L249), [253](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L253), [260](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L260),\n\n```solidity\nFile: contracts/namespaces/TokenHandleRegistry.sol\n\n42:     constructor(address lensHub, address lensHandles) {\n\n50:     function migrationLink(uint256 handleId, uint256 tokenId) external {\n\n128:     function _resolveTokenToHandle(\n\n134:     function _link(RegistryTypes.Handle memory handle, RegistryTypes.Token memory token) internal {\n\n144:     function _deleteTokenToHandleLinkageIfAny(RegistryTypes.Handle memory handle) internal {\n\n152:     function _deleteHandleToTokenLinkageIfAny(RegistryTypes.Token memory token) internal {\n\n160:     function _unlink(RegistryTypes.Handle memory handle, RegistryTypes.Token memory token) internal {\n\n167:     function _handleHash(RegistryTypes.Handle memory handle) internal pure returns (bytes32) {\n\n171:     function _tokenHash(RegistryTypes.Token memory token) internal pure returns (bytes32) {\n\n```\n\n[42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L42), [50](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L50), [128](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L128), [134](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L134), [144](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L144), [152](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L152), [160](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L160), [167](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L167), [171](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L171),\n\n</details>\n\n### <a name=\"N-28\"></a>[N-28] Use `@inheritdoc` rather than using a non-standard annotation\nIt is recommended that Solidity contracts are fully annotated using NatSpec for all public interfaces (everything in the ABI). It is clearly stated in the Solidity official documentation. In complex projects such as Defi, the interpretation of all functions and their arguments and returns is important for code readability and auditability.[source](https://docs.soliditylang.org/en/v0.8.15/natspec-format.html)\n\n*Instances (54)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/LensHub.sol\n\n165:     function changeDelegatedExecutorsConfig(\n166:             uint256 delegatorProfileId,\n167:             address[] calldata delegatedExecutors,\n168:             bool[] calldata approvals\n169:         ) external override whenNotPaused onlyProfileOwner(msg.sender, delegatorProfileId) {\n\n566:     function getActionModuleById(uint256 id) external view override returns (address) {\n\n```\n\n[165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L165), [566](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L566),\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n255:     function burn(uint256 followTokenId) public override {\n\n260:     /**\n261:          * @dev See {IERC165-supportsInterface}.\n262:          */\n263:         function supportsInterface(bytes4 interfaceId)\n264:             public\n265:             view\n266:             virtual\n267:             override(LensBaseERC721, ERC2981CollectionRoyalties)\n268:             returns (bool)\n269:         {\n\n274:     function name() public view override returns (string memory) {\n\n278:     function symbol() public view override returns (string memory) {\n\n282:     /**\n283:          * @dev This returns the follow NFT URI fetched from the hub.\n284:          */\n285:         function tokenURI(uint256 followTokenId) public view override returns (string memory) {\n\n433:     /**\n434:          * @dev Upon transfers, we clear follow approvals and emit the transfer event in the hub.\n435:          */\n436:         function _beforeTokenTransfer(\n437:             address from,\n438:             address to,\n439:             uint256 followTokenId\n440:         ) internal override {\n\n449:     function _getReceiver(\n450:             uint256 /* followTokenId */\n451:         ) internal view override returns (address) {\n\n455:     function _beforeRoyaltiesSet(\n456:             uint256 /* royaltiesInBasisPoints */\n457:         ) internal view override {\n\n467:     function _getRoyaltiesInBasisPointsSlot() internal pure override returns (uint256) {\n\n```\n\n[255](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L255), [260](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L260), [274](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L274), [278](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L278), [282](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L282), [433](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L433), [449](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L449), [455](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L455), [467](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L467),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n81:     /**\n82:         * @dev See {IERC165-supportsInterface}.\n83:         */\n84:        function supportsInterface(bytes4 interfaceId) public view virtual override(ERC165, IERC165) returns (bool) {\n\n94:     function nonces(address signer) public view override returns (uint256) {\n\n103:     /**\n104:          * @dev See {IERC721-balanceOf}.\n105:          */\n106:         function balanceOf(address owner) public view virtual override returns (uint256) {\n\n113:     /**\n114:          * @dev See {IERC721-ownerOf}.\n115:          */\n116:         function ownerOf(uint256 tokenId) public view virtual override returns (address) {\n\n124:     /**\n125:          * @dev See {IERC721Timestamped-mintTimestampOf}\n126:          */\n127:         function mintTimestampOf(uint256 tokenId) public view virtual override returns (uint256) {\n\n135:     /**\n136:          * @dev See {IERC721Timestamped-tokenDataOf}\n137:          */\n138:         function tokenDataOf(uint256 tokenId) public view virtual override returns (Types.TokenData memory) {\n\n145:     /**\n146:          * @dev See {IERC721Timestamped-exists}\n147:          */\n148:         function exists(uint256 tokenId) public view virtual override returns (bool) {\n\n152:     /**\n153:          * @dev See {IERC721Metadata-name}.\n154:          */\n155:         function name() public view virtual override returns (string memory) {\n\n159:     /**\n160:          * @dev See {IERC721Metadata-symbol}.\n161:          */\n162:         function symbol() public view virtual override returns (string memory) {\n\n166:     function totalSupply() external view virtual override returns (uint256) {\n\n170:     /**\n171:          * @dev See {IERC721-approve}.\n172:          */\n173:         function approve(address to, uint256 tokenId) public virtual override {\n\n186:     /**\n187:          * @dev See {IERC721-getApproved}.\n188:          */\n189:         function getApproved(uint256 tokenId) public view virtual override returns (address) {\n\n197:     /**\n198:          * @dev See {IERC721-setApprovalForAll}.\n199:          */\n200:         function setApprovalForAll(address operator, bool approved) public virtual override {\n\n208:     /**\n209:          * @dev See {IERC721-isApprovedForAll}.\n210:          */\n211:         function isApprovedForAll(address owner, address operator) public view virtual override returns (bool) {\n\n215:     /**\n216:          * @dev See {IERC721-transferFrom}.\n217:          */\n218:         function transferFrom(\n219:             address from,\n220:             address to,\n221:             uint256 tokenId\n222:         ) public virtual override {\n\n231:     /**\n232:          * @dev See {IERC721-safeTransferFrom}.\n233:          */\n234:         function safeTransferFrom(\n235:             address from,\n236:             address to,\n237:             uint256 tokenId\n238:         ) public virtual override {\n\n242:     /**\n243:          * @dev See {IERC721-safeTransferFrom}.\n244:          */\n245:         function safeTransferFrom(\n246:             address from,\n247:             address to,\n248:             uint256 tokenId,\n249:             bytes memory _data\n250:         ) public virtual override {\n\n257:     /**\n258:          * @dev Burns `tokenId`.\n259:          *\n260:          * Requirements:\n261:          *\n262:          * - The caller must own `tokenId` or be an approved operator.\n263:          */\n264:         function burn(uint256 tokenId) public virtual override {\n\n```\n\n[81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L81), [94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L94), [103](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L103), [113](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L113), [124](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L124), [135](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L135), [145](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L145), [152](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L152), [159](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L159), [166](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L166), [170](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L170), [186](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L186), [197](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L197), [208](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L208), [215](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L215), [231](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L231), [242](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L242), [257](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L257),\n\n```solidity\nFile: contracts/base/LensGovernable.sol\n\n69:     /**\n70:         * @notice Returns the current protocol state.\n71:         *\n72:         * @return ProtocolState The Protocol state, an enum, where:\n73:         *      0: Unpaused\n74:         *      1: PublishingPaused\n75:         *      2: Paused\n76:         */\n77:        function getState() external view override returns (Types.ProtocolState) {\n\n```\n\n[69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L69),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n90:     /**\n91:         * @notice Burns a profile, this maintains the profile data struct.\n92:         */\n93:        function burn(uint256 tokenId)\n94:            public\n95:            override(LensBaseERC721, IERC721Burnable)\n96:            whenNotPaused\n97:            onlyProfileOwner(msg.sender, tokenId)\n98:        {\n\n102:     /**\n103:          * @dev Overrides the ERC721 tokenURI function to return the associated URI with a given profile.\n104:          */\n105:         function tokenURI(uint256 tokenId) public view override(LensBaseERC721, IERC721Metadata) returns (string memory) {\n\n112:     function approve(address to, uint256 tokenId) public override(LensBaseERC721, IERC721) {\n\n120:     function setApprovalForAll(address operator, bool approved) public override(LensBaseERC721, IERC721) {\n\n128:     /**\n129:          * @dev See {IERC165-supportsInterface}.\n130:          */\n131:         function supportsInterface(bytes4 interfaceId)\n132:             public\n133:             view\n134:             virtual\n135:             override(LensBaseERC721, ERC2981CollectionRoyalties, IERC165)\n136:             returns (bool)\n137:         {\n\n149:     function _getRoyaltiesInBasisPointsSlot() internal pure override returns (uint256) {\n\n153:     function _getReceiver(\n154:             uint256 /* tokenId */\n155:         ) internal view override returns (address) {\n\n159:     function _beforeRoyaltiesSet(\n160:             uint256 /* royaltiesInBasisPoints */\n161:         ) internal view override {\n\n165:     function _beforeTokenTransfer(\n166:             address from,\n167:             address to,\n168:             uint256 tokenId\n169:         ) internal override whenNotPaused {\n\n```\n\n[90](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L90), [102](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L102), [112](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L112), [120](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L120), [128](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L128), [149](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L149), [153](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L153), [159](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L159), [165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L165),\n\n```solidity\nFile: contracts/base/upgradeability/FollowNFTProxy.sol\n\n18:     function _implementation() internal view override returns (address) {\n\n```\n\n[18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L18),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n69:     function tokenURI(uint256 tokenId) public view override returns (string memory) {\n\n74:     /**\n75:         * @dev See {IERC721Metadata-name}.\n76:         */\n77:        function name() public view override returns (string memory) {\n\n81:     /**\n82:         * @dev See {IERC721Metadata-symbol}.\n83:         */\n84:        function symbol() public pure override returns (string memory) {\n\n88:     /**\n89:         * @dev See {IERC165-supportsInterface}.\n90:         */\n91:        function supportsInterface(bytes4 interfaceId)\n92:            public\n93:            view\n94:            virtual\n95:            override(ERC2981CollectionRoyalties, LensBaseERC721)\n96:            returns (bool)\n97:        {\n\n102:     function _getReceiver(\n103:             uint256 /* tokenId */\n104:         ) internal view override returns (address) {\n\n108:     function _beforeRoyaltiesSet(\n109:             uint256 /* royaltiesInBasisPoints */\n110:         ) internal view override {\n\n116:     function _getRoyaltiesInBasisPointsSlot() internal pure override returns (uint256) {\n\n```\n\n[69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L69), [74](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L74), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L81), [88](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L88), [102](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L102), [108](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L108), [116](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L116),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n90:     function getTreasuryData() external view override returns (address, uint16) {\n\n```\n\n[90](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L90),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n70:     function name() public pure override returns (string memory) {\n\n74:     function symbol() public pure override returns (string memory) {\n\n78:     /**\n79:         * @dev See {IERC721Metadata-tokenURI}.\n80:         */\n81:        function tokenURI(uint256 tokenId) public view override returns (string memory) {\n\n139:     function approve(address to, uint256 tokenId) public override(IERC721, ERC721) {\n\n147:     function setApprovalForAll(address operator, bool approved) public override(IERC721, ERC721) {\n\n260:     function _beforeTokenTransfer(\n261:             address from,\n262:             address to,\n263:             uint256 /* firstTokenId */,\n264:             uint256 batchSize\n265:         ) internal override {\n\n```\n\n[70](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L70), [74](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L74), [78](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L78), [139](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L139), [147](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L147), [260](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L260),\n\n</details>\n\n### <a name=\"N-29\"></a>[N-29] NatSpec `@param` is missing\nIt is recommended that Solidity contracts are fully annotated using NatSpec for all public interfaces (everything in the ABI). It is clearly stated in the Solidity official documentation. In complex projects such as Defi, the interpretation of all functions and their arguments and returns is important for code readability and auditability.[source](https://docs.soliditylang.org/en/v0.8.15/natspec-format.html)\n\n*Instances (348)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/LensHub.sol\n\n66:     constructor(\n67:            address moduleGlobals,\n68:            address followNFTImpl,\n69:            address collectNFTImpl, // We still pass the deprecated CollectNFTImpl for legacy Collects to work\n70:            address lensHandlesAddress,\n71:            address tokenHandleRegistryAddress,\n72:            address legacyFeeFollowModule,\n73:            address legacyProfileFollowModule,\n74:            address newFeeFollowModule,\n75:            uint256 tokenGuardianCooldown\n76:        )\n77:            LensProfiles(moduleGlobals, tokenGuardianCooldown)\n78:            LensV2Migration(\n79:                legacyFeeFollowModule,\n80:                legacyProfileFollowModule,\n81:                newFeeFollowModule,\n82:                lensHandlesAddress,\n83:                tokenHandleRegistryAddress\n84:            )\n85:            LensImplGetters(followNFTImpl, collectNFTImpl)\n86:        {}\n\n88:     /// @inheritdoc ILensProtocol\n89:        function createProfile(Types.CreateProfileParams calldata createProfileParams)\n90:            external\n91:            override\n92:            whenNotPaused\n93:            returns (uint256)\n94:        {\n\n108:     /// @inheritdoc ILensProtocol\n109:         function setProfileMetadataURI(uint256 profileId, string calldata metadataURI)\n110:             external\n111:             override\n112:             whenNotPaused\n113:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, profileId)\n114:         {\n\n118:     /// @inheritdoc ILensProtocol\n119:         function setProfileMetadataURIWithSig(\n120:             uint256 profileId,\n121:             string calldata metadataURI,\n122:             Types.EIP712Signature calldata signature\n123:         ) external override whenNotPaused onlyProfileOwnerOrDelegatedExecutor(signature.signer, profileId) {\n\n128:     /// @inheritdoc ILensProtocol\n129:         function setFollowModule(\n130:             uint256 profileId,\n131:             address followModule,\n132:             bytes calldata followModuleInitData\n133:         ) external override whenNotPaused onlyProfileOwnerOrDelegatedExecutor(msg.sender, profileId) {\n\n137:     /// @inheritdoc ILensProtocol\n138:         function setFollowModuleWithSig(\n139:             uint256 profileId,\n140:             address followModule,\n141:             bytes calldata followModuleInitData,\n142:             Types.EIP712Signature calldata signature\n143:         ) external override whenNotPaused onlyProfileOwnerOrDelegatedExecutor(signature.signer, profileId) {\n\n148:     /// @inheritdoc ILensProtocol\n149:         function changeDelegatedExecutorsConfig(\n150:             uint256 delegatorProfileId,\n151:             address[] calldata delegatedExecutors,\n152:             bool[] calldata approvals,\n153:             uint64 configNumber,\n154:             bool switchToGivenConfig\n155:         ) external override whenNotPaused onlyProfileOwner(msg.sender, delegatorProfileId) {\n\n165:     function changeDelegatedExecutorsConfig(\n166:             uint256 delegatorProfileId,\n167:             address[] calldata delegatedExecutors,\n168:             bool[] calldata approvals\n169:         ) external override whenNotPaused onlyProfileOwner(msg.sender, delegatorProfileId) {\n\n173:     /// @inheritdoc ILensProtocol\n174:         function changeDelegatedExecutorsConfigWithSig(\n175:             uint256 delegatorProfileId,\n176:             address[] calldata delegatedExecutors,\n177:             bool[] calldata approvals,\n178:             uint64 configNumber,\n179:             bool switchToGivenConfig,\n180:             Types.EIP712Signature calldata signature\n181:         ) external override whenNotPaused onlyProfileOwner(signature.signer, delegatorProfileId) {\n\n199:     /// @inheritdoc ILensProtocol\n200:         function setProfileImageURI(uint256 profileId, string calldata imageURI)\n201:             external\n202:             override\n203:             whenNotPaused\n204:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, profileId)\n205:         {\n\n209:     /// @inheritdoc ILensProtocol\n210:         function setProfileImageURIWithSig(\n211:             uint256 profileId,\n212:             string calldata imageURI,\n213:             Types.EIP712Signature calldata signature\n214:         ) external override whenNotPaused onlyProfileOwnerOrDelegatedExecutor(signature.signer, profileId) {\n\n223:     /// @inheritdoc ILensProtocol\n224:         function post(Types.PostParams calldata postParams)\n225:             external\n226:             override\n227:             whenPublishingEnabled\n228:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, postParams.profileId)\n229:             returns (uint256)\n230:         {\n\n234:     /// @inheritdoc ILensProtocol\n235:         function postWithSig(Types.PostParams calldata postParams, Types.EIP712Signature calldata signature)\n236:             external\n237:             override\n238:             whenPublishingEnabled\n239:             onlyProfileOwnerOrDelegatedExecutor(signature.signer, postParams.profileId)\n240:             returns (uint256)\n241:         {\n\n246:     /// @inheritdoc ILensProtocol\n247:         function comment(Types.CommentParams calldata commentParams)\n248:             external\n249:             override\n250:             whenPublishingEnabled\n251:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, commentParams.profileId)\n252:             returns (uint256)\n253:         {\n\n257:     /// @inheritdoc ILensProtocol\n258:         function commentWithSig(Types.CommentParams calldata commentParams, Types.EIP712Signature calldata signature)\n259:             external\n260:             override\n261:             whenPublishingEnabled\n262:             onlyProfileOwnerOrDelegatedExecutor(signature.signer, commentParams.profileId)\n263:             returns (uint256)\n264:         {\n\n269:     /// @inheritdoc ILensProtocol\n270:         function mirror(Types.MirrorParams calldata mirrorParams)\n271:             external\n272:             override\n273:             whenPublishingEnabled\n274:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, mirrorParams.profileId)\n275:             returns (uint256)\n276:         {\n\n280:     /// @inheritdoc ILensProtocol\n281:         function mirrorWithSig(Types.MirrorParams calldata mirrorParams, Types.EIP712Signature calldata signature)\n282:             external\n283:             override\n284:             whenPublishingEnabled\n285:             onlyProfileOwnerOrDelegatedExecutor(signature.signer, mirrorParams.profileId)\n286:             returns (uint256)\n287:         {\n\n292:     /// @inheritdoc ILensProtocol\n293:         function quote(Types.QuoteParams calldata quoteParams)\n294:             external\n295:             override\n296:             whenPublishingEnabled\n297:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, quoteParams.profileId)\n298:             returns (uint256)\n299:         {\n\n303:     /// @inheritdoc ILensProtocol\n304:         function quoteWithSig(Types.QuoteParams calldata quoteParams, Types.EIP712Signature calldata signature)\n305:             external\n306:             override\n307:             whenPublishingEnabled\n308:             onlyProfileOwnerOrDelegatedExecutor(signature.signer, quoteParams.profileId)\n309:             returns (uint256)\n310:         {\n\n319:     /// @inheritdoc ILensProtocol\n320:         function follow(\n321:             uint256 followerProfileId,\n322:             uint256[] calldata idsOfProfilesToFollow,\n323:             uint256[] calldata followTokenIds,\n324:             bytes[] calldata datas\n325:         )\n326:             external\n327:             override\n328:             whenNotPaused\n329:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, followerProfileId)\n330:             returns (uint256[] memory)\n331:         {\n\n342:     /// @inheritdoc ILensProtocol\n343:         function followWithSig(\n344:             uint256 followerProfileId,\n345:             uint256[] calldata idsOfProfilesToFollow,\n346:             uint256[] calldata followTokenIds,\n347:             bytes[] calldata datas,\n348:             Types.EIP712Signature calldata signature\n349:         )\n350:             external\n351:             override\n352:             whenNotPaused\n353:             onlyProfileOwnerOrDelegatedExecutor(signature.signer, followerProfileId)\n354:             returns (uint256[] memory)\n355:         {\n\n367:     /// @inheritdoc ILensProtocol\n368:         function unfollow(uint256 unfollowerProfileId, uint256[] calldata idsOfProfilesToUnfollow)\n369:             external\n370:             override\n371:             whenNotPaused\n372:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, unfollowerProfileId)\n373:         {\n\n381:     /// @inheritdoc ILensProtocol\n382:         function unfollowWithSig(\n383:             uint256 unfollowerProfileId,\n384:             uint256[] calldata idsOfProfilesToUnfollow,\n385:             Types.EIP712Signature calldata signature\n386:         ) external override whenNotPaused onlyProfileOwnerOrDelegatedExecutor(signature.signer, unfollowerProfileId) {\n\n396:     /// @inheritdoc ILensProtocol\n397:         function setBlockStatus(\n398:             uint256 byProfileId,\n399:             uint256[] calldata idsOfProfilesToSetBlockStatus,\n400:             bool[] calldata blockStatus\n401:         ) external override whenNotPaused onlyProfileOwnerOrDelegatedExecutor(msg.sender, byProfileId) {\n\n405:     /// @inheritdoc ILensProtocol\n406:         function setBlockStatusWithSig(\n407:             uint256 byProfileId,\n408:             uint256[] calldata idsOfProfilesToSetBlockStatus,\n409:             bool[] calldata blockStatus,\n410:             Types.EIP712Signature calldata signature\n411:         ) external override whenNotPaused onlyProfileOwnerOrDelegatedExecutor(signature.signer, byProfileId) {\n\n416:     /// @inheritdoc ILensProtocol\n417:         function collect(Types.CollectParams calldata collectParams)\n418:             external\n419:             override\n420:             whenNotPaused\n421:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, collectParams.collectorProfileId)\n422:             returns (uint256)\n423:         {\n\n433:     /// @inheritdoc ILensProtocol\n434:         function collectWithSig(Types.CollectParams calldata collectParams, Types.EIP712Signature calldata signature)\n435:             external\n436:             override\n437:             whenNotPaused\n438:             onlyProfileOwnerOrDelegatedExecutor(signature.signer, collectParams.collectorProfileId)\n439:             returns (uint256)\n440:         {\n\n451:     /// @inheritdoc ILensProtocol\n452:         function act(Types.PublicationActionParams calldata publicationActionParams)\n453:             external\n454:             override\n455:             whenNotPaused\n456:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, publicationActionParams.actorProfileId)\n457:             returns (bytes memory)\n458:         {\n\n467:     /// @inheritdoc ILensProtocol\n468:         function actWithSig(\n469:             Types.PublicationActionParams calldata publicationActionParams,\n470:             Types.EIP712Signature calldata signature\n471:         )\n472:             external\n473:             override\n474:             whenNotPaused\n475:             onlyProfileOwnerOrDelegatedExecutor(signature.signer, publicationActionParams.actorProfileId)\n476:             returns (bytes memory)\n477:         {\n\n491:     /// @inheritdoc ILensProtocol\n492:         function isFollowing(uint256 followerProfileId, uint256 followedProfileId) external view returns (bool) {\n\n497:     /// @inheritdoc ILensProtocol\n498:         function isDelegatedExecutorApproved(\n499:             uint256 delegatorProfileId,\n500:             address delegatedExecutor,\n501:             uint64 configNumber\n502:         ) external view returns (bool) {\n\n506:     /// @inheritdoc ILensProtocol\n507:         function isDelegatedExecutorApproved(uint256 delegatorProfileId, address delegatedExecutor)\n508:             external\n509:             view\n510:             returns (bool)\n511:         {\n\n515:     /// @inheritdoc ILensProtocol\n516:         function getDelegatedExecutorsConfigNumber(uint256 delegatorProfileId) external view returns (uint64) {\n\n520:     /// @inheritdoc ILensProtocol\n521:         function getDelegatedExecutorsPrevConfigNumber(uint256 delegatorProfileId) external view returns (uint64) {\n\n525:     /// @inheritdoc ILensProtocol\n526:         function getDelegatedExecutorsMaxConfigNumberSet(uint256 delegatorProfileId) external view returns (uint64) {\n\n530:     /// @inheritdoc ILensProtocol\n531:         function isBlocked(uint256 profileId, uint256 byProfileId) external view returns (bool) {\n\n535:     /// @inheritdoc ILensProtocol\n536:         function getContentURI(uint256 profileId, uint256 pubId) external view override returns (string memory) {\n\n541:     /// @inheritdoc ILensProtocol\n542:         function getProfile(uint256 profileId) external view override returns (Types.Profile memory) {\n\n546:     /// @inheritdoc ILensProtocol\n547:         function getPublication(uint256 profileId, uint256 pubId)\n548:             external\n549:             view\n550:             override\n551:             returns (Types.Publication memory)\n552:         {\n\n556:     /// @inheritdoc ILensProtocol\n557:         function getPublicationType(uint256 profileId, uint256 pubId)\n558:             external\n559:             view\n560:             override\n561:             returns (Types.PublicationType)\n562:         {\n\n566:     function getActionModuleById(uint256 id) external view override returns (address) {\n\n```\n\n[66](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L66), [88](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L88), [108](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L108), [118](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L118), [128](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L128), [137](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L137), [148](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L148), [165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L165), [173](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L173), [199](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L199), [209](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L209), [223](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L223), [234](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L234), [246](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L246), [257](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L257), [269](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L269), [280](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L280), [292](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L292), [303](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L303), [319](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L319), [342](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L342), [367](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L367), [381](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L381), [396](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L396), [405](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L405), [416](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L416), [433](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L433), [451](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L451), [467](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L467), [491](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L491), [497](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L497), [506](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L506), [515](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L515), [520](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L520), [525](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L525), [530](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L530), [535](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L535), [541](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L541), [546](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L546), [556](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L556), [566](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L566),\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n43:     constructor(address hub) HubRestricted(hub) {\n\n47:     /// @inheritdoc IFollowNFT\n48:        function initialize(uint256 profileId) external override {\n\n58:     /// @inheritdoc IFollowNFT\n59:        function follow(\n60:            uint256 followerProfileId,\n61:            address transactionExecutor,\n62:            uint256 followTokenId\n63:        ) external override onlyHub returns (uint256) {\n\n102:     /// @inheritdoc IFollowNFT\n103:         function unfollow(uint256 unfollowerProfileId, address transactionExecutor) external override onlyHub {\n\n130:     /// @inheritdoc IFollowNFT\n131:         function removeFollower(uint256 followTokenId) external override {\n\n140:     /// @inheritdoc IFollowNFT\n141:         function approveFollow(uint256 followerProfileId, uint256 followTokenId) external override {\n\n155:     /// @inheritdoc IFollowNFT\n156:         function wrap(uint256 followTokenId, address wrappedTokenReceiver) external override {\n\n163:     /// @inheritdoc IFollowNFT\n164:         function wrap(uint256 followTokenId) external override {\n\n168:     function _wrap(uint256 followTokenId, address wrappedTokenReceiver) internal {\n\n187:     /// @inheritdoc IFollowNFT\n188:         function unwrap(uint256 followTokenId) external override {\n\n195:     /// @inheritdoc IFollowNFT\n196:         function processBlock(uint256 followerProfileId) external override onlyHub returns (bool) {\n\n210:     /// @inheritdoc IFollowNFT\n211:         function getFollowerProfileId(uint256 followTokenId) external view override returns (uint256) {\n\n215:     /// @inheritdoc IFollowNFT\n216:         function isFollowing(uint256 followerProfileId) external view override returns (bool) {\n\n220:     /// @inheritdoc IFollowNFT\n221:         function getFollowTokenId(uint256 followerProfileId) external view override returns (uint256) {\n\n225:     /// @inheritdoc IFollowNFT\n226:         function getOriginalFollowTimestamp(uint256 followTokenId) external view override returns (uint256) {\n\n230:     /// @inheritdoc IFollowNFT\n231:         function getFollowTimestamp(uint256 followTokenId) external view override returns (uint256) {\n\n235:     /// @inheritdoc IFollowNFT\n236:         function getProfileIdAllowedToRecover(uint256 followTokenId) external view override returns (uint256) {\n\n240:     /// @inheritdoc IFollowNFT\n241:         function getFollowData(uint256 followTokenId) external view override returns (Types.FollowData memory) {\n\n245:     /// @inheritdoc IFollowNFT\n246:         function getFollowApproved(uint256 followTokenId) external view override returns (uint256) {\n\n255:     function burn(uint256 followTokenId) public override {\n\n260:     /**\n261:          * @dev See {IERC165-supportsInterface}.\n262:          */\n263:         function supportsInterface(bytes4 interfaceId)\n264:             public\n265:             view\n266:             virtual\n267:             override(LensBaseERC721, ERC2981CollectionRoyalties)\n268:             returns (bool)\n269:         {\n\n274:     function name() public view override returns (string memory) {\n\n278:     function symbol() public view override returns (string memory) {\n\n282:     /**\n283:          * @dev This returns the follow NFT URI fetched from the hub.\n284:          */\n285:         function tokenURI(uint256 followTokenId) public view override returns (string memory) {\n\n297:     function _followMintingNewToken(uint256 followerProfileId) internal returns (uint256) {\n\n311:     function _followWithWrappedToken(\n312:             uint256 followerProfileId,\n313:             address transactionExecutor,\n314:             uint256 followTokenId,\n315:             address followTokenOwner\n316:         ) internal returns (uint256) {\n\n341:     function _followWithUnwrappedTokenFromBurnedProfile(\n342:             uint256 followerProfileId,\n343:             uint256 followTokenId,\n344:             uint256 currentFollowerProfileId\n345:         ) internal returns (uint256) {\n\n357:     function _followByRecoveringToken(uint256 followerProfileId, uint256 followTokenId) internal returns (uint256) {\n\n368:     function _replaceFollower(\n369:             uint256 currentFollowerProfileId,\n370:             uint256 newFollowerProfileId,\n371:             uint256 followTokenId\n372:         ) internal {\n\n386:     function _baseFollow(\n387:             uint256 followerProfileId,\n388:             uint256 followTokenId,\n389:             bool isOriginalFollow\n390:         ) internal {\n\n408:     function _unfollowIfHasFollower(uint256 followTokenId) internal {\n\n416:     function _unfollow(uint256 unfollower, uint256 followTokenId) internal {\n\n428:     function _approveFollow(uint256 approvedProfileId, uint256 followTokenId) internal {\n\n433:     /**\n434:          * @dev Upon transfers, we clear follow approvals and emit the transfer event in the hub.\n435:          */\n436:         function _beforeTokenTransfer(\n437:             address from,\n438:             address to,\n439:             uint256 followTokenId\n440:         ) internal override {\n\n449:     function _getReceiver(\n450:             uint256 /* followTokenId */\n451:         ) internal view override returns (address) {\n\n455:     function _beforeRoyaltiesSet(\n456:             uint256 /* royaltiesInBasisPoints */\n457:         ) internal view override {\n\n463:     function _isFollowTokenWrapped(uint256 followTokenId) internal view returns (bool) {\n\n467:     function _getRoyaltiesInBasisPointsSlot() internal pure override returns (uint256) {\n\n476:     /// Migrations ///\n477:         //////////////////\n478:     \n479:         // This function shouldn't fail under no circumstances, except if wrong parameters are passed.\n480:         function tryMigrate(\n481:             uint256 followerProfileId,\n482:             address followerProfileOwner,\n483:             uint256 idOfProfileFollowed,\n484:             uint256 followTokenId\n485:         ) external onlyHub returns (uint48) {\n\n```\n\n[43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L43), [47](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L47), [58](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L58), [102](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L102), [130](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L130), [140](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L140), [155](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L155), [163](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L163), [168](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L168), [187](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L187), [195](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L195), [210](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L210), [215](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L215), [220](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L220), [225](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L225), [230](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L230), [235](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L235), [240](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L240), [245](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L245), [255](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L255), [260](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L260), [274](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L274), [278](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L278), [282](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L282), [297](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L297), [311](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L311), [341](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L341), [357](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L357), [368](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L368), [386](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L386), [408](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L408), [416](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L416), [428](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L428), [433](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L433), [449](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L449), [455](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L455), [463](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L463), [467](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L467), [476](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L476),\n\n```solidity\nFile: contracts/libraries/ActionLib.sol\n\n13:     function act(\n14:            Types.PublicationActionParams calldata publicationActionParams,\n15:            address transactionExecutor,\n16:            address actorProfileOwner\n17:        ) external returns (bytes memory) {\n\n65:     function _isActionEnabled(Types.Publication storage _publication, uint256 actionModuleId)\n66:            private\n67:            view\n68:            returns (bool)\n69:        {\n\n```\n\n[13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L13), [65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L65),\n\n```solidity\nFile: contracts/libraries/FollowLib.sol\n\n15:     function follow(\n16:            uint256 followerProfileId,\n17:            address transactionExecutor,\n18:            uint256[] calldata idsOfProfilesToFollow,\n19:            uint256[] calldata followTokenIds,\n20:            bytes[] calldata followModuleDatas\n21:        ) external returns (uint256[] memory) {\n\n54:     function unfollow(\n55:            uint256 unfollowerProfileId,\n56:            address transactionExecutor,\n57:            uint256[] calldata idsOfProfilesToUnfollow\n58:        ) external {\n\n98:     function _follow(\n99:            uint256 followerProfileId,\n100:            address transactionExecutor,\n101:            uint256 idOfProfileToFollow,\n102:            uint256 followTokenId,\n103:            bytes calldata followModuleData\n104:        ) private returns (uint256) {\n\n```\n\n[15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L15), [54](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L54), [98](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L98),\n\n```solidity\nFile: contracts/libraries/GovernanceLib.sol\n\n64:     function _setState(Types.ProtocolState newState) private returns (Types.ProtocolState) {\n\n71:     function whitelistProfileCreator(address profileCreator, bool whitelist) external {\n\n76:     function whitelistFollowModule(address followModule, bool whitelist) external {\n\n81:     function whitelistReferenceModule(address referenceModule, bool whitelist) external {\n\n86:     function whitelistActionModule(address actionModule, bool whitelist) external {\n\n```\n\n[64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L64), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L71), [76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L76), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L81), [86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L86),\n\n```solidity\nFile: contracts/libraries/LegacyCollectLib.sol\n\n45:     function collect(\n46:            Types.CollectParams calldata collectParams,\n47:            address transactionExecutor,\n48:            address collectorProfileOwner,\n49:            address collectNFTImpl\n50:        ) external returns (uint256) {\n\n115:     function _getOrDeployCollectNFT(\n116:             Types.Publication storage _collectedPublication,\n117:             uint256 publicationCollectedProfileId,\n118:             uint256 publicationCollectedId,\n119:             address collectNFTImpl\n120:         ) private returns (address) {\n\n```\n\n[45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L45), [115](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L115),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n43:     function validateSetProfileMetadataURISignature(\n44:            Types.EIP712Signature calldata signature,\n45:            uint256 profileId,\n46:            string calldata metadataURI\n47:        ) external {\n\n64:     function validateSetFollowModuleSignature(\n65:            Types.EIP712Signature calldata signature,\n66:            uint256 profileId,\n67:            address followModule,\n68:            bytes calldata followModuleInitData\n69:        ) external {\n\n87:     function validateChangeDelegatedExecutorsConfigSignature(\n88:            Types.EIP712Signature calldata signature,\n89:            uint256 delegatorProfileId,\n90:            address[] calldata delegatedExecutors,\n91:            bool[] calldata approvals,\n92:            uint64 configNumber,\n93:            bool switchToGivenConfig\n94:        ) external {\n\n116:     function validateSetProfileImageURISignature(\n117:             Types.EIP712Signature calldata signature,\n118:             uint256 profileId,\n119:             string calldata imageURI\n120:         ) external {\n\n137:     function validatePostSignature(Types.EIP712Signature calldata signature, Types.PostParams calldata postParams)\n138:             external\n139:         {\n\n160:     function _hashActionModulesInitDatas(bytes[] memory actionModulesInitDatas) private pure returns (bytes32) {\n\n190:     function _abiEncode(ReferenceParamsForAbiEncode memory referenceParamsForAbiEncode)\n191:             private\n192:             pure\n193:             returns (bytes memory)\n194:         {\n\n225:     function validateCommentSignature(\n226:             Types.EIP712Signature calldata signature,\n227:             Types.CommentParams calldata commentParams\n228:         ) external {\n\n256:     function validateQuoteSignature(Types.EIP712Signature calldata signature, Types.QuoteParams calldata quoteParams)\n257:             external\n258:         {\n\n286:     function validateMirrorSignature(Types.EIP712Signature calldata signature, Types.MirrorParams calldata mirrorParams)\n287:             external\n288:         {\n\n309:     function validateBurnSignature(Types.EIP712Signature calldata signature, uint256 tokenId) external {\n\n320:     function validateFollowSignature(\n321:             Types.EIP712Signature calldata signature,\n322:             uint256 followerProfileId,\n323:             uint256[] calldata idsOfProfilesToFollow,\n324:             uint256[] calldata followTokenIds,\n325:             bytes[] calldata datas\n326:         ) external {\n\n357:     function validateUnfollowSignature(\n358:             Types.EIP712Signature calldata signature,\n359:             uint256 unfollowerProfileId,\n360:             uint256[] calldata idsOfProfilesToUnfollow\n361:         ) external {\n\n378:     function validateSetBlockStatusSignature(\n379:             Types.EIP712Signature calldata signature,\n380:             uint256 byProfileId,\n381:             uint256[] calldata idsOfProfilesToSetBlockStatus,\n382:             bool[] calldata blockStatus\n383:         ) external {\n\n401:     function validateLegacyCollectSignature(\n402:             Types.EIP712Signature calldata signature,\n403:             Types.CollectParams calldata collectParams\n404:         ) external {\n\n425:     function validateActSignature(\n426:             Types.EIP712Signature calldata signature,\n427:             Types.PublicationActionParams calldata publicationActionParams\n428:         ) external {\n\n450:     function calculateDomainSeparator() internal view returns (bytes32) {\n\n466:     /**\n467:          * @dev Wrapper for ecrecover to reduce code size, used in meta-tx specific functions.\n468:          */\n469:         function _validateRecoveredAddress(bytes32 digest, Types.EIP712Signature calldata signature) private view {\n\n```\n\n[43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L43), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L64), [87](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L87), [116](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L116), [137](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L137), [160](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L160), [190](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L190), [225](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L225), [256](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L256), [286](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L286), [309](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L309), [320](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L320), [357](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L357), [378](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L378), [401](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L401), [425](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L425), [450](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L450), [466](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L466),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n20:     function getProfileData(uint256 profileId) external view returns (ProfileData memory);\n\n31:     /**\n32:         * @notice Migrates an array of profiles from V1 to V2. This function can be callable by anyone.\n33:         * We would still perform the migration in batches by ourselves, but good to allow users to migrate on their own if they want to.\n34:         *\n35:         * @param profileIds The array of profile IDs to migrate.\n36:         */\n37:        function batchMigrateProfiles(\n38:            uint256[] calldata profileIds,\n39:            LensHandles lensHandles,\n40:            TokenHandleRegistry tokenHandleRegistry\n41:        ) external {\n\n51:     /**\n52:         * @notice Migrates a profile from V1 to V2.\n53:         *\n54:         * @dev We do not revert in any case, as we want to allow the migration to continue even if one profile fails\n55:         *      (and it usually fails if already migrated or profileNFT moved).\n56:         * @dev Estimated gas cost of one profile migration is around 178k gas.\n57:         *\n58:         * @param profileId The profile ID to migrate.\n59:         */\n60:        function _migrateProfile(\n61:            uint256 profileId,\n62:            LensHandles lensHandles,\n63:            TokenHandleRegistry tokenHandleRegistry\n64:        ) private {\n\n94:     function batchMigrateFollows(\n95:            uint256[] calldata followerProfileIds,\n96:            uint256[] calldata idsOfProfileFollowed,\n97:            uint256[] calldata followTokenIds\n98:        ) external {\n\n114:     function _migrateFollow(\n115:             uint256 followerProfileId,\n116:             uint256 idOfProfileFollowed,\n117:             uint256 followTokenId\n118:         ) private {\n\n141:     function batchMigrateFollowModules(\n142:             uint256[] calldata profileIds,\n143:             address legacyFeeFollowModule,\n144:             address legacyProfileFollowModule,\n145:             address newFeeFollowModule\n146:         ) external {\n\n```\n\n[20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L20), [31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L31), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L51), [94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L94), [114](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L114), [141](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L141),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n16:     function ownerOf(uint256 profileId) internal view returns (address) {\n\n24:     function exists(uint256 profileId) internal view returns (bool) {\n\n105:     function setProfileMetadataURI(uint256 profileId, string calldata metadataURI) external {\n\n110:     function _initFollowModule(\n111:             uint256 profileId,\n112:             address transactionExecutor,\n113:             address followModule,\n114:             bytes memory followModuleInitData\n115:         ) private returns (bytes memory) {\n\n120:     function _setProfileImageURI(uint256 profileId, string calldata imageURI) private {\n\n128:     function setBlockStatus(\n129:             uint256 byProfileId,\n130:             uint256[] calldata idsOfProfilesToSetBlockStatus,\n131:             bool[] calldata blockStatus\n132:         ) external {\n\n166:     function switchToNewFreshDelegatedExecutorsConfig(uint256 profileId) external {\n\n180:     function changeDelegatedExecutorsConfig(\n181:             uint256 delegatorProfileId,\n182:             address[] calldata delegatedExecutors,\n183:             bool[] calldata approvals\n184:         ) external {\n\n198:     function changeGivenDelegatedExecutorsConfig(\n199:             uint256 delegatorProfileId,\n200:             address[] calldata delegatedExecutors,\n201:             bool[] calldata approvals,\n202:             uint64 configNumber,\n203:             bool switchToGivenConfig\n204:         ) external {\n\n215:     function isExecutorApproved(uint256 delegatorProfileId, address delegatedExecutor) external view returns (bool) {\n\n222:     function _changeDelegatedExecutorsConfig(\n223:             Types.DelegatedExecutorsConfig storage _delegatedExecutorsConfig,\n224:             uint256 delegatorProfileId,\n225:             address[] memory delegatedExecutors,\n226:             bool[] memory approvals,\n227:             uint64 configNumber,\n228:             bool switchToGivenConfig\n229:         ) private {\n\n255:     function _prepareStorageToApplyChangesUnderGivenConfig(\n256:             Types.DelegatedExecutorsConfig storage _delegatedExecutorsConfig,\n257:             uint64 configNumber,\n258:             bool switchToGivenConfig\n259:         ) private returns (bool) {\n\n```\n\n[16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L16), [24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L24), [105](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L105), [110](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L110), [120](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L120), [128](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L128), [166](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L166), [180](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L180), [198](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L198), [215](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L215), [222](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L222), [255](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L255),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n15:     /**\n16:         * @notice Publishes a post to a given profile.\n17:         *\n18:         * @param postParams The PostParams struct.\n19:         *\n20:         * @return uint256 The created publication's pubId.\n21:         */\n22:        function post(Types.PostParams calldata postParams, address transactionExecutor) external returns (uint256) {\n\n56:     /**\n57:         * @notice Publishes a comment to a given profile via signature.\n58:         *\n59:         * @param commentParams the CommentParams struct.\n60:         *\n61:         * @return uint256 The created publication's pubId.\n62:         */\n63:        function comment(Types.CommentParams calldata commentParams, address transactionExecutor)\n64:            external\n65:            returns (uint256)\n66:        {\n\n96:     /**\n97:         * @notice Publishes a mirror to a given profile.\n98:         *\n99:         * @param mirrorParams the MirrorParams struct.\n100:         *\n101:         * @return uint256 The created publication's pubId.\n102:         */\n103:        function mirror(Types.MirrorParams calldata mirrorParams, address transactionExecutor) external returns (uint256) {\n\n133:     /**\n134:          * @notice Publishes a quote publication to a given profile via signature.\n135:          *\n136:          * @param quoteParams the QuoteParams struct.\n137:          *\n138:          * @return uint256 The created publication's pubId.\n139:          */\n140:         function quote(Types.QuoteParams calldata quoteParams, address transactionExecutor) external returns (uint256) {\n\n170:     function getPublicationType(uint256 profileId, uint256 pubId) internal view returns (Types.PublicationType) {\n\n190:     function getContentURI(uint256 profileId, uint256 pubId) external view returns (string memory) {\n\n203:     function _asReferencePubParams(Types.QuoteParams calldata quoteParams)\n204:             private\n205:             pure\n206:             returns (Types.ReferencePubParams calldata referencePubParams)\n207:         {\n\n214:     function _asReferencePubParams(Types.CommentParams calldata commentParams)\n215:             private\n216:             pure\n217:             returns (Types.ReferencePubParams calldata referencePubParams)\n218:         {\n\n225:     function _createReferencePublication(\n226:             Types.ReferencePubParams calldata referencePubParams,\n227:             address transactionExecutor,\n228:             Types.PublicationType referencePubType\n229:         )\n230:             private\n231:             returns (\n232:                 uint256,\n233:                 bytes[] memory,\n234:                 bytes memory,\n235:                 Types.PublicationType[] memory\n236:             )\n237:         {\n\n272:     function _fillReferencePublicationStorage(\n273:             Types.ReferencePubParams calldata referencePubParams,\n274:             Types.PublicationType referencePubType\n275:         ) private returns (uint256) {\n\n291:     function _fillRootOfPublicationInStorage(\n292:             Types.Publication storage _publication,\n293:             uint256 pointedProfileId,\n294:             uint256 pointedPubId\n295:         ) internal {\n\n313:     function _processCommentIfNeeded(\n314:             Types.CommentParams calldata commentParams,\n315:             address transactionExecutor,\n316:             Types.PublicationType[] memory referrerPubTypes\n317:         ) private returns (bytes memory) {\n\n366:     function _processQuoteIfNeeded(\n367:             Types.QuoteParams calldata quoteParams,\n368:             address transactionExecutor,\n369:             Types.PublicationType[] memory referrerPubTypes\n370:         ) private returns (bytes memory) {\n\n419:     function _processMirrorIfNeeded(\n420:             Types.MirrorParams calldata mirrorParams,\n421:             address transactionExecutor,\n422:             Types.PublicationType[] memory referrerPubTypes\n423:         ) private returns (bytes memory) {\n\n472:     function _initPubActionModules(\n473:             uint256 profileId,\n474:             address transactionExecutor,\n475:             uint256 pubId,\n476:             address[] calldata actionModules,\n477:             bytes[] calldata actionModulesInitDatas\n478:         ) private returns (bytes[] memory) {\n\n521:     function _initPubReferenceModule(\n522:             uint256 profileId,\n523:             address transactionExecutor,\n524:             uint256 pubId,\n525:             address referenceModule,\n526:             bytes memory referenceModuleInitData\n527:         ) private returns (bytes memory) {\n\n```\n\n[15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L15), [56](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L56), [96](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L96), [133](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L133), [170](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L170), [190](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L190), [203](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L203), [214](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L214), [225](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L225), [272](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L272), [291](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L291), [313](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L313), [366](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L366), [419](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L419), [472](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L472), [521](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L521),\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n49:     function getPublication(uint256 profileId, uint256 pubId)\n50:            internal\n51:            pure\n52:            returns (Types.Publication storage _publication)\n53:        {\n\n63:     function getProfile(uint256 profileId) internal pure returns (Types.Profile storage _profiles) {\n\n71:     function getDelegatedExecutorsConfig(uint256 delegatorProfileId)\n72:            internal\n73:            pure\n74:            returns (Types.DelegatedExecutorsConfig storage _delegatedExecutorsConfig)\n75:        {\n\n83:     function tokenGuardianDisablingTimestamp()\n84:            internal\n85:            pure\n86:            returns (mapping(address => uint256) storage _tokenGuardianDisablingTimestamp)\n87:        {\n\n93:     function getTokenData(uint256 tokenId) internal pure returns (Types.TokenData storage _tokenData) {\n\n101:     function blockedStatus(uint256 blockerProfileId)\n102:             internal\n103:             pure\n104:             returns (mapping(uint256 => bool) storage _blockedStatus)\n105:         {\n\n113:     function nonces() internal pure returns (mapping(address => uint256) storage _nonces) {\n\n119:     function profileIdByHandleHash()\n120:             internal\n121:             pure\n122:             returns (mapping(bytes32 => uint256) storage _profileIdByHandleHash)\n123:         {\n\n129:     function profileCreatorWhitelisted()\n130:             internal\n131:             pure\n132:             returns (mapping(address => bool) storage _profileCreatorWhitelisted)\n133:         {\n\n139:     function followModuleWhitelisted()\n140:             internal\n141:             pure\n142:             returns (mapping(address => bool) storage _followModuleWhitelisted)\n143:         {\n\n149:     function actionModuleWhitelistData()\n150:             internal\n151:             pure\n152:             returns (mapping(address => Types.ActionModuleWhitelistData) storage _actionModuleWhitelistData)\n153:         {\n\n159:     function actionModuleById() internal pure returns (mapping(uint256 => address) storage _actionModules) {\n\n165:     function incrementMaxActionModuleIdUsed() internal returns (uint256) {\n\n177:     function referenceModuleWhitelisted()\n178:             internal\n179:             pure\n180:             returns (mapping(address => bool) storage _referenceModuleWhitelisted)\n181:         {\n\n187:     function getGovernance() internal view returns (address _governance) {\n\n193:     function setGovernance(address newGovernance) internal {\n\n199:     function getEmergencyAdmin() internal view returns (address _emergencyAdmin) {\n\n205:     function setEmergencyAdmin(address newEmergencyAdmin) internal {\n\n211:     function getState() internal view returns (Types.ProtocolState _state) {\n\n217:     function setState(Types.ProtocolState newState) internal {\n\n223:     function getLastInitializedRevision() internal view returns (uint256 _lastInitializedRevision) {\n\n229:     function setLastInitializedRevision(uint256 newLastInitializedRevision) internal {\n\n```\n\n[49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L49), [63](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L63), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L71), [83](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L83), [93](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L93), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L101), [113](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L113), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L119), [129](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L129), [139](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L139), [149](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L149), [159](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L159), [165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L165), [177](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L177), [187](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L187), [193](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L193), [199](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L199), [205](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L205), [211](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L211), [217](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L217), [223](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L223), [229](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L229),\n\n```solidity\nFile: contracts/libraries/ValidationLib.sol\n\n16:     function validatePointedPub(uint256 profileId, uint256 pubId) internal view {\n\n24:     function validateAddressIsProfileOwner(address expectedProfileOwner, uint256 profileId) internal view {\n\n30:     function validateAddressIsProfileOwnerOrDelegatedExecutor(\n31:            address expectedOwnerOrDelegatedExecutor,\n32:            uint256 profileId\n33:        ) internal view {\n\n42:     function validateAddressIsDelegatedExecutor(address expectedDelegatedExecutor, uint256 delegatorProfileId)\n43:            internal\n44:            view\n45:        {\n\n51:     function validateReferenceModuleWhitelisted(address referenceModule) internal view {\n\n57:     function validateFollowModuleWhitelisted(address followModule) internal view {\n\n63:     function validateProfileCreatorWhitelisted(address profileCreator) internal view {\n\n69:     function validateNotBlocked(uint256 profile, uint256 byProfile) internal view {\n\n75:     function validateProfileExists(uint256 profileId) internal view {\n\n81:     function validateCallerIsGovernance() internal view {\n\n87:     function validateReferrersAndGetReferrersPubTypes(\n88:            uint256[] memory referrerProfileIds,\n89:            uint256[] memory referrerPubIds,\n90:            uint256 targetedProfileId,\n91:            uint256 targetedPubId\n92:        ) internal view returns (Types.PublicationType[] memory) {\n\n121:     function validateLegacyCollectReferrer(\n122:             uint256 referrerProfileId,\n123:             uint256 referrerPubId,\n124:             uint256 publicationCollectedProfileId,\n125:             uint256 publicationCollectedId\n126:         ) external view {\n\n143:     function _validateReferrerAndGetReferrerPubType(\n144:             uint256 referrerProfileId,\n145:             uint256 referrerPubId,\n146:             uint256 targetedProfileId,\n147:             uint256 targetedPubId\n148:         ) private view returns (Types.PublicationType) {\n\n181:     function _validateReferrerAsPost(\n182:             uint256 referrerProfileId,\n183:             uint256 referrerPubId,\n184:             uint256 targetedProfileId,\n185:             uint256 targetedPubId\n186:         ) private view {\n\n```\n\n[16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L16), [24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L24), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L30), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L42), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L51), [57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L57), [63](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L63), [69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L69), [75](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L75), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L81), [87](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L87), [121](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L121), [143](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L143), [181](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L181),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n14:     /**\n15:         * @dev See {IERC165-supportsInterface}.\n16:         */\n17:        function supportsInterface(bytes4 interfaceId) public view virtual returns (bool) {\n\n43:     function _setRoyalty(uint256 royaltiesInBasisPoints) internal virtual {\n\n51:     function _getRoyaltyAmount(\n52:            uint256, /* tokenId */\n53:            uint256 salePrice\n54:        ) internal view virtual returns (uint256) {\n\n58:     function _storeRoyaltiesInBasisPoints(uint256 royaltiesInBasisPoints) internal virtual {\n\n65:     function _loadRoyaltiesInBasisPoints() internal view virtual returns (uint256) {\n\n74:     function _beforeRoyaltiesSet(uint256 royaltiesInBasisPoints) internal view virtual;\n\n76:     function _getRoyaltiesInBasisPointsSlot() internal view virtual returns (uint256);\n\n78:     function _getReceiver(uint256 tokenId) internal view virtual returns (address);\n\n```\n\n[14](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L14), [43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L43), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L51), [58](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L58), [65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L65), [74](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L74), [76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L76), [78](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L78),\n\n```solidity\nFile: contracts/base/HubRestricted.sol\n\n24:     constructor(address hub) {\n\n```\n\n[24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/HubRestricted.sol#L24),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n76:     /**\n\n81:     /**\n82:         * @dev See {IERC165-supportsInterface}.\n83:         */\n84:        function supportsInterface(bytes4 interfaceId) public view virtual override(ERC165, IERC165) returns (bool) {\n\n94:     function nonces(address signer) public view override returns (uint256) {\n\n103:     /**\n104:          * @dev See {IERC721-balanceOf}.\n105:          */\n106:         function balanceOf(address owner) public view virtual override returns (uint256) {\n\n113:     /**\n114:          * @dev See {IERC721-ownerOf}.\n115:          */\n116:         function ownerOf(uint256 tokenId) public view virtual override returns (address) {\n\n124:     /**\n125:          * @dev See {IERC721Timestamped-mintTimestampOf}\n126:          */\n127:         function mintTimestampOf(uint256 tokenId) public view virtual override returns (uint256) {\n\n135:     /**\n136:          * @dev See {IERC721Timestamped-tokenDataOf}\n137:          */\n138:         function tokenDataOf(uint256 tokenId) public view virtual override returns (Types.TokenData memory) {\n\n145:     /**\n146:          * @dev See {IERC721Timestamped-exists}\n147:          */\n148:         function exists(uint256 tokenId) public view virtual override returns (bool) {\n\n166:     function totalSupply() external view virtual override returns (uint256) {\n\n170:     /**\n171:          * @dev See {IERC721-approve}.\n172:          */\n173:         function approve(address to, uint256 tokenId) public virtual override {\n\n186:     /**\n187:          * @dev See {IERC721-getApproved}.\n188:          */\n189:         function getApproved(uint256 tokenId) public view virtual override returns (address) {\n\n197:     /**\n198:          * @dev See {IERC721-setApprovalForAll}.\n199:          */\n200:         function setApprovalForAll(address operator, bool approved) public virtual override {\n\n208:     /**\n209:          * @dev See {IERC721-isApprovedForAll}.\n210:          */\n211:         function isApprovedForAll(address owner, address operator) public view virtual override returns (bool) {\n\n215:     /**\n216:          * @dev See {IERC721-transferFrom}.\n217:          */\n218:         function transferFrom(\n219:             address from,\n220:             address to,\n221:             uint256 tokenId\n222:         ) public virtual override {\n\n231:     /**\n232:          * @dev See {IERC721-safeTransferFrom}.\n233:          */\n234:         function safeTransferFrom(\n235:             address from,\n236:             address to,\n237:             uint256 tokenId\n238:         ) public virtual override {\n\n242:     /**\n243:          * @dev See {IERC721-safeTransferFrom}.\n244:          */\n245:         function safeTransferFrom(\n246:             address from,\n247:             address to,\n248:             uint256 tokenId,\n249:             bytes memory _data\n250:         ) public virtual override {\n\n257:     /**\n258:          * @dev Burns `tokenId`.\n259:          *\n260:          * Requirements:\n261:          *\n262:          * - The caller must own `tokenId` or be an approved operator.\n263:          */\n264:         function burn(uint256 tokenId) public virtual override {\n\n284:     /**\n285:          * @dev Safely transfers `tokenId` token from `from` to `to`, checking first that contract recipients\n286:          * are aware of the ERC721 protocol to prevent tokens from being forever locked.\n287:          *\n288:          * `_data` is additional data, it has no specified format and it is sent in call to `to`.\n289:          *\n290:          * This internal function is equivalent to {safeTransferFrom}, and can be used to e.g.\n291:          * implement alternative mechanisms to perform a token transfer, such as signature-based.\n292:          *\n293:          * Requirements:\n294:          *\n295:          * - `from` cannot be the zero address.\n296:          * - `to` cannot be the zero address.\n297:          * - `tokenId` token must exist and be owned by `from`.\n298:          * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.\n299:          *\n300:          * Emits a {Transfer} event.\n301:          */\n302:         function _safeTransfer(\n303:             address from,\n304:             address to,\n305:             uint256 tokenId,\n306:             bytes memory _data\n307:         ) internal virtual {\n\n314:     /**\n315:          * @dev Returns whether `tokenId` exists.\n316:          *\n317:          * Tokens can be managed by their owner or approved accounts via {approve} or {setApprovalForAll}.\n318:          *\n319:          * Tokens start existing when they are minted (`_mint`),\n320:          * and stop existing when they are burned (`_burn`).\n321:          */\n322:         function _exists(uint256 tokenId) internal view virtual returns (bool) {\n\n326:     /**\n327:          * @dev Returns whether `spender` is allowed to manage `tokenId`.\n328:          *\n329:          * Requirements:\n330:          *\n331:          * - `tokenId` must exist.\n332:          */\n333:         function _isApprovedOrOwner(address spender, uint256 tokenId) internal view virtual returns (bool) {\n\n341:     /**\n342:          * @dev Mints `tokenId` and transfers it to `to`.\n343:          *\n344:          * WARNING: Usage of this method is discouraged, use {_safeMint} whenever possible\n345:          *\n346:          * Requirements:\n347:          *\n348:          * - `tokenId` must not exist.\n349:          * - `to` cannot be the zero address.\n350:          *\n351:          * Emits a {Transfer} event.\n352:          */\n353:         function _mint(address to, uint256 tokenId) internal virtual {\n\n370:     /**\n371:          * @dev Destroys `tokenId`.\n372:          * The approval is cleared when the token is burned.\n373:          *\n374:          * Requirements:\n375:          *\n376:          * - `tokenId` must exist.\n377:          *\n378:          * Emits a {Transfer} event.\n379:          */\n380:         function _burn(uint256 tokenId) internal virtual {\n\n397:     /**\n398:          * @dev Transfers `tokenId` from `from` to `to`.\n399:          *  As opposed to {transferFrom}, this imposes no restrictions on msg.sender.\n400:          *\n401:          * Requirements:\n402:          *\n403:          * - `to` cannot be the zero address.\n404:          * - `tokenId` token must be owned by `from`.\n405:          *\n406:          * Emits a {Transfer} event.\n407:          */\n408:         function _transfer(\n409:             address from,\n410:             address to,\n411:             uint256 tokenId\n412:         ) internal virtual {\n\n434:     /**\n435:          * @dev Approve `to` to operate on `tokenId`\n436:          *\n437:          * Emits a {Approval} event.\n438:          */\n439:         function _approve(address to, uint256 tokenId) internal virtual {\n\n444:     /**\n445:          * @dev Refactored from the original OZ ERC721 implementation: approve or revoke approval from\n446:          * `operator` to operate on all tokens owned by `owner`.\n447:          *\n448:          * Emits a {ApprovalForAll} event.\n449:          */\n450:         function _setOperatorApproval(\n451:             address owner,\n452:             address operator,\n453:             bool approved\n454:         ) internal virtual {\n\n492:     /**\n493:          * @dev Hook that is called before any token transfer. This includes minting\n494:          * and burning.\n495:          *\n496:          * Calling conditions:\n497:          *\n498:          * - When `from` and `to` are both non-zero, ``from``'s `tokenId` will be\n499:          * transferred to `to`.\n500:          * - When `from` is zero, `tokenId` will be minted for `to`.\n501:          * - When `to` is zero, ``from``'s `tokenId` will be burned.\n502:          * - `from` and `to` are never both zero.\n503:          *\n504:          * To learn more about hooks, head to xref:ROOT:extending-contracts.adoc#using-hooks[Using Hooks].\n505:          */\n506:         function _beforeTokenTransfer(\n507:             address from,\n508:             address to,\n509:             uint256 tokenId\n510:         ) internal virtual {}\n\n```\n\n[76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L76), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L81), [94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L94), [103](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L103), [113](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L113), [124](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L124), [135](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L135), [145](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L145), [166](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L166), [170](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L170), [186](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L186), [197](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L197), [208](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L208), [215](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L215), [231](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L231), [242](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L242), [257](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L257), [284](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L284), [314](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L314), [326](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L326), [341](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L341), [370](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L370), [397](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L397), [434](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L434), [444](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L444), [492](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L492),\n\n```solidity\nFile: contracts/base/LensGovernable.sol\n\n24:     /// @inheritdoc ILensGovernable\n25:        function setGovernance(address newGovernance) external override onlyGov {\n\n29:     /// @inheritdoc ILensGovernable\n30:        function setEmergencyAdmin(address newEmergencyAdmin) external override onlyGov {\n\n34:     /// @inheritdoc ILensGovernable\n35:        function setState(Types.ProtocolState newState) external override {\n\n40:     ///@inheritdoc ILensGovernable\n41:        function whitelistProfileCreator(address profileCreator, bool whitelist) external override onlyGov {\n\n45:     /// @inheritdoc ILensGovernable\n46:        function whitelistFollowModule(address followModule, bool whitelist) external override onlyGov {\n\n50:     /// @inheritdoc ILensGovernable\n51:        function whitelistReferenceModule(address referenceModule, bool whitelist) external override onlyGov {\n\n55:     /// @inheritdoc ILensGovernable\n56:        function whitelistActionModule(address actionModule, bool whitelist) external override onlyGov {\n\n81:     /// @inheritdoc ILensGovernable\n82:        function isProfileCreatorWhitelisted(address profileCreator) external view override returns (bool) {\n\n86:     /// @inheritdoc ILensGovernable\n87:        function isFollowModuleWhitelisted(address followModule) external view override returns (bool) {\n\n91:     /// @inheritdoc ILensGovernable\n92:        function isReferenceModuleWhitelisted(address referenceModule) external view override returns (bool) {\n\n96:     /// @inheritdoc ILensGovernable\n97:        function getActionModuleWhitelistData(address actionModule)\n98:            external\n99:            view\n100:            override\n101:            returns (Types.ActionModuleWhitelistData memory)\n102:        {\n\n```\n\n[24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L24), [29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L29), [34](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L34), [40](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L40), [45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L45), [50](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L50), [55](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L55), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L81), [86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L86), [91](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L91), [96](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L96),\n\n```solidity\nFile: contracts/base/LensHubEventHooks.sol\n\n11:     /// @inheritdoc ILensHubEventHooks\n12:        function emitUnfollowedEvent(uint256 unfollowerProfileId, uint256 idOfProfileUnfollowed) external override {\n\n21:     ///       DEPRECATED FUNCTIONS     ///\n22:        //////////////////////////////////////\n23:    \n24:        // Deprecated in V2. Kept here just for backwards compatibility with Lens V1 Collect NFTs.\n25:        function emitCollectNFTTransferEvent(\n26:            uint256 profileId,\n27:            uint256 pubId,\n28:            uint256 collectNFTId,\n29:            address from,\n30:            address to\n31:        ) external {\n\n```\n\n[11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubEventHooks.sol#L11), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubEventHooks.sol#L21),\n\n```solidity\nFile: contracts/base/LensImplGetters.sol\n\n11:     constructor(address followNFTImpl, address collectNFTImpl) {\n\n```\n\n[11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensImplGetters.sol#L11),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n33:     constructor(address moduleGlobals, uint256 tokenGuardianCooldown) {\n\n57:     /// @inheritdoc ILensProfiles\n58:        function getTokenGuardianDisablingTimestamp(address wallet) external view returns (uint256) {\n\n90:     /**\n91:         * @notice Burns a profile, this maintains the profile data struct.\n92:         */\n93:        function burn(uint256 tokenId)\n94:            public\n95:            override(LensBaseERC721, IERC721Burnable)\n96:            whenNotPaused\n97:            onlyProfileOwner(msg.sender, tokenId)\n98:        {\n\n102:     /**\n103:          * @dev Overrides the ERC721 tokenURI function to return the associated URI with a given profile.\n104:          */\n105:         function tokenURI(uint256 tokenId) public view override(LensBaseERC721, IERC721Metadata) returns (string memory) {\n\n112:     function approve(address to, uint256 tokenId) public override(LensBaseERC721, IERC721) {\n\n120:     function setApprovalForAll(address operator, bool approved) public override(LensBaseERC721, IERC721) {\n\n128:     /**\n129:          * @dev See {IERC165-supportsInterface}.\n130:          */\n131:         function supportsInterface(bytes4 interfaceId)\n132:             public\n133:             view\n134:             virtual\n135:             override(LensBaseERC721, ERC2981CollectionRoyalties, IERC165)\n136:             returns (bool)\n137:         {\n\n142:     function _hasTokenGuardianEnabled(address wallet) internal view returns (bool) {\n\n149:     function _getRoyaltiesInBasisPointsSlot() internal pure override returns (uint256) {\n\n153:     function _getReceiver(\n154:             uint256 /* tokenId */\n155:         ) internal view override returns (address) {\n\n159:     function _beforeRoyaltiesSet(\n160:             uint256 /* royaltiesInBasisPoints */\n161:         ) internal view override {\n\n165:     function _beforeTokenTransfer(\n166:             address from,\n167:             address to,\n168:             uint256 tokenId\n169:         ) internal override whenNotPaused {\n\n```\n\n[33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L33), [57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L57), [90](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L90), [102](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L102), [112](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L112), [120](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L120), [128](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L128), [142](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L142), [149](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L149), [153](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L153), [159](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L159), [165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L165),\n\n```solidity\nFile: contracts/base/upgradeability/FollowNFTProxy.sol\n\n13:     constructor(bytes memory data) {\n\n18:     function _implementation() internal view override returns (address) {\n\n```\n\n[13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L13), [18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L18),\n\n```solidity\nFile: contracts/misc/ImmutableOwnable.sol\n\n26:     constructor(address owner, address lensHub) {\n\n```\n\n[26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L26),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n38:     constructor(address hub) {\n\n44:     /// @inheritdoc ICollectNFT\n45:        function initialize(uint256 profileId, uint256 pubId) external override {\n\n54:     /// @inheritdoc ICollectNFT\n55:        function mint(address to) external override returns (uint256) {\n\n69:     function tokenURI(uint256 tokenId) public view override returns (string memory) {\n\n88:     /**\n89:         * @dev See {IERC165-supportsInterface}.\n90:         */\n91:        function supportsInterface(bytes4 interfaceId)\n92:            public\n93:            view\n94:            virtual\n95:            override(ERC2981CollectionRoyalties, LensBaseERC721)\n96:            returns (bool)\n97:        {\n\n102:     function _getReceiver(\n103:             uint256 /* tokenId */\n104:         ) internal view override returns (address) {\n\n108:     function _beforeRoyaltiesSet(\n109:             uint256 /* royaltiesInBasisPoints */\n110:         ) internal view override {\n\n116:     function _getRoyaltiesInBasisPointsSlot() internal pure override returns (uint256) {\n\n```\n\n[38](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L38), [44](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L44), [54](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L54), [69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L69), [88](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L88), [102](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L102), [108](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L108), [116](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L116),\n\n```solidity\nFile: contracts/misc/LensV2Migration.sol\n\n19:     constructor(\n20:            address legacyFeeFollowModule,\n21:            address legacyProfileFollowModule,\n22:            address newFeeFollowModule,\n23:            address lensHandlesAddress,\n24:            address tokenHandleRegistryAddress\n25:        ) {\n\n33:     function batchMigrateProfiles(uint256[] calldata profileIds) external {\n\n37:     function batchMigrateFollows(\n38:            uint256[] calldata followerProfileIds,\n39:            uint256[] calldata idsOfProfileFollowed,\n40:            uint256[] calldata followTokenIds\n41:        ) external {\n\n45:     function batchMigrateFollowModules(uint256[] calldata profileIds) external {\n\n```\n\n[19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L19), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L33), [37](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L37), [45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L45),\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n20:     constructor(\n21:            address proxyAdminAddress,\n22:            address governanceAddress,\n23:            address owner,\n24:            address lensHub,\n25:            address newImplementationAddress,\n26:            address[] memory oldFollowModulesToUnwhitelist_,\n27:            address[] memory newFollowModulesToWhitelist_,\n28:            address[] memory oldReferenceModulesToUnwhitelist_,\n29:            address[] memory newReferenceModulesToWhitelist_,\n30:            address[] memory oldCollectModulesToUnwhitelist_,\n31:            address[] memory newActionModulesToWhitelist_\n32:        ) ImmutableOwnable(owner, lensHub) {\n\n44:     function executeLensV2Upgrade() external onlyOwner {\n\n50:     function _upgrade() internal {\n\n64:     function _unwhitelistOldFollowModules() internal {\n\n75:     function _unwhitelistOldReferenceModules() internal {\n\n86:     function _unwhitelistOldCollectModules() internal {\n\n97:     function _whitelistNewFollowModules() internal {\n\n108:     function _whitelistNewReferenceModules() internal {\n\n119:     function _whitelistNewActionModules() internal {\n\n```\n\n[20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L20), [44](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L44), [50](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L50), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L64), [75](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L75), [86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L86), [97](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L97), [108](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L108), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L119),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n49:     /// @inheritdoc IModuleGlobals\n50:        function setGovernance(address newGovernance) external override onlyGov {\n\n54:     /// @inheritdoc IModuleGlobals\n55:        function setTreasury(address newTreasury) external override onlyGov {\n\n59:     /// @inheritdoc IModuleGlobals\n60:        function setTreasuryFee(uint16 newTreasuryFee) external override onlyGov {\n\n64:     /// @inheritdoc IModuleGlobals\n65:        function whitelistCurrency(address currency, bool toWhitelist) external override onlyGov {\n\n69:     /// @inheritdoc IModuleGlobals\n70:        function isCurrencyWhitelisted(address currency) external view override returns (bool) {\n\n90:     function getTreasuryData() external view override returns (address, uint16) {\n\n94:     function _setGovernance(address newGovernance) internal {\n\n101:     function _setTreasury(address newTreasury) internal {\n\n108:     function _setTreasuryFee(uint16 newTreasuryFee) internal {\n\n115:     function _whitelistCurrency(address currency, bool toWhitelist) internal {\n\n```\n\n[49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L49), [54](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L54), [59](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L59), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L64), [69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L69), [90](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L90), [94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L94), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L101), [108](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L108), [115](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L115),\n\n```solidity\nFile: contracts/misc/ProfileCreationProxy.sol\n\n23:     constructor(\n24:            address owner,\n25:            address hub,\n26:            address lensHandles,\n27:            address tokenHandleRegistry\n28:        ) ImmutableOwnable(owner, hub) {\n\n33:     function proxyCreateProfile(Types.CreateProfileParams calldata createProfileParams)\n34:            external\n35:            onlyOwner\n36:            returns (uint256)\n37:        {\n\n41:     function proxyCreateProfileWithHandle(Types.CreateProfileParams memory createProfileParams, string calldata handle)\n42:            external\n43:            onlyOwner\n44:            returns (uint256, uint256)\n45:        {\n\n64:     function proxyCreateHandle(address to, string calldata handle) external onlyOwner returns (uint256) {\n\n```\n\n[23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L23), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L33), [41](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L41), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L64),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n21:     constructor(address owner) Ownable() {\n\n25:     function clearControllerContract() external onlyOwnerOrControllerContract {\n\n30:     function setControllerContract(address newControllerContract) external onlyOwner {\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L21), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L25), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L30),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n9:     function whitelistCollectModule(address collectModule, bool whitelist) external;\n\n15:     constructor(address lensHubAddress_, address governanceOwner_) ControllableByContract(governanceOwner_) {\n\n20:     ///               ONLY GOVERNANCE OWNER              ///\n21:        ////////////////////////////////////////////////////////\n22:    \n23:        function lensHub_setGovernance(address newGovernance) external onlyOwner {\n\n27:     function lensHub_setEmergencyAdmin(address newEmergencyAdmin) external onlyOwner {\n\n32:     ///   ONLY GOVERNANCE OWNER OR CONTROLLER CONTRACT   ///\n33:        ////////////////////////////////////////////////////////\n34:    \n35:        function lensHub_whitelistProfileCreator(address profileCreator, bool whitelist)\n36:            external\n37:            onlyOwnerOrControllerContract\n38:        {\n\n42:     function lensHub_whitelistFollowModule(address followModule, bool whitelist)\n43:            external\n44:            onlyOwnerOrControllerContract\n45:        {\n\n49:     function lensHub_whitelistReferenceModule(address referenceModule, bool whitelist)\n50:            external\n51:            onlyOwnerOrControllerContract\n52:        {\n\n56:     function lensHub_whitelistActionModule(address actionModule, bool whitelist)\n57:            external\n58:            onlyOwnerOrControllerContract\n59:        {\n\n64:     function lensHub_whitelistCollectModule(address collectModule, bool whitelist)\n65:            external\n66:            onlyOwnerOrControllerContract\n67:        {\n\n73:     function executeAsGovernance(address target, bytes calldata data)\n74:            external\n75:            payable\n76:            onlyOwnerOrControllerContract\n77:            returns (bytes memory)\n78:        {\n\n```\n\n[9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L9), [15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L15), [20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L20), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L27), [32](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L32), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L42), [49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L49), [56](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L56), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L64), [73](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L73),\n\n```solidity\nFile: contracts/misc/access/ProxyAdmin.sol\n\n12:     constructor(\n13:            address lensHubAddress_,\n14:            address previousImplementation_,\n15:            address proxyAdminOwner_\n16:        ) ControllableByContract(proxyAdminOwner_) {\n\n21:     function currentImplementation() external returns (address) {\n\n33:     function proxy_changeAdmin(address newAdmin) external onlyOwner {\n\n38:     ///   ONLY PROXY ADMIN OWNER OR CONTROLLER CONTRACT   ///\n39:        /////////////////////////////////////////////////////////\n40:    \n41:        function proxy_upgrade(address newImplementation) external onlyOwnerOrControllerContract {\n\n47:     function proxy_upgradeAndCall(address newImplementation, bytes calldata data)\n48:            external\n49:            onlyOwnerOrControllerContract\n50:        {\n\n```\n\n[12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L12), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L21), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L33), [38](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L38), [47](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L47),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n62:     constructor(\n63:            address owner,\n64:            address lensHub,\n65:            uint256 tokenGuardianCooldown\n66:        ) ERC721('', '') ImmutableOwnable(owner, lensHub) {\n\n70:     function name() public pure override returns (string memory) {\n\n74:     function symbol() public pure override returns (string memory) {\n\n78:     /**\n79:         * @dev See {IERC721Metadata-tokenURI}.\n80:         */\n81:        function tokenURI(uint256 tokenId) public view override returns (string memory) {\n\n86:     /// @inheritdoc ILensHandles\n87:        function mintHandle(address to, string calldata localName)\n88:            external\n89:            onlyOwnerOrWhitelistedProfileCreator\n90:            returns (uint256)\n91:        {\n\n96:     function migrateHandle(address to, string calldata localName) external onlyHub returns (uint256) {\n\n101:     function burn(uint256 tokenId) external {\n\n126:     function enableTokenGuardian() external onlyEOA {\n\n139:     function approve(address to, uint256 tokenId) public override(IERC721, ERC721) {\n\n147:     function setApprovalForAll(address operator, bool approved) public override(IERC721, ERC721) {\n\n155:     function exists(uint256 tokenId) external view returns (bool) {\n\n159:     function getNamespace() external pure returns (string memory) {\n\n163:     function getNamespaceHash() external pure returns (bytes32) {\n\n168:     function getLocalName(uint256 tokenId) public view returns (string memory) {\n\n177:     function getHandle(uint256 tokenId) public view returns (string memory) {\n\n182:     function getTokenId(string memory localName) public pure returns (uint256) {\n\n186:     function getTokenGuardianDisablingTimestamp(address wallet) external view returns (uint256) {\n\n191:     ///        INTERNAL FUNCTIONS      ///\n192:         //////////////////////////////////////\n193:     \n194:         function _mintHandle(address to, string calldata localName) internal returns (uint256) {\n\n202:     function _validateLocalNameMigration(string memory localName) internal view {\n\n226:     function _validateLocalName(string memory localName) internal view {\n\n249:     function _isAlphaNumeric(bytes1 char) internal pure returns (bool) {\n\n253:     function _hasTokenGuardianEnabled(address wallet) internal view returns (bool) {\n\n260:     function _beforeTokenTransfer(\n261:             address from,\n262:             address to,\n263:             uint256 /* firstTokenId */,\n264:             uint256 batchSize\n265:         ) internal override {\n\n```\n\n[62](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L62), [70](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L70), [74](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L74), [78](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L78), [86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L86), [96](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L96), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L101), [126](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L126), [139](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L139), [147](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L147), [155](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L155), [159](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L159), [163](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L163), [168](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L168), [177](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L177), [182](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L182), [186](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L186), [191](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L191), [202](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L202), [226](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L226), [249](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L249), [253](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L253), [260](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L260),\n\n```solidity\nFile: contracts/namespaces/TokenHandleRegistry.sol\n\n42:     constructor(address lensHub, address lensHandles) {\n\n50:     function migrationLink(uint256 handleId, uint256 tokenId) external {\n\n60:     /// @inheritdoc ITokenHandleRegistry\n61:        function link(\n62:            uint256 handleId,\n63:            uint256 tokenId\n64:        ) external onlyTokenOwner(tokenId, msg.sender) onlyHandleOwner(handleId, msg.sender) {\n\n71:     /// @inheritdoc ITokenHandleRegistry\n72:        function unlink(uint256 handleId, uint256 tokenId) external {\n\n93:     /// @inheritdoc ITokenHandleRegistry\n94:        function resolve(uint256 handleId) external view returns (uint256) {\n\n106:     /// @inheritdoc ITokenHandleRegistry\n107:         function getDefaultHandle(uint256 tokenId) external view returns (uint256) {\n\n119:     ///        INTERNAL FUNCTIONS      ///\n120:         //////////////////////////////////////\n121:     \n122:         function _resolveHandleToToken(\n123:             RegistryTypes.Handle memory handle\n124:         ) internal view returns (RegistryTypes.Token storage) {\n\n128:     function _resolveTokenToHandle(\n129:             RegistryTypes.Token memory token\n130:         ) internal view returns (RegistryTypes.Handle storage) {\n\n134:     function _link(RegistryTypes.Handle memory handle, RegistryTypes.Token memory token) internal {\n\n144:     function _deleteTokenToHandleLinkageIfAny(RegistryTypes.Handle memory handle) internal {\n\n152:     function _deleteHandleToTokenLinkageIfAny(RegistryTypes.Token memory token) internal {\n\n160:     function _unlink(RegistryTypes.Handle memory handle, RegistryTypes.Token memory token) internal {\n\n167:     function _handleHash(RegistryTypes.Handle memory handle) internal pure returns (bytes32) {\n\n171:     function _tokenHash(RegistryTypes.Token memory token) internal pure returns (bytes32) {\n\n```\n\n[42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L42), [50](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L50), [60](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L60), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L71), [93](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L93), [106](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L106), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L119), [128](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L128), [134](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L134), [144](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L144), [152](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L152), [160](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L160), [167](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L167), [171](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L171),\n\n```solidity\nFile: contracts/interfaces/ILensHandles.sol\n\n49:     /**\n\n```\n\n[49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHandles.sol#L49),\n\n```solidity\nFile: contracts/interfaces/ILensProtocol.sol\n\n32:     /**\n\n55:     /**\n\n99:     /**\n\n120:     /**\n\n143:     /**\n\n165:     /**\n\n186:     /**\n\n209:     /**\n\n237:     /**\n\n257:     /**\n\n285:     /**\n\n308:     /**\n\n328:     /**\n\n```\n\n[32](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L32), [55](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L55), [99](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L99), [120](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L120), [143](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L143), [165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L165), [186](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L186), [209](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L209), [237](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L237), [257](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L257), [285](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L285), [308](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L308), [328](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L328),\n\n</details>\n\n### <a name=\"N-30\"></a>[N-30] NatSpec `@return` is missing\nIt is recommended that Solidity contracts are fully annotated using NatSpec for all public interfaces (everything in the ABI). It is clearly stated in the Solidity official documentation. In complex projects such as Defi, the interpretation of all functions and their arguments and returns is important for code readability and auditability.[source](https://docs.soliditylang.org/en/v0.8.15/natspec-format.html)\n\n*Instances (299)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/LensHub.sol\n\n66:     constructor(\n67:            address moduleGlobals,\n68:            address followNFTImpl,\n69:            address collectNFTImpl, // We still pass the deprecated CollectNFTImpl for legacy Collects to work\n70:            address lensHandlesAddress,\n71:            address tokenHandleRegistryAddress,\n72:            address legacyFeeFollowModule,\n73:            address legacyProfileFollowModule,\n74:            address newFeeFollowModule,\n75:            uint256 tokenGuardianCooldown\n76:        )\n77:            LensProfiles(moduleGlobals, tokenGuardianCooldown)\n78:            LensV2Migration(\n79:                legacyFeeFollowModule,\n80:                legacyProfileFollowModule,\n81:                newFeeFollowModule,\n82:                lensHandlesAddress,\n83:                tokenHandleRegistryAddress\n84:            )\n85:            LensImplGetters(followNFTImpl, collectNFTImpl)\n86:        {}\n\n88:     /// @inheritdoc ILensProtocol\n89:        function createProfile(Types.CreateProfileParams calldata createProfileParams)\n90:            external\n91:            override\n92:            whenNotPaused\n93:            returns (uint256)\n94:        {\n\n165:     function changeDelegatedExecutorsConfig(\n166:             uint256 delegatorProfileId,\n167:             address[] calldata delegatedExecutors,\n168:             bool[] calldata approvals\n169:         ) external override whenNotPaused onlyProfileOwner(msg.sender, delegatorProfileId) {\n\n223:     /// @inheritdoc ILensProtocol\n224:         function post(Types.PostParams calldata postParams)\n225:             external\n226:             override\n227:             whenPublishingEnabled\n228:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, postParams.profileId)\n229:             returns (uint256)\n230:         {\n\n234:     /// @inheritdoc ILensProtocol\n235:         function postWithSig(Types.PostParams calldata postParams, Types.EIP712Signature calldata signature)\n236:             external\n237:             override\n238:             whenPublishingEnabled\n239:             onlyProfileOwnerOrDelegatedExecutor(signature.signer, postParams.profileId)\n240:             returns (uint256)\n241:         {\n\n246:     /// @inheritdoc ILensProtocol\n247:         function comment(Types.CommentParams calldata commentParams)\n248:             external\n249:             override\n250:             whenPublishingEnabled\n251:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, commentParams.profileId)\n252:             returns (uint256)\n253:         {\n\n257:     /// @inheritdoc ILensProtocol\n258:         function commentWithSig(Types.CommentParams calldata commentParams, Types.EIP712Signature calldata signature)\n259:             external\n260:             override\n261:             whenPublishingEnabled\n262:             onlyProfileOwnerOrDelegatedExecutor(signature.signer, commentParams.profileId)\n263:             returns (uint256)\n264:         {\n\n269:     /// @inheritdoc ILensProtocol\n270:         function mirror(Types.MirrorParams calldata mirrorParams)\n271:             external\n272:             override\n273:             whenPublishingEnabled\n274:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, mirrorParams.profileId)\n275:             returns (uint256)\n276:         {\n\n280:     /// @inheritdoc ILensProtocol\n281:         function mirrorWithSig(Types.MirrorParams calldata mirrorParams, Types.EIP712Signature calldata signature)\n282:             external\n283:             override\n284:             whenPublishingEnabled\n285:             onlyProfileOwnerOrDelegatedExecutor(signature.signer, mirrorParams.profileId)\n286:             returns (uint256)\n287:         {\n\n292:     /// @inheritdoc ILensProtocol\n293:         function quote(Types.QuoteParams calldata quoteParams)\n294:             external\n295:             override\n296:             whenPublishingEnabled\n297:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, quoteParams.profileId)\n298:             returns (uint256)\n299:         {\n\n303:     /// @inheritdoc ILensProtocol\n304:         function quoteWithSig(Types.QuoteParams calldata quoteParams, Types.EIP712Signature calldata signature)\n305:             external\n306:             override\n307:             whenPublishingEnabled\n308:             onlyProfileOwnerOrDelegatedExecutor(signature.signer, quoteParams.profileId)\n309:             returns (uint256)\n310:         {\n\n319:     /// @inheritdoc ILensProtocol\n320:         function follow(\n321:             uint256 followerProfileId,\n322:             uint256[] calldata idsOfProfilesToFollow,\n323:             uint256[] calldata followTokenIds,\n324:             bytes[] calldata datas\n325:         )\n326:             external\n327:             override\n328:             whenNotPaused\n329:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, followerProfileId)\n330:             returns (uint256[] memory)\n331:         {\n\n342:     /// @inheritdoc ILensProtocol\n343:         function followWithSig(\n344:             uint256 followerProfileId,\n345:             uint256[] calldata idsOfProfilesToFollow,\n346:             uint256[] calldata followTokenIds,\n347:             bytes[] calldata datas,\n348:             Types.EIP712Signature calldata signature\n349:         )\n350:             external\n351:             override\n352:             whenNotPaused\n353:             onlyProfileOwnerOrDelegatedExecutor(signature.signer, followerProfileId)\n354:             returns (uint256[] memory)\n355:         {\n\n416:     /// @inheritdoc ILensProtocol\n417:         function collect(Types.CollectParams calldata collectParams)\n418:             external\n419:             override\n420:             whenNotPaused\n421:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, collectParams.collectorProfileId)\n422:             returns (uint256)\n423:         {\n\n433:     /// @inheritdoc ILensProtocol\n434:         function collectWithSig(Types.CollectParams calldata collectParams, Types.EIP712Signature calldata signature)\n435:             external\n436:             override\n437:             whenNotPaused\n438:             onlyProfileOwnerOrDelegatedExecutor(signature.signer, collectParams.collectorProfileId)\n439:             returns (uint256)\n440:         {\n\n451:     /// @inheritdoc ILensProtocol\n452:         function act(Types.PublicationActionParams calldata publicationActionParams)\n453:             external\n454:             override\n455:             whenNotPaused\n456:             onlyProfileOwnerOrDelegatedExecutor(msg.sender, publicationActionParams.actorProfileId)\n457:             returns (bytes memory)\n458:         {\n\n467:     /// @inheritdoc ILensProtocol\n468:         function actWithSig(\n469:             Types.PublicationActionParams calldata publicationActionParams,\n470:             Types.EIP712Signature calldata signature\n471:         )\n472:             external\n473:             override\n474:             whenNotPaused\n475:             onlyProfileOwnerOrDelegatedExecutor(signature.signer, publicationActionParams.actorProfileId)\n476:             returns (bytes memory)\n477:         {\n\n491:     /// @inheritdoc ILensProtocol\n492:         function isFollowing(uint256 followerProfileId, uint256 followedProfileId) external view returns (bool) {\n\n497:     /// @inheritdoc ILensProtocol\n498:         function isDelegatedExecutorApproved(\n499:             uint256 delegatorProfileId,\n500:             address delegatedExecutor,\n501:             uint64 configNumber\n502:         ) external view returns (bool) {\n\n506:     /// @inheritdoc ILensProtocol\n507:         function isDelegatedExecutorApproved(uint256 delegatorProfileId, address delegatedExecutor)\n508:             external\n509:             view\n510:             returns (bool)\n511:         {\n\n515:     /// @inheritdoc ILensProtocol\n516:         function getDelegatedExecutorsConfigNumber(uint256 delegatorProfileId) external view returns (uint64) {\n\n520:     /// @inheritdoc ILensProtocol\n521:         function getDelegatedExecutorsPrevConfigNumber(uint256 delegatorProfileId) external view returns (uint64) {\n\n525:     /// @inheritdoc ILensProtocol\n526:         function getDelegatedExecutorsMaxConfigNumberSet(uint256 delegatorProfileId) external view returns (uint64) {\n\n530:     /// @inheritdoc ILensProtocol\n531:         function isBlocked(uint256 profileId, uint256 byProfileId) external view returns (bool) {\n\n535:     /// @inheritdoc ILensProtocol\n536:         function getContentURI(uint256 profileId, uint256 pubId) external view override returns (string memory) {\n\n541:     /// @inheritdoc ILensProtocol\n542:         function getProfile(uint256 profileId) external view override returns (Types.Profile memory) {\n\n546:     /// @inheritdoc ILensProtocol\n547:         function getPublication(uint256 profileId, uint256 pubId)\n548:             external\n549:             view\n550:             override\n551:             returns (Types.Publication memory)\n552:         {\n\n556:     /// @inheritdoc ILensProtocol\n557:         function getPublicationType(uint256 profileId, uint256 pubId)\n558:             external\n559:             view\n560:             override\n561:             returns (Types.PublicationType)\n562:         {\n\n566:     function getActionModuleById(uint256 id) external view override returns (address) {\n\n```\n\n[66](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L66), [88](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L88), [165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L165), [223](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L223), [234](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L234), [246](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L246), [257](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L257), [269](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L269), [280](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L280), [292](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L292), [303](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L303), [319](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L319), [342](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L342), [416](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L416), [433](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L433), [451](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L451), [467](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L467), [491](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L491), [497](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L497), [506](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L506), [515](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L515), [520](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L520), [525](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L525), [530](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L530), [535](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L535), [541](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L541), [546](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L546), [556](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L556), [566](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L566),\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n43:     constructor(address hub) HubRestricted(hub) {\n\n58:     /// @inheritdoc IFollowNFT\n59:        function follow(\n60:            uint256 followerProfileId,\n61:            address transactionExecutor,\n62:            uint256 followTokenId\n63:        ) external override onlyHub returns (uint256) {\n\n168:     function _wrap(uint256 followTokenId, address wrappedTokenReceiver) internal {\n\n195:     /// @inheritdoc IFollowNFT\n196:         function processBlock(uint256 followerProfileId) external override onlyHub returns (bool) {\n\n210:     /// @inheritdoc IFollowNFT\n211:         function getFollowerProfileId(uint256 followTokenId) external view override returns (uint256) {\n\n215:     /// @inheritdoc IFollowNFT\n216:         function isFollowing(uint256 followerProfileId) external view override returns (bool) {\n\n220:     /// @inheritdoc IFollowNFT\n221:         function getFollowTokenId(uint256 followerProfileId) external view override returns (uint256) {\n\n225:     /// @inheritdoc IFollowNFT\n226:         function getOriginalFollowTimestamp(uint256 followTokenId) external view override returns (uint256) {\n\n230:     /// @inheritdoc IFollowNFT\n231:         function getFollowTimestamp(uint256 followTokenId) external view override returns (uint256) {\n\n235:     /// @inheritdoc IFollowNFT\n236:         function getProfileIdAllowedToRecover(uint256 followTokenId) external view override returns (uint256) {\n\n240:     /// @inheritdoc IFollowNFT\n241:         function getFollowData(uint256 followTokenId) external view override returns (Types.FollowData memory) {\n\n245:     /// @inheritdoc IFollowNFT\n246:         function getFollowApproved(uint256 followTokenId) external view override returns (uint256) {\n\n250:     /// @inheritdoc IFollowNFT\n251:         function getFollowerCount() external view override returns (uint256) {\n\n255:     function burn(uint256 followTokenId) public override {\n\n260:     /**\n261:          * @dev See {IERC165-supportsInterface}.\n262:          */\n263:         function supportsInterface(bytes4 interfaceId)\n264:             public\n265:             view\n266:             virtual\n267:             override(LensBaseERC721, ERC2981CollectionRoyalties)\n268:             returns (bool)\n269:         {\n\n274:     function name() public view override returns (string memory) {\n\n278:     function symbol() public view override returns (string memory) {\n\n282:     /**\n283:          * @dev This returns the follow NFT URI fetched from the hub.\n284:          */\n285:         function tokenURI(uint256 followTokenId) public view override returns (string memory) {\n\n297:     function _followMintingNewToken(uint256 followerProfileId) internal returns (uint256) {\n\n311:     function _followWithWrappedToken(\n312:             uint256 followerProfileId,\n313:             address transactionExecutor,\n314:             uint256 followTokenId,\n315:             address followTokenOwner\n316:         ) internal returns (uint256) {\n\n341:     function _followWithUnwrappedTokenFromBurnedProfile(\n342:             uint256 followerProfileId,\n343:             uint256 followTokenId,\n344:             uint256 currentFollowerProfileId\n345:         ) internal returns (uint256) {\n\n357:     function _followByRecoveringToken(uint256 followerProfileId, uint256 followTokenId) internal returns (uint256) {\n\n368:     function _replaceFollower(\n369:             uint256 currentFollowerProfileId,\n370:             uint256 newFollowerProfileId,\n371:             uint256 followTokenId\n372:         ) internal {\n\n386:     function _baseFollow(\n387:             uint256 followerProfileId,\n388:             uint256 followTokenId,\n389:             bool isOriginalFollow\n390:         ) internal {\n\n408:     function _unfollowIfHasFollower(uint256 followTokenId) internal {\n\n416:     function _unfollow(uint256 unfollower, uint256 followTokenId) internal {\n\n428:     function _approveFollow(uint256 approvedProfileId, uint256 followTokenId) internal {\n\n449:     function _getReceiver(\n450:             uint256 /* followTokenId */\n451:         ) internal view override returns (address) {\n\n455:     function _beforeRoyaltiesSet(\n456:             uint256 /* royaltiesInBasisPoints */\n457:         ) internal view override {\n\n463:     function _isFollowTokenWrapped(uint256 followTokenId) internal view returns (bool) {\n\n467:     function _getRoyaltiesInBasisPointsSlot() internal pure override returns (uint256) {\n\n476:     /// Migrations ///\n477:         //////////////////\n478:     \n479:         // This function shouldn't fail under no circumstances, except if wrong parameters are passed.\n480:         function tryMigrate(\n481:             uint256 followerProfileId,\n482:             address followerProfileOwner,\n483:             uint256 idOfProfileFollowed,\n484:             uint256 followTokenId\n485:         ) external onlyHub returns (uint48) {\n\n```\n\n[43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L43), [58](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L58), [168](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L168), [195](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L195), [210](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L210), [215](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L215), [220](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L220), [225](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L225), [230](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L230), [235](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L235), [240](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L240), [245](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L245), [250](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L250), [255](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L255), [260](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L260), [274](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L274), [278](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L278), [282](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L282), [297](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L297), [311](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L311), [341](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L341), [357](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L357), [368](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L368), [386](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L386), [408](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L408), [416](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L416), [428](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L428), [449](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L449), [455](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L455), [463](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L463), [467](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L467), [476](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L476),\n\n```solidity\nFile: contracts/libraries/ActionLib.sol\n\n13:     function act(\n14:            Types.PublicationActionParams calldata publicationActionParams,\n15:            address transactionExecutor,\n16:            address actorProfileOwner\n17:        ) external returns (bytes memory) {\n\n65:     function _isActionEnabled(Types.Publication storage _publication, uint256 actionModuleId)\n66:            private\n67:            view\n68:            returns (bool)\n69:        {\n\n```\n\n[13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L13), [65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L65),\n\n```solidity\nFile: contracts/libraries/FollowLib.sol\n\n15:     function follow(\n16:            uint256 followerProfileId,\n17:            address transactionExecutor,\n18:            uint256[] calldata idsOfProfilesToFollow,\n19:            uint256[] calldata followTokenIds,\n20:            bytes[] calldata followModuleDatas\n21:        ) external returns (uint256[] memory) {\n\n54:     function unfollow(\n55:            uint256 unfollowerProfileId,\n56:            address transactionExecutor,\n57:            uint256[] calldata idsOfProfilesToUnfollow\n58:        ) external {\n\n98:     function _follow(\n99:            uint256 followerProfileId,\n100:            address transactionExecutor,\n101:            uint256 idOfProfileToFollow,\n102:            uint256 followTokenId,\n103:            bytes calldata followModuleData\n104:        ) private returns (uint256) {\n\n```\n\n[15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L15), [54](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L54), [98](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L98),\n\n```solidity\nFile: contracts/libraries/GovernanceLib.sol\n\n64:     function _setState(Types.ProtocolState newState) private returns (Types.ProtocolState) {\n\n71:     function whitelistProfileCreator(address profileCreator, bool whitelist) external {\n\n76:     function whitelistFollowModule(address followModule, bool whitelist) external {\n\n81:     function whitelistReferenceModule(address referenceModule, bool whitelist) external {\n\n86:     function whitelistActionModule(address actionModule, bool whitelist) external {\n\n```\n\n[64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L64), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L71), [76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L76), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L81), [86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L86),\n\n```solidity\nFile: contracts/libraries/LegacyCollectLib.sol\n\n45:     function collect(\n46:            Types.CollectParams calldata collectParams,\n47:            address transactionExecutor,\n48:            address collectorProfileOwner,\n49:            address collectNFTImpl\n50:        ) external returns (uint256) {\n\n115:     function _getOrDeployCollectNFT(\n116:             Types.Publication storage _collectedPublication,\n117:             uint256 publicationCollectedProfileId,\n118:             uint256 publicationCollectedId,\n119:             address collectNFTImpl\n120:         ) private returns (address) {\n\n```\n\n[45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L45), [115](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L115),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n43:     function validateSetProfileMetadataURISignature(\n44:            Types.EIP712Signature calldata signature,\n45:            uint256 profileId,\n46:            string calldata metadataURI\n47:        ) external {\n\n64:     function validateSetFollowModuleSignature(\n65:            Types.EIP712Signature calldata signature,\n66:            uint256 profileId,\n67:            address followModule,\n68:            bytes calldata followModuleInitData\n69:        ) external {\n\n87:     function validateChangeDelegatedExecutorsConfigSignature(\n88:            Types.EIP712Signature calldata signature,\n89:            uint256 delegatorProfileId,\n90:            address[] calldata delegatedExecutors,\n91:            bool[] calldata approvals,\n92:            uint64 configNumber,\n93:            bool switchToGivenConfig\n94:        ) external {\n\n116:     function validateSetProfileImageURISignature(\n117:             Types.EIP712Signature calldata signature,\n118:             uint256 profileId,\n119:             string calldata imageURI\n120:         ) external {\n\n137:     function validatePostSignature(Types.EIP712Signature calldata signature, Types.PostParams calldata postParams)\n138:             external\n139:         {\n\n160:     function _hashActionModulesInitDatas(bytes[] memory actionModulesInitDatas) private pure returns (bytes32) {\n\n190:     function _abiEncode(ReferenceParamsForAbiEncode memory referenceParamsForAbiEncode)\n191:             private\n192:             pure\n193:             returns (bytes memory)\n194:         {\n\n225:     function validateCommentSignature(\n226:             Types.EIP712Signature calldata signature,\n227:             Types.CommentParams calldata commentParams\n228:         ) external {\n\n256:     function validateQuoteSignature(Types.EIP712Signature calldata signature, Types.QuoteParams calldata quoteParams)\n257:             external\n258:         {\n\n286:     function validateMirrorSignature(Types.EIP712Signature calldata signature, Types.MirrorParams calldata mirrorParams)\n287:             external\n288:         {\n\n309:     function validateBurnSignature(Types.EIP712Signature calldata signature, uint256 tokenId) external {\n\n320:     function validateFollowSignature(\n321:             Types.EIP712Signature calldata signature,\n322:             uint256 followerProfileId,\n323:             uint256[] calldata idsOfProfilesToFollow,\n324:             uint256[] calldata followTokenIds,\n325:             bytes[] calldata datas\n326:         ) external {\n\n357:     function validateUnfollowSignature(\n358:             Types.EIP712Signature calldata signature,\n359:             uint256 unfollowerProfileId,\n360:             uint256[] calldata idsOfProfilesToUnfollow\n361:         ) external {\n\n378:     function validateSetBlockStatusSignature(\n379:             Types.EIP712Signature calldata signature,\n380:             uint256 byProfileId,\n381:             uint256[] calldata idsOfProfilesToSetBlockStatus,\n382:             bool[] calldata blockStatus\n383:         ) external {\n\n401:     function validateLegacyCollectSignature(\n402:             Types.EIP712Signature calldata signature,\n403:             Types.CollectParams calldata collectParams\n404:         ) external {\n\n425:     function validateActSignature(\n426:             Types.EIP712Signature calldata signature,\n427:             Types.PublicationActionParams calldata publicationActionParams\n428:         ) external {\n\n450:     function calculateDomainSeparator() internal view returns (bytes32) {\n\n```\n\n[43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L43), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L64), [87](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L87), [116](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L116), [137](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L137), [160](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L160), [190](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L190), [225](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L225), [256](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L256), [286](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L286), [309](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L309), [320](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L320), [357](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L357), [378](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L378), [401](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L401), [425](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L425), [450](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L450),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n20:     function getProfileData(uint256 profileId) external view returns (ProfileData memory);\n\n94:     function batchMigrateFollows(\n95:            uint256[] calldata followerProfileIds,\n96:            uint256[] calldata idsOfProfileFollowed,\n97:            uint256[] calldata followTokenIds\n98:        ) external {\n\n114:     function _migrateFollow(\n115:             uint256 followerProfileId,\n116:             uint256 idOfProfileFollowed,\n117:             uint256 followTokenId\n118:         ) private {\n\n141:     function batchMigrateFollowModules(\n142:             uint256[] calldata profileIds,\n143:             address legacyFeeFollowModule,\n144:             address legacyProfileFollowModule,\n145:             address newFeeFollowModule\n146:         ) external {\n\n```\n\n[20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L20), [94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L94), [114](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L114), [141](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L141),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n16:     function ownerOf(uint256 profileId) internal view returns (address) {\n\n24:     function exists(uint256 profileId) internal view returns (bool) {\n\n105:     function setProfileMetadataURI(uint256 profileId, string calldata metadataURI) external {\n\n110:     function _initFollowModule(\n111:             uint256 profileId,\n112:             address transactionExecutor,\n113:             address followModule,\n114:             bytes memory followModuleInitData\n115:         ) private returns (bytes memory) {\n\n120:     function _setProfileImageURI(uint256 profileId, string calldata imageURI) private {\n\n128:     function setBlockStatus(\n129:             uint256 byProfileId,\n130:             uint256[] calldata idsOfProfilesToSetBlockStatus,\n131:             bool[] calldata blockStatus\n132:         ) external {\n\n166:     function switchToNewFreshDelegatedExecutorsConfig(uint256 profileId) external {\n\n180:     function changeDelegatedExecutorsConfig(\n181:             uint256 delegatorProfileId,\n182:             address[] calldata delegatedExecutors,\n183:             bool[] calldata approvals\n184:         ) external {\n\n198:     function changeGivenDelegatedExecutorsConfig(\n199:             uint256 delegatorProfileId,\n200:             address[] calldata delegatedExecutors,\n201:             bool[] calldata approvals,\n202:             uint64 configNumber,\n203:             bool switchToGivenConfig\n204:         ) external {\n\n215:     function isExecutorApproved(uint256 delegatorProfileId, address delegatedExecutor) external view returns (bool) {\n\n222:     function _changeDelegatedExecutorsConfig(\n223:             Types.DelegatedExecutorsConfig storage _delegatedExecutorsConfig,\n224:             uint256 delegatorProfileId,\n225:             address[] memory delegatedExecutors,\n226:             bool[] memory approvals,\n227:             uint64 configNumber,\n228:             bool switchToGivenConfig\n229:         ) private {\n\n255:     function _prepareStorageToApplyChangesUnderGivenConfig(\n256:             Types.DelegatedExecutorsConfig storage _delegatedExecutorsConfig,\n257:             uint64 configNumber,\n258:             bool switchToGivenConfig\n259:         ) private returns (bool) {\n\n```\n\n[16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L16), [24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L24), [105](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L105), [110](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L110), [120](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L120), [128](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L128), [166](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L166), [180](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L180), [198](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L198), [215](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L215), [222](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L222), [255](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L255),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n170:     function getPublicationType(uint256 profileId, uint256 pubId) internal view returns (Types.PublicationType) {\n\n190:     function getContentURI(uint256 profileId, uint256 pubId) external view returns (string memory) {\n\n203:     function _asReferencePubParams(Types.QuoteParams calldata quoteParams)\n204:             private\n205:             pure\n206:             returns (Types.ReferencePubParams calldata referencePubParams)\n207:         {\n\n214:     function _asReferencePubParams(Types.CommentParams calldata commentParams)\n215:             private\n216:             pure\n217:             returns (Types.ReferencePubParams calldata referencePubParams)\n218:         {\n\n225:     function _createReferencePublication(\n226:             Types.ReferencePubParams calldata referencePubParams,\n227:             address transactionExecutor,\n228:             Types.PublicationType referencePubType\n229:         )\n230:             private\n231:             returns (\n232:                 uint256,\n233:                 bytes[] memory,\n234:                 bytes memory,\n235:                 Types.PublicationType[] memory\n236:             )\n237:         {\n\n272:     function _fillReferencePublicationStorage(\n273:             Types.ReferencePubParams calldata referencePubParams,\n274:             Types.PublicationType referencePubType\n275:         ) private returns (uint256) {\n\n291:     function _fillRootOfPublicationInStorage(\n292:             Types.Publication storage _publication,\n293:             uint256 pointedProfileId,\n294:             uint256 pointedPubId\n295:         ) internal {\n\n313:     function _processCommentIfNeeded(\n314:             Types.CommentParams calldata commentParams,\n315:             address transactionExecutor,\n316:             Types.PublicationType[] memory referrerPubTypes\n317:         ) private returns (bytes memory) {\n\n366:     function _processQuoteIfNeeded(\n367:             Types.QuoteParams calldata quoteParams,\n368:             address transactionExecutor,\n369:             Types.PublicationType[] memory referrerPubTypes\n370:         ) private returns (bytes memory) {\n\n419:     function _processMirrorIfNeeded(\n420:             Types.MirrorParams calldata mirrorParams,\n421:             address transactionExecutor,\n422:             Types.PublicationType[] memory referrerPubTypes\n423:         ) private returns (bytes memory) {\n\n472:     function _initPubActionModules(\n473:             uint256 profileId,\n474:             address transactionExecutor,\n475:             uint256 pubId,\n476:             address[] calldata actionModules,\n477:             bytes[] calldata actionModulesInitDatas\n478:         ) private returns (bytes[] memory) {\n\n521:     function _initPubReferenceModule(\n522:             uint256 profileId,\n523:             address transactionExecutor,\n524:             uint256 pubId,\n525:             address referenceModule,\n526:             bytes memory referenceModuleInitData\n527:         ) private returns (bytes memory) {\n\n```\n\n[170](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L170), [190](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L190), [203](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L203), [214](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L214), [225](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L225), [272](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L272), [291](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L291), [313](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L313), [366](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L366), [419](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L419), [472](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L472), [521](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L521),\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n49:     function getPublication(uint256 profileId, uint256 pubId)\n50:            internal\n51:            pure\n52:            returns (Types.Publication storage _publication)\n53:        {\n\n63:     function getProfile(uint256 profileId) internal pure returns (Types.Profile storage _profiles) {\n\n71:     function getDelegatedExecutorsConfig(uint256 delegatorProfileId)\n72:            internal\n73:            pure\n74:            returns (Types.DelegatedExecutorsConfig storage _delegatedExecutorsConfig)\n75:        {\n\n83:     function tokenGuardianDisablingTimestamp()\n84:            internal\n85:            pure\n86:            returns (mapping(address => uint256) storage _tokenGuardianDisablingTimestamp)\n87:        {\n\n93:     function getTokenData(uint256 tokenId) internal pure returns (Types.TokenData storage _tokenData) {\n\n101:     function blockedStatus(uint256 blockerProfileId)\n102:             internal\n103:             pure\n104:             returns (mapping(uint256 => bool) storage _blockedStatus)\n105:         {\n\n113:     function nonces() internal pure returns (mapping(address => uint256) storage _nonces) {\n\n119:     function profileIdByHandleHash()\n120:             internal\n121:             pure\n122:             returns (mapping(bytes32 => uint256) storage _profileIdByHandleHash)\n123:         {\n\n129:     function profileCreatorWhitelisted()\n130:             internal\n131:             pure\n132:             returns (mapping(address => bool) storage _profileCreatorWhitelisted)\n133:         {\n\n139:     function followModuleWhitelisted()\n140:             internal\n141:             pure\n142:             returns (mapping(address => bool) storage _followModuleWhitelisted)\n143:         {\n\n149:     function actionModuleWhitelistData()\n150:             internal\n151:             pure\n152:             returns (mapping(address => Types.ActionModuleWhitelistData) storage _actionModuleWhitelistData)\n153:         {\n\n159:     function actionModuleById() internal pure returns (mapping(uint256 => address) storage _actionModules) {\n\n165:     function incrementMaxActionModuleIdUsed() internal returns (uint256) {\n\n177:     function referenceModuleWhitelisted()\n178:             internal\n179:             pure\n180:             returns (mapping(address => bool) storage _referenceModuleWhitelisted)\n181:         {\n\n187:     function getGovernance() internal view returns (address _governance) {\n\n193:     function setGovernance(address newGovernance) internal {\n\n199:     function getEmergencyAdmin() internal view returns (address _emergencyAdmin) {\n\n205:     function setEmergencyAdmin(address newEmergencyAdmin) internal {\n\n211:     function getState() internal view returns (Types.ProtocolState _state) {\n\n217:     function setState(Types.ProtocolState newState) internal {\n\n223:     function getLastInitializedRevision() internal view returns (uint256 _lastInitializedRevision) {\n\n229:     function setLastInitializedRevision(uint256 newLastInitializedRevision) internal {\n\n```\n\n[49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L49), [63](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L63), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L71), [83](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L83), [93](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L93), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L101), [113](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L113), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L119), [129](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L129), [139](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L139), [149](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L149), [159](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L159), [165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L165), [177](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L177), [187](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L187), [193](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L193), [199](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L199), [205](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L205), [211](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L211), [217](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L217), [223](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L223), [229](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L229),\n\n```solidity\nFile: contracts/libraries/ValidationLib.sol\n\n16:     function validatePointedPub(uint256 profileId, uint256 pubId) internal view {\n\n24:     function validateAddressIsProfileOwner(address expectedProfileOwner, uint256 profileId) internal view {\n\n30:     function validateAddressIsProfileOwnerOrDelegatedExecutor(\n31:            address expectedOwnerOrDelegatedExecutor,\n32:            uint256 profileId\n33:        ) internal view {\n\n42:     function validateAddressIsDelegatedExecutor(address expectedDelegatedExecutor, uint256 delegatorProfileId)\n43:            internal\n44:            view\n45:        {\n\n51:     function validateReferenceModuleWhitelisted(address referenceModule) internal view {\n\n57:     function validateFollowModuleWhitelisted(address followModule) internal view {\n\n63:     function validateProfileCreatorWhitelisted(address profileCreator) internal view {\n\n69:     function validateNotBlocked(uint256 profile, uint256 byProfile) internal view {\n\n75:     function validateProfileExists(uint256 profileId) internal view {\n\n81:     function validateCallerIsGovernance() internal view {\n\n87:     function validateReferrersAndGetReferrersPubTypes(\n88:            uint256[] memory referrerProfileIds,\n89:            uint256[] memory referrerPubIds,\n90:            uint256 targetedProfileId,\n91:            uint256 targetedPubId\n92:        ) internal view returns (Types.PublicationType[] memory) {\n\n121:     function validateLegacyCollectReferrer(\n122:             uint256 referrerProfileId,\n123:             uint256 referrerPubId,\n124:             uint256 publicationCollectedProfileId,\n125:             uint256 publicationCollectedId\n126:         ) external view {\n\n143:     function _validateReferrerAndGetReferrerPubType(\n144:             uint256 referrerProfileId,\n145:             uint256 referrerPubId,\n146:             uint256 targetedProfileId,\n147:             uint256 targetedPubId\n148:         ) private view returns (Types.PublicationType) {\n\n181:     function _validateReferrerAsPost(\n182:             uint256 referrerProfileId,\n183:             uint256 referrerPubId,\n184:             uint256 targetedProfileId,\n185:             uint256 targetedPubId\n186:         ) private view {\n\n```\n\n[16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L16), [24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L24), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L30), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L42), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L51), [57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L57), [63](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L63), [69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L69), [75](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L75), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L81), [87](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L87), [121](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L121), [143](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L143), [181](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L181),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n14:     /**\n15:         * @dev See {IERC165-supportsInterface}.\n16:         */\n17:        function supportsInterface(bytes4 interfaceId) public view virtual returns (bool) {\n\n31:     /**\n32:         * @notice Called with the sale price to determine how much royalty is owed and to whom.\n33:         *\n34:         * @param tokenId The ID of the token queried for royalty information.\n35:         * @param salePrice The sale price of the token specified.\n36:         * @return A tuple with the address that should receive the royalties and the royalty\n37:         * payment amount for the given sale price.\n38:         */\n39:        function royaltyInfo(uint256 tokenId, uint256 salePrice) external view returns (address, uint256) {\n\n43:     function _setRoyalty(uint256 royaltiesInBasisPoints) internal virtual {\n\n51:     function _getRoyaltyAmount(\n52:            uint256, /* tokenId */\n53:            uint256 salePrice\n54:        ) internal view virtual returns (uint256) {\n\n58:     function _storeRoyaltiesInBasisPoints(uint256 royaltiesInBasisPoints) internal virtual {\n\n65:     function _loadRoyaltiesInBasisPoints() internal view virtual returns (uint256) {\n\n74:     function _beforeRoyaltiesSet(uint256 royaltiesInBasisPoints) internal view virtual;\n\n76:     function _getRoyaltiesInBasisPointsSlot() internal view virtual returns (uint256);\n\n78:     function _getReceiver(uint256 tokenId) internal view virtual returns (address);\n\n```\n\n[14](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L14), [31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L31), [43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L43), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L51), [58](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L58), [65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L65), [74](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L74), [76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L76), [78](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L78),\n\n```solidity\nFile: contracts/base/HubRestricted.sol\n\n24:     constructor(address hub) {\n\n```\n\n[24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/HubRestricted.sol#L24),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n76:     /**\n\n81:     /**\n82:         * @dev See {IERC165-supportsInterface}.\n83:         */\n84:        function supportsInterface(bytes4 interfaceId) public view virtual override(ERC165, IERC165) returns (bool) {\n\n94:     function nonces(address signer) public view override returns (uint256) {\n\n98:     /// @inheritdoc IERC721MetaTx\n99:        function getDomainSeparator() external view virtual override returns (bytes32) {\n\n103:     /**\n104:          * @dev See {IERC721-balanceOf}.\n105:          */\n106:         function balanceOf(address owner) public view virtual override returns (uint256) {\n\n113:     /**\n114:          * @dev See {IERC721-ownerOf}.\n115:          */\n116:         function ownerOf(uint256 tokenId) public view virtual override returns (address) {\n\n124:     /**\n125:          * @dev See {IERC721Timestamped-mintTimestampOf}\n126:          */\n127:         function mintTimestampOf(uint256 tokenId) public view virtual override returns (uint256) {\n\n135:     /**\n136:          * @dev See {IERC721Timestamped-tokenDataOf}\n137:          */\n138:         function tokenDataOf(uint256 tokenId) public view virtual override returns (Types.TokenData memory) {\n\n145:     /**\n146:          * @dev See {IERC721Timestamped-exists}\n147:          */\n148:         function exists(uint256 tokenId) public view virtual override returns (bool) {\n\n152:     /**\n153:          * @dev See {IERC721Metadata-name}.\n154:          */\n155:         function name() public view virtual override returns (string memory) {\n\n159:     /**\n160:          * @dev See {IERC721Metadata-symbol}.\n161:          */\n162:         function symbol() public view virtual override returns (string memory) {\n\n166:     function totalSupply() external view virtual override returns (uint256) {\n\n186:     /**\n187:          * @dev See {IERC721-getApproved}.\n188:          */\n189:         function getApproved(uint256 tokenId) public view virtual override returns (address) {\n\n208:     /**\n209:          * @dev See {IERC721-isApprovedForAll}.\n210:          */\n211:         function isApprovedForAll(address owner, address operator) public view virtual override returns (bool) {\n\n314:     /**\n315:          * @dev Returns whether `tokenId` exists.\n316:          *\n317:          * Tokens can be managed by their owner or approved accounts via {approve} or {setApprovalForAll}.\n318:          *\n319:          * Tokens start existing when they are minted (`_mint`),\n320:          * and stop existing when they are burned (`_burn`).\n321:          */\n322:         function _exists(uint256 tokenId) internal view virtual returns (bool) {\n\n326:     /**\n327:          * @dev Returns whether `spender` is allowed to manage `tokenId`.\n328:          *\n329:          * Requirements:\n330:          *\n331:          * - `tokenId` must exist.\n332:          */\n333:         function _isApprovedOrOwner(address spender, uint256 tokenId) internal view virtual returns (bool) {\n\n```\n\n[76](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L76), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L81), [94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L94), [98](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L98), [103](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L103), [113](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L113), [124](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L124), [135](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L135), [145](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L145), [152](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L152), [159](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L159), [166](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L166), [186](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L186), [208](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L208), [314](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L314), [326](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L326),\n\n```solidity\nFile: contracts/base/LensGovernable.sol\n\n64:     /// @inheritdoc ILensGovernable\n65:        function getGovernance() external view override returns (address) {\n\n81:     /// @inheritdoc ILensGovernable\n82:        function isProfileCreatorWhitelisted(address profileCreator) external view override returns (bool) {\n\n86:     /// @inheritdoc ILensGovernable\n87:        function isFollowModuleWhitelisted(address followModule) external view override returns (bool) {\n\n91:     /// @inheritdoc ILensGovernable\n92:        function isReferenceModuleWhitelisted(address referenceModule) external view override returns (bool) {\n\n96:     /// @inheritdoc ILensGovernable\n97:        function getActionModuleWhitelistData(address actionModule)\n98:            external\n99:            view\n100:            override\n101:            returns (Types.ActionModuleWhitelistData memory)\n102:        {\n\n```\n\n[64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L64), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L81), [86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L86), [91](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L91), [96](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L96),\n\n```solidity\nFile: contracts/base/LensImplGetters.sol\n\n11:     constructor(address followNFTImpl, address collectNFTImpl) {\n\n16:     /// @inheritdoc ILensImplGetters\n17:        function getFollowNFTImpl() external view override returns (address) {\n\n21:     /// @inheritdoc ILensImplGetters\n22:        function getCollectNFTImpl() external view override returns (address) {\n\n```\n\n[11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensImplGetters.sol#L11), [16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensImplGetters.sol#L16), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensImplGetters.sol#L21),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n33:     constructor(address moduleGlobals, uint256 tokenGuardianCooldown) {\n\n57:     /// @inheritdoc ILensProfiles\n58:        function getTokenGuardianDisablingTimestamp(address wallet) external view returns (uint256) {\n\n102:     /**\n103:          * @dev Overrides the ERC721 tokenURI function to return the associated URI with a given profile.\n104:          */\n105:         function tokenURI(uint256 tokenId) public view override(LensBaseERC721, IERC721Metadata) returns (string memory) {\n\n112:     function approve(address to, uint256 tokenId) public override(LensBaseERC721, IERC721) {\n\n120:     function setApprovalForAll(address operator, bool approved) public override(LensBaseERC721, IERC721) {\n\n128:     /**\n129:          * @dev See {IERC165-supportsInterface}.\n130:          */\n131:         function supportsInterface(bytes4 interfaceId)\n132:             public\n133:             view\n134:             virtual\n135:             override(LensBaseERC721, ERC2981CollectionRoyalties, IERC165)\n136:             returns (bool)\n137:         {\n\n142:     function _hasTokenGuardianEnabled(address wallet) internal view returns (bool) {\n\n149:     function _getRoyaltiesInBasisPointsSlot() internal pure override returns (uint256) {\n\n153:     function _getReceiver(\n154:             uint256 /* tokenId */\n155:         ) internal view override returns (address) {\n\n159:     function _beforeRoyaltiesSet(\n160:             uint256 /* royaltiesInBasisPoints */\n161:         ) internal view override {\n\n165:     function _beforeTokenTransfer(\n166:             address from,\n167:             address to,\n168:             uint256 tokenId\n169:         ) internal override whenNotPaused {\n\n```\n\n[33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L33), [57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L57), [102](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L102), [112](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L112), [120](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L120), [128](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L128), [142](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L142), [149](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L149), [153](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L153), [159](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L159), [165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L165),\n\n```solidity\nFile: contracts/base/upgradeability/FollowNFTProxy.sol\n\n13:     constructor(bytes memory data) {\n\n18:     function _implementation() internal view override returns (address) {\n\n```\n\n[13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L13), [18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L18),\n\n```solidity\nFile: contracts/misc/ImmutableOwnable.sol\n\n26:     constructor(address owner, address lensHub) {\n\n```\n\n[26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L26),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n38:     constructor(address hub) {\n\n54:     /// @inheritdoc ICollectNFT\n55:        function mint(address to) external override returns (uint256) {\n\n64:     /// @inheritdoc ICollectNFT\n65:        function getSourcePublicationPointer() external view override returns (uint256, uint256) {\n\n69:     function tokenURI(uint256 tokenId) public view override returns (string memory) {\n\n74:     /**\n75:         * @dev See {IERC721Metadata-name}.\n76:         */\n77:        function name() public view override returns (string memory) {\n\n81:     /**\n82:         * @dev See {IERC721Metadata-symbol}.\n83:         */\n84:        function symbol() public pure override returns (string memory) {\n\n88:     /**\n89:         * @dev See {IERC165-supportsInterface}.\n90:         */\n91:        function supportsInterface(bytes4 interfaceId)\n92:            public\n93:            view\n94:            virtual\n95:            override(ERC2981CollectionRoyalties, LensBaseERC721)\n96:            returns (bool)\n97:        {\n\n102:     function _getReceiver(\n103:             uint256 /* tokenId */\n104:         ) internal view override returns (address) {\n\n108:     function _beforeRoyaltiesSet(\n109:             uint256 /* royaltiesInBasisPoints */\n110:         ) internal view override {\n\n116:     function _getRoyaltiesInBasisPointsSlot() internal pure override returns (uint256) {\n\n```\n\n[38](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L38), [54](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L54), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L64), [69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L69), [74](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L74), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L81), [88](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L88), [102](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L102), [108](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L108), [116](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L116),\n\n```solidity\nFile: contracts/misc/LensV2Migration.sol\n\n19:     constructor(\n20:            address legacyFeeFollowModule,\n21:            address legacyProfileFollowModule,\n22:            address newFeeFollowModule,\n23:            address lensHandlesAddress,\n24:            address tokenHandleRegistryAddress\n25:        ) {\n\n33:     function batchMigrateProfiles(uint256[] calldata profileIds) external {\n\n37:     function batchMigrateFollows(\n38:            uint256[] calldata followerProfileIds,\n39:            uint256[] calldata idsOfProfileFollowed,\n40:            uint256[] calldata followTokenIds\n41:        ) external {\n\n45:     function batchMigrateFollowModules(uint256[] calldata profileIds) external {\n\n```\n\n[19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L19), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L33), [37](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L37), [45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L45),\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n20:     constructor(\n21:            address proxyAdminAddress,\n22:            address governanceAddress,\n23:            address owner,\n24:            address lensHub,\n25:            address newImplementationAddress,\n26:            address[] memory oldFollowModulesToUnwhitelist_,\n27:            address[] memory newFollowModulesToWhitelist_,\n28:            address[] memory oldReferenceModulesToUnwhitelist_,\n29:            address[] memory newReferenceModulesToWhitelist_,\n30:            address[] memory oldCollectModulesToUnwhitelist_,\n31:            address[] memory newActionModulesToWhitelist_\n32:        ) ImmutableOwnable(owner, lensHub) {\n\n44:     function executeLensV2Upgrade() external onlyOwner {\n\n50:     function _upgrade() internal {\n\n64:     function _unwhitelistOldFollowModules() internal {\n\n75:     function _unwhitelistOldReferenceModules() internal {\n\n86:     function _unwhitelistOldCollectModules() internal {\n\n97:     function _whitelistNewFollowModules() internal {\n\n108:     function _whitelistNewReferenceModules() internal {\n\n119:     function _whitelistNewActionModules() internal {\n\n```\n\n[20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L20), [44](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L44), [50](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L50), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L64), [75](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L75), [86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L86), [97](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L97), [108](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L108), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L119),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n69:     /// @inheritdoc IModuleGlobals\n70:        function isCurrencyWhitelisted(address currency) external view override returns (bool) {\n\n74:     /// @inheritdoc IModuleGlobals\n75:        function getGovernance() external view override returns (address) {\n\n79:     /// @inheritdoc IModuleGlobals\n80:        function getTreasury() external view override returns (address) {\n\n84:     /// @inheritdoc IModuleGlobals\n85:        function getTreasuryFee() external view override returns (uint16) {\n\n90:     function getTreasuryData() external view override returns (address, uint16) {\n\n94:     function _setGovernance(address newGovernance) internal {\n\n101:     function _setTreasury(address newTreasury) internal {\n\n108:     function _setTreasuryFee(uint16 newTreasuryFee) internal {\n\n115:     function _whitelistCurrency(address currency, bool toWhitelist) internal {\n\n```\n\n[69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L69), [74](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L74), [79](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L79), [84](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L84), [90](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L90), [94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L94), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L101), [108](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L108), [115](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L115),\n\n```solidity\nFile: contracts/misc/ProfileCreationProxy.sol\n\n23:     constructor(\n24:            address owner,\n25:            address hub,\n26:            address lensHandles,\n27:            address tokenHandleRegistry\n28:        ) ImmutableOwnable(owner, hub) {\n\n33:     function proxyCreateProfile(Types.CreateProfileParams calldata createProfileParams)\n34:            external\n35:            onlyOwner\n36:            returns (uint256)\n37:        {\n\n41:     function proxyCreateProfileWithHandle(Types.CreateProfileParams memory createProfileParams, string calldata handle)\n42:            external\n43:            onlyOwner\n44:            returns (uint256, uint256)\n45:        {\n\n64:     function proxyCreateHandle(address to, string calldata handle) external onlyOwner returns (uint256) {\n\n```\n\n[23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L23), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L33), [41](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L41), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L64),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n21:     constructor(address owner) Ownable() {\n\n25:     function clearControllerContract() external onlyOwnerOrControllerContract {\n\n30:     function setControllerContract(address newControllerContract) external onlyOwner {\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L21), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L25), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L30),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n9:     function whitelistCollectModule(address collectModule, bool whitelist) external;\n\n15:     constructor(address lensHubAddress_, address governanceOwner_) ControllableByContract(governanceOwner_) {\n\n27:     function lensHub_setEmergencyAdmin(address newEmergencyAdmin) external onlyOwner {\n\n42:     function lensHub_whitelistFollowModule(address followModule, bool whitelist)\n43:            external\n44:            onlyOwnerOrControllerContract\n45:        {\n\n49:     function lensHub_whitelistReferenceModule(address referenceModule, bool whitelist)\n50:            external\n51:            onlyOwnerOrControllerContract\n52:        {\n\n56:     function lensHub_whitelistActionModule(address actionModule, bool whitelist)\n57:            external\n58:            onlyOwnerOrControllerContract\n59:        {\n\n64:     function lensHub_whitelistCollectModule(address collectModule, bool whitelist)\n65:            external\n66:            onlyOwnerOrControllerContract\n67:        {\n\n73:     function executeAsGovernance(address target, bytes calldata data)\n74:            external\n75:            payable\n76:            onlyOwnerOrControllerContract\n77:            returns (bytes memory)\n78:        {\n\n```\n\n[9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L9), [15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L15), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L27), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L42), [49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L49), [56](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L56), [64](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L64), [73](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L73),\n\n```solidity\nFile: contracts/misc/access/ProxyAdmin.sol\n\n12:     constructor(\n13:            address lensHubAddress_,\n14:            address previousImplementation_,\n15:            address proxyAdminOwner_\n16:        ) ControllableByContract(proxyAdminOwner_) {\n\n21:     function currentImplementation() external returns (address) {\n\n33:     function proxy_changeAdmin(address newAdmin) external onlyOwner {\n\n47:     function proxy_upgradeAndCall(address newImplementation, bytes calldata data)\n48:            external\n49:            onlyOwnerOrControllerContract\n50:        {\n\n```\n\n[12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L12), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L21), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L33), [47](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L47),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n62:     constructor(\n63:            address owner,\n64:            address lensHub,\n65:            uint256 tokenGuardianCooldown\n66:        ) ERC721('', '') ImmutableOwnable(owner, lensHub) {\n\n70:     function name() public pure override returns (string memory) {\n\n74:     function symbol() public pure override returns (string memory) {\n\n78:     /**\n79:         * @dev See {IERC721Metadata-tokenURI}.\n80:         */\n81:        function tokenURI(uint256 tokenId) public view override returns (string memory) {\n\n86:     /// @inheritdoc ILensHandles\n87:        function mintHandle(address to, string calldata localName)\n88:            external\n89:            onlyOwnerOrWhitelistedProfileCreator\n90:            returns (uint256)\n91:        {\n\n96:     function migrateHandle(address to, string calldata localName) external onlyHub returns (uint256) {\n\n101:     function burn(uint256 tokenId) external {\n\n126:     function enableTokenGuardian() external onlyEOA {\n\n139:     function approve(address to, uint256 tokenId) public override(IERC721, ERC721) {\n\n147:     function setApprovalForAll(address operator, bool approved) public override(IERC721, ERC721) {\n\n155:     function exists(uint256 tokenId) external view returns (bool) {\n\n159:     function getNamespace() external pure returns (string memory) {\n\n163:     function getNamespaceHash() external pure returns (bytes32) {\n\n168:     function getLocalName(uint256 tokenId) public view returns (string memory) {\n\n177:     function getHandle(uint256 tokenId) public view returns (string memory) {\n\n182:     function getTokenId(string memory localName) public pure returns (uint256) {\n\n186:     function getTokenGuardianDisablingTimestamp(address wallet) external view returns (uint256) {\n\n191:     ///        INTERNAL FUNCTIONS      ///\n192:         //////////////////////////////////////\n193:     \n194:         function _mintHandle(address to, string calldata localName) internal returns (uint256) {\n\n202:     function _validateLocalNameMigration(string memory localName) internal view {\n\n226:     function _validateLocalName(string memory localName) internal view {\n\n249:     function _isAlphaNumeric(bytes1 char) internal pure returns (bool) {\n\n253:     function _hasTokenGuardianEnabled(address wallet) internal view returns (bool) {\n\n260:     function _beforeTokenTransfer(\n261:             address from,\n262:             address to,\n263:             uint256 /* firstTokenId */,\n264:             uint256 batchSize\n265:         ) internal override {\n\n```\n\n[62](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L62), [70](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L70), [74](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L74), [78](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L78), [86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L86), [96](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L96), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L101), [126](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L126), [139](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L139), [147](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L147), [155](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L155), [159](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L159), [163](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L163), [168](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L168), [177](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L177), [182](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L182), [186](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L186), [191](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L191), [202](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L202), [226](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L226), [249](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L249), [253](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L253), [260](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L260),\n\n```solidity\nFile: contracts/namespaces/TokenHandleRegistry.sol\n\n42:     constructor(address lensHub, address lensHandles) {\n\n50:     function migrationLink(uint256 handleId, uint256 tokenId) external {\n\n93:     /// @inheritdoc ITokenHandleRegistry\n94:        function resolve(uint256 handleId) external view returns (uint256) {\n\n106:     /// @inheritdoc ITokenHandleRegistry\n107:         function getDefaultHandle(uint256 tokenId) external view returns (uint256) {\n\n119:     ///        INTERNAL FUNCTIONS      ///\n120:         //////////////////////////////////////\n121:     \n122:         function _resolveHandleToToken(\n123:             RegistryTypes.Handle memory handle\n124:         ) internal view returns (RegistryTypes.Token storage) {\n\n128:     function _resolveTokenToHandle(\n129:             RegistryTypes.Token memory token\n130:         ) internal view returns (RegistryTypes.Handle storage) {\n\n134:     function _link(RegistryTypes.Handle memory handle, RegistryTypes.Token memory token) internal {\n\n144:     function _deleteTokenToHandleLinkageIfAny(RegistryTypes.Handle memory handle) internal {\n\n152:     function _deleteHandleToTokenLinkageIfAny(RegistryTypes.Token memory token) internal {\n\n160:     function _unlink(RegistryTypes.Handle memory handle, RegistryTypes.Token memory token) internal {\n\n167:     function _handleHash(RegistryTypes.Handle memory handle) internal pure returns (bytes32) {\n\n171:     function _tokenHash(RegistryTypes.Token memory token) internal pure returns (bytes32) {\n\n```\n\n[42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L42), [50](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L50), [93](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L93), [106](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L106), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L119), [128](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L128), [134](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L134), [144](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L144), [152](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L152), [160](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L160), [167](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L167), [171](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L171),\n\n```solidity\nFile: contracts/interfaces/ICollectNFT.sol\n\n34:     /**\n\n```\n\n[34](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ICollectNFT.sol#L34),\n\n```solidity\nFile: contracts/interfaces/ILegacyCollectNFT.sol\n\n40:     /**\n\n```\n\n[40](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyCollectNFT.sol#L40),\n\n```solidity\nFile: contracts/interfaces/ILensProtocol.sol\n\n15:     /**\n\n143:     /**\n\n165:     /**\n\n186:     /**\n\n209:     /**\n\n237:     /**\n\n308:     /**\n\n328:     /**\n\n```\n\n[15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L15), [143](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L143), [165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L165), [186](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L186), [209](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L209), [237](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L237), [308](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L308), [328](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensProtocol.sol#L328),\n\n```solidity\nFile: contracts/interfaces/IModuleGlobals.sol\n\n85:     /**\n\n```\n\n[85](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L85),\n\n</details>\n\n### <a name=\"N-31\"></a>[N-31] Non-external function names (`private` or `internal`.) should begin with an underscore\nAccording to the Solidity Style Guide, Non-external variable and function names should begin0 with an[underscore](https://docs.soliditylang.org/en/latest/style-guide.html#underscore-prefix-for-non-external-functions-and-variables)\n\n*Instances (39)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n450:     function calculateDomainSeparator() internal view returns (bytes32) {\n\n```\n\n[450](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L450),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n16:     function ownerOf(uint256 profileId) internal view returns (address) {\n\n24:     function exists(uint256 profileId) internal view returns (bool) {\n\n```\n\n[16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L16), [24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L24),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n170:     function getPublicationType(uint256 profileId, uint256 pubId) internal view returns (Types.PublicationType) {\n\n```\n\n[170](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L170),\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n49:     function getPublication(uint256 profileId, uint256 pubId)\n\n63:     function getProfile(uint256 profileId) internal pure returns (Types.Profile storage _profiles) {\n\n71:     function getDelegatedExecutorsConfig(uint256 delegatorProfileId)\n\n83:     function tokenGuardianDisablingTimestamp()\n\n93:     function getTokenData(uint256 tokenId) internal pure returns (Types.TokenData storage _tokenData) {\n\n101:     function blockedStatus(uint256 blockerProfileId)\n\n113:     function nonces() internal pure returns (mapping(address => uint256) storage _nonces) {\n\n119:     function profileIdByHandleHash()\n\n129:     function profileCreatorWhitelisted()\n\n139:     function followModuleWhitelisted()\n\n149:     function actionModuleWhitelistData()\n\n159:     function actionModuleById() internal pure returns (mapping(uint256 => address) storage _actionModules) {\n\n165:     function incrementMaxActionModuleIdUsed() internal returns (uint256) {\n\n177:     function referenceModuleWhitelisted()\n\n187:     function getGovernance() internal view returns (address _governance) {\n\n193:     function setGovernance(address newGovernance) internal {\n\n199:     function getEmergencyAdmin() internal view returns (address _emergencyAdmin) {\n\n205:     function setEmergencyAdmin(address newEmergencyAdmin) internal {\n\n211:     function getState() internal view returns (Types.ProtocolState _state) {\n\n217:     function setState(Types.ProtocolState newState) internal {\n\n223:     function getLastInitializedRevision() internal view returns (uint256 _lastInitializedRevision) {\n\n229:     function setLastInitializedRevision(uint256 newLastInitializedRevision) internal {\n\n```\n\n[49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L49), [63](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L63), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L71), [83](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L83), [93](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L93), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L101), [113](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L113), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L119), [129](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L129), [139](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L139), [149](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L149), [159](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L159), [165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L165), [177](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L177), [187](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L187), [193](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L193), [199](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L199), [205](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L205), [211](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L211), [217](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L217), [223](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L223), [229](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L229),\n\n```solidity\nFile: contracts/libraries/ValidationLib.sol\n\n16:     function validatePointedPub(uint256 profileId, uint256 pubId) internal view {\n\n24:     function validateAddressIsProfileOwner(address expectedProfileOwner, uint256 profileId) internal view {\n\n30:     function validateAddressIsProfileOwnerOrDelegatedExecutor(\n\n42:     function validateAddressIsDelegatedExecutor(address expectedDelegatedExecutor, uint256 delegatorProfileId)\n\n51:     function validateReferenceModuleWhitelisted(address referenceModule) internal view {\n\n57:     function validateFollowModuleWhitelisted(address followModule) internal view {\n\n63:     function validateProfileCreatorWhitelisted(address profileCreator) internal view {\n\n69:     function validateNotBlocked(uint256 profile, uint256 byProfile) internal view {\n\n75:     function validateProfileExists(uint256 profileId) internal view {\n\n81:     function validateCallerIsGovernance() internal view {\n\n87:     function validateReferrersAndGetReferrersPubTypes(\n\n```\n\n[16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L16), [24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L24), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L30), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L42), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L51), [57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L57), [63](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L63), [69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L69), [75](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L75), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L81), [87](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L87),\n\n```solidity\nFile: contracts/base/HubRestricted.sol\n\n24:     constructor(address hub) {\n\n```\n\n[24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/HubRestricted.sol#L24),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n33:     constructor(address moduleGlobals, uint256 tokenGuardianCooldown) {\n\n```\n\n[33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L33),\n\n</details>\n\n### <a name=\"N-32\"></a>[N-32] Non-external variable (`private` or `internal`.) should begin with an underscore\nAccording to the Solidity Style Guide, Non-external variable and function names should begin0 with an[underscore](https://docs.soliditylang.org/en/latest/style-guide.html#underscore-prefix-for-non-external-functions-and-variables)\n\n*Instances (17)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/base/LensImplGetters.sol\n\n8:     address internal immutable FOLLOW_NFT_IMPL;\n\n```\n\n[8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensImplGetters.sol#L8),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n29:     IModuleGlobals immutable MODULE_GLOBALS;\n\n31:     uint256 internal immutable TOKEN_GUARDIAN_COOLDOWN;\n\n```\n\n[29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L29), [31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L31),\n\n```solidity\nFile: contracts/base/upgradeability/FollowNFTProxy.sol\n\n11:     address immutable HUB;\n\n```\n\n[11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L11),\n\n```solidity\nFile: contracts/misc/LensV2Migration.sol\n\n12:     address internal immutable FEE_FOLLOW_MODULE;\n\n13:     address internal immutable PROFILE_FOLLOW_MODULE;\n\n14:     address internal immutable NEW_FEE_FOLLOW_MODULE;\n\n16:     LensHandles internal immutable lensHandles;\n\n17:     TokenHandleRegistry internal immutable tokenHandleRegistry;\n\n```\n\n[12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L12), [13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L13), [14](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L14), [16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L16), [17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L17),\n\n```solidity\nFile: contracts/misc/ProfileCreationProxy.sol\n\n20:     ILensHandles immutable LENS_HANDLES;\n\n21:     ITokenHandleRegistry immutable TOKEN_HANDLE_REGISTRY;\n\n```\n\n[20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L20), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L21),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n30:     uint256 internal immutable NAMESPACE_LENGTH = bytes(NAMESPACE).length;\n\n33:     uint256 internal immutable TOKEN_GUARDIAN_COOLDOWN;\n\n```\n\n[30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L30), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L33),\n\n```solidity\nFile: contracts/namespaces/TokenHandleRegistry.sol\n\n21:     address immutable LENS_HUB;\n\n22:     address immutable LENS_HANDLES;\n\n25:     mapping(bytes32 handle => RegistryTypes.Token token) handleToToken;\n\n26:     mapping(bytes32 token => RegistryTypes.Handle handle) tokenToHandle;\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L21), [22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L22), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L25), [26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L26),\n\n</details>\n\n### <a name=\"N-33\"></a>[N-33] Not using the named return variables anywhere in the function is confusing\nConsider changing the variable to be an unnamed one, since the variable is never assigned, nor is it returned by name\n\n*Instances (19)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n203:     function _asReferencePubParams(Types.QuoteParams calldata quoteParams)\n204:             private\n205:             pure\n206:             returns (Types.ReferencePubParams calldata referencePubParams)\n207:         {\n\n214:     function _asReferencePubParams(Types.CommentParams calldata commentParams)\n215:             private\n216:             pure\n217:             returns (Types.ReferencePubParams calldata referencePubParams)\n218:         {\n\n```\n\n[203](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L203), [214](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L214),\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n49:     function getPublication(uint256 profileId, uint256 pubId)\n50:            internal\n51:            pure\n52:            returns (Types.Publication storage _publication)\n53:        {\n\n63:     function getProfile(uint256 profileId) internal pure returns (Types.Profile storage _profiles) {\n\n71:     function getDelegatedExecutorsConfig(uint256 delegatorProfileId)\n72:            internal\n73:            pure\n74:            returns (Types.DelegatedExecutorsConfig storage _delegatedExecutorsConfig)\n75:        {\n\n83:     function tokenGuardianDisablingTimestamp()\n84:            internal\n85:            pure\n86:            returns (mapping(address => uint256) storage _tokenGuardianDisablingTimestamp)\n87:        {\n\n93:     function getTokenData(uint256 tokenId) internal pure returns (Types.TokenData storage _tokenData) {\n\n101:     function blockedStatus(uint256 blockerProfileId)\n102:             internal\n103:             pure\n104:             returns (mapping(uint256 => bool) storage _blockedStatus)\n105:         {\n\n113:     function nonces() internal pure returns (mapping(address => uint256) storage _nonces) {\n\n119:     function profileIdByHandleHash()\n120:             internal\n121:             pure\n122:             returns (mapping(bytes32 => uint256) storage _profileIdByHandleHash)\n123:         {\n\n129:     function profileCreatorWhitelisted()\n130:             internal\n131:             pure\n132:             returns (mapping(address => bool) storage _profileCreatorWhitelisted)\n133:         {\n\n139:     function followModuleWhitelisted()\n140:             internal\n141:             pure\n142:             returns (mapping(address => bool) storage _followModuleWhitelisted)\n143:         {\n\n149:     function actionModuleWhitelistData()\n150:             internal\n151:             pure\n152:             returns (mapping(address => Types.ActionModuleWhitelistData) storage _actionModuleWhitelistData)\n153:         {\n\n159:     function actionModuleById() internal pure returns (mapping(uint256 => address) storage _actionModules) {\n\n177:     function referenceModuleWhitelisted()\n178:             internal\n179:             pure\n180:             returns (mapping(address => bool) storage _referenceModuleWhitelisted)\n181:         {\n\n187:     function getGovernance() internal view returns (address _governance) {\n\n199:     function getEmergencyAdmin() internal view returns (address _emergencyAdmin) {\n\n211:     function getState() internal view returns (Types.ProtocolState _state) {\n\n223:     function getLastInitializedRevision() internal view returns (uint256 _lastInitializedRevision) {\n\n```\n\n[49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L49), [63](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L63), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L71), [83](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L83), [93](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L93), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L101), [113](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L113), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L119), [129](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L129), [139](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L139), [149](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L149), [159](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L159), [177](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L177), [187](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L187), [199](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L199), [211](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L211), [223](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L223),\n\n</details>\n\n### <a name=\"N-34\"></a>[N-34] Overly complicated arithmetic\nTo maintain readability in code, particularly in Solidity which can involve complex mathematical operations, it is often recommended to limit the number of arithmetic operations to a maximum of 2-3 per line. Too many operations in a single line can make the code difficult to read and understand, increase the likelihood of mistakes, and complicate the process of debugging and reviewing the code. Consider splitting such operations over more than one line, take special care when dealing with division however. Try to limit the number of arithmetic operations to a maximum of 3 per line.\n\n*Instances (8)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n450:         uint256 /* followTokenId */\n\n456:         uint256 /* royaltiesInBasisPoints */\n\n```\n\n[450](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L450), [456](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L456),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n52:         uint256, /* tokenId */\n\n```\n\n[52](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L52),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n154:         uint256 /* tokenId */\n\n160:         uint256 /* royaltiesInBasisPoints */\n\n```\n\n[154](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L154), [160](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L160),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n103:         uint256 /* tokenId */\n\n109:         uint256 /* royaltiesInBasisPoints */\n\n```\n\n[103](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L103), [109](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L109),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n263:         uint256 /* firstTokenId */,\n\n```\n\n[263](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L263),\n\n</details>\n\n### <a name=\"N-35\"></a>[N-35] Public functions not called internally\nThose functions should be declared as `external` instead of `public`, as they are never called internally by the contract. Contracts are allowed to override their parents' functions and change the visibility from `external` to `public`.\n\n*Instances (2)*:\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n17:     function supportsInterface(bytes4 interfaceId) public view virtual returns (bool) {\n\n```\n\n[17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L17),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n177:     function getHandle(uint256 tokenId) public view returns (string memory) {\n\n```\n\n[177](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L177),\n\n### <a name=\"N-36\"></a>[N-36] `require()` / `revert()` statements should have descriptive reason strings\n\n*Instances (115)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/LensHub.sol\n\n61:             revert Errors.PublishingPaused();\n\n```\n\n[61](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L61),\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n51:             revert Errors.Initialized();\n\n143:             revert Errors.TokenDoesNotExist();\n\n158:             revert Errors.InvalidParameter();\n\n287:             revert Errors.TokenDoesNotExist();\n\n459:             revert Errors.NotProfileOwner();\n\n492:             revert Errors.InvalidParameter();\n\n```\n\n[51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L51), [143](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L143), [158](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L158), [287](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L287), [459](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L459), [492](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L492),\n\n```solidity\nFile: contracts/libraries/ActionLib.sol\n\n37:             revert Errors.ActionNotAllowed();\n\n```\n\n[37](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L37),\n\n```solidity\nFile: contracts/libraries/FollowLib.sol\n\n26:             revert Errors.ArrayMismatch();\n\n36:                 revert Errors.SelfFollow();\n\n67:                 revert Errors.NotFollowing();\n\n```\n\n[26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L26), [36](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L36), [67](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L67),\n\n```solidity\nFile: contracts/libraries/GovernanceLib.sol\n\n59:             revert Errors.NotGovernanceOrEmergencyAdmin();\n\n56:                 revert Errors.EmergencyAdminCanOnlyPauseFurther();\n\n95:                 revert Errors.NotWhitelisted();\n\n```\n\n[59](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L59), [56](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L56), [95](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L95),\n\n```solidity\nFile: contracts/libraries/LegacyCollectLib.sol\n\n68:                 revert Errors.CollectNotAllowed();\n\n```\n\n[68](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L68),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n470:         if (signature.deadline < block.timestamp) revert Errors.SignatureExpired();\n\n480:                 revert Errors.SignatureInvalid();\n\n475:                 revert Errors.SignatureInvalid();\n\n```\n\n[470](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L470), [480](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L480), [475](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L475),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n103:             revert Errors.ArrayMismatch();\n\n```\n\n[103](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L103),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n19:             revert Errors.TokenDoesNotExist();\n\n41:             revert Errors.ProfileImageURILengthInvalid();\n\n122:             revert Errors.ProfileImageURILengthInvalid();\n\n134:             revert Errors.ArrayMismatch();\n\n145:                 revert Errors.SelfBlock();\n\n231:             revert Errors.ArrayMismatch();\n\n262:             revert Errors.InvalidParameter();\n\n```\n\n[19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L19), [41](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L41), [122](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L122), [134](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L134), [145](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L145), [231](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L231), [262](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L262),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n360:                 revert Errors.InvalidReferrer();\n\n348:                     revert Errors.InvalidReferrer();\n\n413:                 revert Errors.InvalidReferrer();\n\n401:                     revert Errors.InvalidReferrer();\n\n466:                 revert Errors.InvalidReferrer();\n\n454:                     revert Errors.InvalidReferrer();\n\n480:             revert Errors.ArrayMismatch();\n\n493:                 revert Errors.NotWhitelisted();\n\n499:                 revert Errors.AlreadyEnabled();\n\n```\n\n[360](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L360), [348](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L348), [413](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L413), [401](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L401), [466](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L466), [454](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L454), [480](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L480), [493](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L493), [499](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L499),\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n172:             revert Errors.MaxActionModuleIdReached();\n\n```\n\n[172](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L172),\n\n```solidity\nFile: contracts/libraries/ValidationLib.sol\n\n20:             revert Errors.InvalidPointedPub();\n\n26:             revert Errors.NotProfileOwner();\n\n47:             revert Errors.ExecutorInvalid();\n\n53:             revert Errors.NotWhitelisted();\n\n59:             revert Errors.NotWhitelisted();\n\n65:             revert Errors.NotWhitelisted();\n\n71:             revert Errors.Blocked();\n\n77:             revert Errors.TokenDoesNotExist();\n\n83:             revert Errors.NotGovernance();\n\n94:             revert Errors.ArrayMismatch();\n\n131:             revert Errors.InvalidReferrer();\n\n139:             revert Errors.InvalidReferrer();\n\n161:                 revert Errors.InvalidReferrer();\n\n165:                 revert Errors.InvalidReferrer();\n\n152:                 revert Errors.InvalidReferrer();\n\n191:             revert Errors.InvalidReferrer();\n\n226:                     revert Errors.InvalidReferrer();\n\n```\n\n[20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L20), [26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L26), [47](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L47), [53](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L53), [59](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L59), [65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L65), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L71), [77](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L77), [83](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L83), [94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L94), [131](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L131), [139](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L139), [161](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L161), [165](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L165), [152](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L152), [191](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L191), [226](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L226),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n45:             revert Errors.InvalidParameter();\n\n```\n\n[45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L45),\n\n```solidity\nFile: contracts/base/HubRestricted.sol\n\n19:             revert Errors.NotHub();\n\n```\n\n[19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/HubRestricted.sol#L19),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n108:             revert Errors.InvalidParameter();\n\n119:             revert Errors.TokenDoesNotExist();\n\n130:             revert Errors.TokenDoesNotExist();\n\n140:             revert Errors.TokenDoesNotExist();\n\n176:             revert Errors.InvalidParameter();\n\n180:             revert Errors.NotOwnerOrApproved();\n\n191:             revert Errors.TokenDoesNotExist();\n\n202:             revert Errors.InvalidParameter();\n\n225:             revert Errors.NotOwnerOrApproved();\n\n252:             revert Errors.NotOwnerOrApproved();\n\n266:             revert Errors.NotOwnerOrApproved();\n\n310:             revert Errors.NonERC721ReceiverImplementer();\n\n335:             revert Errors.TokenDoesNotExist();\n\n355:             revert Errors.InvalidParameter();\n\n414:             revert Errors.InvalidOwner();\n\n417:             revert Errors.InvalidParameter();\n\n480:                     revert Errors.NonERC721ReceiverImplementer();\n\n```\n\n[108](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L108), [119](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L119), [130](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L130), [140](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L140), [176](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L176), [180](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L180), [191](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L191), [202](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L202), [225](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L225), [252](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L252), [266](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L266), [310](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L310), [335](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L335), [355](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L355), [414](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L414), [417](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L417), [480](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L480),\n\n```solidity\nFile: contracts/base/LensHubEventHooks.sol\n\n15:             revert Errors.CallerNotFollowNFT();\n\n34:             revert Errors.CallerNotCollectNFT();\n\n```\n\n[15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubEventHooks.sol#L15), [34](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubEventHooks.sol#L34),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n40:             revert Errors.Paused();\n\n52:             revert Errors.NotEOA();\n\n65:             revert Errors.DisablingAlreadyTriggered();\n\n79:             revert Errors.AlreadyEnabled();\n\n107:             revert Errors.TokenDoesNotExist();\n\n115:             revert Errors.GuardianEnabled();\n\n123:             revert Errors.GuardianEnabled();\n\n172:             revert Errors.GuardianEnabled();\n\n```\n\n[40](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L40), [52](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L52), [65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L65), [79](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L79), [107](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L107), [115](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L115), [123](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L123), [172](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L172),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n39:         if (hub == address(0)) revert Errors.InitParamsInvalid();\n\n46:         if (_initialized) revert Errors.Initialized();\n\n56:         if (msg.sender != HUB) revert Errors.NotHub();\n\n70:         if (!_exists(tokenId)) revert Errors.TokenDoesNotExist();\n\n112:             revert Errors.NotProfileOwner();\n\n```\n\n[39](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L39), [46](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L46), [56](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L56), [70](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L70), [112](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L112),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n28:         if (msg.sender != _governance) revert Errors.NotGovernance();\n\n95:         if (newGovernance == address(0)) revert Errors.InitParamsInvalid();\n\n102:         if (newTreasury == address(0)) revert Errors.InitParamsInvalid();\n\n109:         if (newTreasuryFee >= BPS_MAX / 2) revert Errors.InitParamsInvalid();\n\n116:         if (currency == address(0)) revert Errors.InitParamsInvalid();\n\n```\n\n[28](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L28), [95](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L95), [102](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L102), [109](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L109), [116](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L116),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n43:             revert HandlesErrors.NotOwnerNorWhitelisted();\n\n50:             revert HandlesErrors.NotEOA();\n\n57:             revert HandlesErrors.NotHub();\n\n103:             revert HandlesErrors.NotOwner();\n\n115:             revert HandlesErrors.DisablingAlreadyTriggered();\n\n128:             revert HandlesErrors.AlreadyEnabled();\n\n142:             revert HandlesErrors.GuardianEnabled();\n\n150:             revert HandlesErrors.GuardianEnabled();\n\n171:             revert HandlesErrors.DoesNotExist();\n\n207:             revert HandlesErrors.HandleLengthInvalid();\n\n212:             revert HandlesErrors.HandleFirstCharInvalid();\n\n218:                 revert HandlesErrors.HandleContainsInvalidCharacters();\n\n231:             revert HandlesErrors.HandleLengthInvalid();\n\n235:             revert HandlesErrors.HandleFirstCharInvalid();\n\n241:                 revert HandlesErrors.HandleContainsInvalidCharacters();\n\n268:             revert HandlesErrors.GuardianEnabled();\n\n```\n\n[43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L43), [50](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L50), [57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L57), [103](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L103), [115](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L115), [128](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L128), [142](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L142), [150](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L150), [171](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L171), [207](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L207), [212](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L212), [218](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L218), [231](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L231), [235](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L235), [241](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L241), [268](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L268),\n\n```solidity\nFile: contracts/namespaces/TokenHandleRegistry.sol\n\n30:             revert RegistryErrors.NotHandleOwner();\n\n37:             revert RegistryErrors.NotTokenOwner();\n\n52:             revert RegistryErrors.OnlyLensHub();\n\n80:             revert RegistryErrors.NotHandleNorTokenOwner();\n\n88:             revert RegistryErrors.NotLinked();\n\n96:             revert RegistryErrors.DoesNotExist();\n\n109:             revert RegistryErrors.DoesNotExist();\n\n```\n\n[30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L30), [37](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L37), [52](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L52), [80](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L80), [88](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L88), [96](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L96), [109](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L109),\n\n</details>\n\n### <a name=\"N-37\"></a>[N-37] Return values of `approve()` not checked\nNot all IERC20 implementations `revert()` when there's a failure in `approve()`. The function signature has a boolean return value and they indicate errors that way instead. By not checking the return value, operations that should have marked as failed, may potentially go through without actually approving anything\n\n*Instances (3)*:\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n183:         _approve(to, tokenId);\n\n```\n\n[183](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L183),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n117:         super.approve(to, tokenId);\n\n```\n\n[117](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L117),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n144:         super.approve(to, tokenId);\n\n```\n\n[144](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L144),\n\n### <a name=\"N-38\"></a>[N-38] Strings should use double quotes rather than single quotes\nSee the Solidity Style [Guide](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#other-recommendations)\n\n*Instances (45)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n21:     string constant FOLLOW_NFT_NAME_SUFFIX = '-Follower';\n\n22:     string constant FOLLOW_NFT_SYMBOL_SUFFIX = '-Fl';\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L21), [22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L22),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n21:     string constant EIP712_DOMAIN_VERSION = '2';\n\n493:         return keccak256(abi.encodePacked('\\x19\\x01', calculateDomainSeparator(), hashedMessage));\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L21), [493](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L493),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n134:                 followModuleData: '',\n\n135:                 processFollowModuleReturnData: '',\n\n```\n\n[134](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L134), [135](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L135),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n363:         return '';\n\n416:         return '';\n\n469:         return '';\n\n```\n\n[363](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L363), [416](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L416), [469](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L469),\n\n```solidity\nFile: contracts/libraries/constants/Typehash.sol\n\n7:     bytes32 constant ACT = keccak256('Act(uint256 publicationActedProfileId,uint256 publicationActedId,uint256 actorProfileId,uint256[] referrerProfileIds,uint256[] referrerPubIds,address actionModuleAddress,bytes actionModuleData,uint256 nonce,uint256 deadline)');\n\n9:     bytes32 constant BURN = keccak256('Burn(uint256 tokenId,uint256 nonce,uint256 deadline)');\n\n11:     bytes32 constant CHANGE_DELEGATED_EXECUTORS_CONFIG = keccak256('ChangeDelegatedExecutorsConfig(uint256 delegatorProfileId,address[] delegatedExecutors,bool[] approvals,uint64 configNumber,bool switchToGivenConfig,uint256 nonce,uint256 deadline)');\n\n13:     bytes32 constant LEGACY_COLLECT = keccak256('Collect(uint256 publicationCollectedProfileId,uint256 publicationCollectedId,uint256 collectorProfileId,uint256 referrerProfileId,uint256 referrerPubId,bytes collectModuleData,uint256 nonce,uint256 deadline)');\n\n15:     bytes32 constant COMMENT = keccak256('Comment(uint256 profileId,string contentURI,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileIds,uint256[] referrerPubIds,bytes referenceModuleData,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n17:     bytes32 constant EIP712_DOMAIN = keccak256('EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)');\n\n19:     bytes32 constant FOLLOW = keccak256('Follow(uint256 followerProfileId,uint256[] idsOfProfilesToFollow,uint256[] followTokenIds,bytes[] datas,uint256 nonce,uint256 deadline)');\n\n21:     bytes32 constant MIRROR = keccak256('Mirror(uint256 profileId,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileId,uint256[] referrerPubId,bytes referenceModuleData,uint256 nonce,uint256 deadline)');\n\n23:     bytes32 constant POST = keccak256('Post(uint256 profileId,string contentURI,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n25:     bytes32 constant QUOTE = keccak256('Quote(uint256 profileId,string contentURI,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileIds,uint256[] referrerPubIds,bytes referenceModuleData,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n27:     bytes32 constant SET_BLOCK_STATUS = keccak256('SetBlockStatus(uint256 byProfileId,uint256[] idsOfProfilesToSetBlockStatus,bool[] blockStatus,uint256 nonce,uint256 deadline)');\n\n29:     bytes32 constant SET_FOLLOW_MODULE = keccak256('SetFollowModule(uint256 profileId,address followModule,bytes followModuleInitData,uint256 nonce,uint256 deadline)');\n\n31:     bytes32 constant SET_PROFILE_IMAGE_URI = keccak256('SetProfileImageURI(uint256 profileId,string imageURI,uint256 nonce,uint256 deadline)');\n\n33:     bytes32 constant SET_PROFILE_METADATA_URI = keccak256('SetProfileMetadataURI(uint256 profileId,string metadata,uint256 nonce,uint256 deadline)');\n\n35:     bytes32 constant UNFOLLOW = keccak256('Unfollow(uint256 unfollowerProfileId,uint256[] idsOfProfilesToUnfollow,uint256 nonce,uint256 deadline)');\n\n```\n\n[7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L7), [9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L9), [11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L11), [13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L13), [15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L15), [17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L17), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L19), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L21), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L23), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L25), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L27), [29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L29), [31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L31), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L33), [35](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L35),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n239:         safeTransferFrom(from, to, tokenId, '');\n\n```\n\n[239](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L239),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n78:         return string.concat('Lens Collect | Profile #', _profileId.toString(), ' - Publication #', _pubId.toString());\n\n78:         return string.concat('Lens Collect | Profile #', _profileId.toString(), ' - Publication #', _pubId.toString());\n\n85:         return 'LENS-COLLECT';\n\n```\n\n[78](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L78), [78](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L78), [85](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L85),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n29:     string internal constant NAMESPACE = 'lens';\n\n31:     uint256 internal constant SEPARATOR_LENGTH = 1; // bytes('.').length;\n\n66:     ) ERC721('', '') ImmutableOwnable(owner, lensHub) {\n\n66:     ) ERC721('', '') ImmutableOwnable(owner, lensHub) {\n\n71:         return string.concat(symbol(), ' Handles');\n\n75:         return string.concat('.', NAMESPACE);\n\n179:         return string.concat(localName, '.', NAMESPACE);\n\n211:         if (firstByte == '-' || firstByte == '_') {\n\n211:         if (firstByte == '-' || firstByte == '_') {\n\n217:             if (!_isAlphaNumeric(localNameAsBytes[i]) && localNameAsBytes[i] != '-' && localNameAsBytes[i] != '_') {\n\n217:             if (!_isAlphaNumeric(localNameAsBytes[i]) && localNameAsBytes[i] != '-' && localNameAsBytes[i] != '_') {\n\n234:         if (localNameAsBytes[0] == '_') {\n\n240:             if (!_isAlphaNumeric(localNameAsBytes[i]) && localNameAsBytes[i] != '_') {\n\n250:         return (char >= '0' && char <= '9') || (char >= 'a' && char <= 'z');\n\n250:         return (char >= '0' && char <= '9') || (char >= 'a' && char <= 'z');\n\n250:         return (char >= '0' && char <= '9') || (char >= 'a' && char <= 'z');\n\n250:         return (char >= '0' && char <= '9') || (char >= 'a' && char <= 'z');\n\n```\n\n[29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L29), [31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L31), [66](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L66), [66](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L66), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L71), [75](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L75), [179](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L179), [211](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L211), [211](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L211), [217](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L217), [217](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L217), [234](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L234), [240](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L240), [250](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L250), [250](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L250), [250](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L250), [250](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L250),\n\n</details>\n\n### <a name=\"N-39\"></a>[N-39] Contract does not follow the Solidity style guide's suggested layout ordering\nThe [style guide](https://docs.soliditylang.org/en/v0.8.16/style-guide.html#order-of-layout)says that, within a contract, the ordering should be 1) Type declarations, 2) State variables, 3) Events, 4) Modifiers, and 5) Functions, but the contract(s) below do not follow this ordering\n\n*Instances (28)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n19:     using Strings for uint256;\n\n```\n\n[19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L19),\n\n```solidity\nFile: contracts/libraries/LegacyCollectLib.sol\n\n21:     using Strings for uint256;\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L21),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n21:     string constant EIP712_DOMAIN_VERSION = '2';\n\n43:     function validateSetProfileMetadataURISignature(\n\n173:     struct ReferenceParamsForAbiEncode {\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L21), [43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L43), [173](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L173),\n\n```solidity\nFile: contracts/libraries/constants/Types.sol\n\n48:     enum ProtocolState {\n\n65:     enum PublicationType {\n\n```\n\n[48](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L48), [65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L65),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n31:     using Address for address;\n\n32:     using Strings for uint256;\n\n```\n\n[31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L31), [32](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L32),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n27:     using Address for address;\n\n33:     constructor(address moduleGlobals, uint256 tokenGuardianCooldown) {\n\n50:     modifier onlyEOA() {\n\n```\n\n[27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L27), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L33), [50](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L50),\n\n```solidity\nFile: contracts/base/upgradeability/FollowNFTProxy.sol\n\n10:     using Address for address;\n\n```\n\n[10](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L10),\n\n```solidity\nFile: contracts/misc/ImmutableOwnable.sol\n\n9:     error OnlyOwner();\n\n10:     error OnlyOwnerOrHub();\n\n12:     modifier onlyOwner() {\n\n```\n\n[9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L9), [10](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L10), [12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L12),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n24:     using Strings for uint256;\n\n```\n\n[24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L24),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n8:     event ControllerContractUpdated(address previousControllerContract, address newControllerContract);\n\n10:     error Unauthorized();\n\n12:     address public controllerContract;\n\n14:     modifier onlyOwnerOrControllerContract() {\n\n```\n\n[8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L8), [10](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L10), [12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L12), [14](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L14),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n26:     using Address for address;\n\n```\n\n[26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L26),\n\n```solidity\nFile: contracts/interfaces/IFollowNFT.sol\n\n18:     error AlreadyFollowing();\n\n19:     error NotFollowing();\n\n20:     error FollowTokenDoesNotExist();\n\n21:     error AlreadyWrapped();\n\n22:     error OnlyWrappedFollowTokens();\n\n23:     error DoesNotHavePermissions();\n\n```\n\n[18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L18), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L19), [20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L20), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L21), [22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L22), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L23),\n\n</details>\n\n### <a name=\"N-40\"></a>[N-40] Function ordering does not follow the Solidity style guide\nAccording to the Solidity style guide, functions should be laid out in the following order :`constructor()`, `receive()`, `fallback()`, `external`, `public`, `internal`, `private`, but the cases below do not follow this pattern\n\n*Instances (15)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n480:     function tryMigrate(\n481:             uint256 followerProfileId,\n482:             address followerProfileOwner,\n483:             uint256 idOfProfileFollowed,\n484:             uint256 followTokenId\n485:         ) external onlyHub returns (uint48) {\n\n285:     function tokenURI(uint256 followTokenId) public view override returns (string memory) {\n\n```\n\n[480](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L480), [285](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L285),\n\n```solidity\nFile: contracts/libraries/GovernanceLib.sol\n\n86:     function whitelistActionModule(address actionModule, bool whitelist) external {\n\n```\n\n[86](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L86),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n425:     function validateActSignature(\n426:             Types.EIP712Signature calldata signature,\n427:             Types.PublicationActionParams calldata publicationActionParams\n428:         ) external {\n\n450:     function calculateDomainSeparator() internal view returns (bytes32) {\n\n```\n\n[425](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L425), [450](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L450),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n141:     function batchMigrateFollowModules(\n142:             uint256[] calldata profileIds,\n143:             address legacyFeeFollowModule,\n144:             address legacyProfileFollowModule,\n145:             address newFeeFollowModule\n146:         ) external {\n\n```\n\n[141](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L141),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n215:     function isExecutorApproved(uint256 delegatorProfileId, address delegatedExecutor) external view returns (bool) {\n\n```\n\n[215](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L215),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n190:     function getContentURI(uint256 profileId, uint256 pubId) external view returns (string memory) {\n\n291:     function _fillRootOfPublicationInStorage(\n292:             Types.Publication storage _publication,\n293:             uint256 pointedProfileId,\n294:             uint256 pointedPubId\n295:         ) internal {\n\n```\n\n[190](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L190), [291](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L291),\n\n```solidity\nFile: contracts/libraries/ValidationLib.sol\n\n121:     function validateLegacyCollectReferrer(\n122:             uint256 referrerProfileId,\n123:             uint256 referrerPubId,\n124:             uint256 publicationCollectedProfileId,\n125:             uint256 publicationCollectedId\n126:         ) external view {\n\n```\n\n[121](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L121),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n39:     function royaltyInfo(uint256 tokenId, uint256 salePrice) external view returns (address, uint256) {\n\n```\n\n[39](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L39),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n166:     function totalSupply() external view virtual override returns (uint256) {\n\n264:     function burn(uint256 tokenId) public virtual override {\n\n506:     function _beforeTokenTransfer(\n507:             address from,\n508:             address to,\n509:             uint256 tokenId\n510:         ) internal virtual {}\n\n```\n\n[166](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L166), [264](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L264), [506](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L506),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n186:     function getTokenGuardianDisablingTimestamp(address wallet) external view returns (uint256) {\n\n```\n\n[186](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L186),\n\n</details>\n\n### <a name=\"N-41\"></a>[N-41] Contracts should have full test coverage\nWhile 100% code coverage does not guarantee that there are no bugs, it often will catch easy-to-find bugs, and will ensure that there are fewer regressions when the code invariably has to be modified. Furthermore, in order to get full coverage, code authors will often have to re-organize their code so that it is more modular, so that each component can be tested separately, which reduces interdependencies between modules and layers, and makes for code that is easier to reason about and audit.\n\n*Instances (10)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: Various Files\n\n0: undefined\n\n0: undefined\n\n0: undefined\n\n0: undefined\n\n0: undefined\n\n0: undefined\n\n0: undefined\n\n0: undefined\n\n0: undefined\n\n0: undefined\n\n```\n\n[0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L0), [0](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ICollectModule.sol#L0),\n\n</details>\n\n### <a name=\"N-42\"></a>[N-42] TODO Left in the code\nTODOs may signal that a feature is missing or not ready for audit, consider resolving the issue and removing the TODO comment\n\n*Instances (4)*:\n\n```solidity\nFile: contracts/libraries/constants/Types.sol\n\n49:         // TODO: Reverse order, so Paused becomes 0 and the default. This will get rid of the initializer needs.\n\n345:     // TODO: Shouldn't this be in the modules Types?\n\n```\n\n[49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L49), [345](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L345),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n167:     // TODO: Should we revert if it doesn't exist?\n\n176:     // TODO: Should we revert if it doesn't exist?\n\n```\n\n[167](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L167), [176](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L176),\n\n### <a name=\"N-43\"></a>[N-43] Event is missing `indexed` fields\nIndex event fields make the field more quickly accessible [to off-chain tools](https://ethereum.stackexchange.com/questions/40396/can-somebody-please-explain-the-concept-of-event-indexing) that parse events. This is especially useful when it comes to filtering based on an address. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Where applicable, each `event` should use three `indexed` fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three applicable fields, all of the applicable fields should be indexed.\n\n*Instances (38)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/libraries/LegacyCollectLib.sol\n\n35:     event CollectedLegacy(\n\n```\n\n[35](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L35),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n29:     event ProfileMigrated(uint256 profileId, address profileDestination, string handle, uint256 handleId);\n\n```\n\n[29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L29),\n\n```solidity\nFile: contracts/libraries/constants/Events.sol\n\n15:     event BaseInitialized(string name, string symbol, uint256 timestamp);\n\n25:     event StateSet(\n\n41:     event GovernanceSet(\n\n57:     event EmergencyAdminSet(\n\n71:     event ProfileCreatorWhitelisted(address indexed profileCreator, bool indexed whitelisted, uint256 timestamp);\n\n80:     event FollowModuleWhitelisted(address indexed followModule, bool indexed whitelisted, uint256 timestamp);\n\n89:     event ReferenceModuleWhitelisted(address indexed referenceModule, bool indexed whitelisted, uint256 timestamp);\n\n99:     event ActionModuleWhitelisted(\n\n118:     event ProfileCreated(\n\n139:     event DelegatedExecutorsConfigChanged(\n\n155:     event ProfileImageURISet(uint256 indexed profileId, string imageURI, uint256 timestamp);\n\n166:     event FollowModuleSet(\n\n184:     event PostCreated(\n\n205:     event CommentCreated(\n\n223:     event MirrorCreated(\n\n243:     event QuoteCreated(\n\n259:     event FollowNFTDeployed(uint256 indexed profileId, address indexed followNFT, uint256 timestamp);\n\n269:     event CollectNFTDeployed(\n\n287:     event Collected(\n\n304:     event Acted(Types.PublicationActionParams publicationActionParams, bytes actionModuleReturnData, uint256 timestamp);\n\n317:     event Followed(\n\n333:     event Unfollowed(uint256 indexed unfollowerProfileId, uint256 idOfProfileUnfollowed, uint256 timestamp);\n\n342:     event Blocked(uint256 indexed byProfileId, uint256 idOfProfileBlocked, uint256 timestamp);\n\n351:     event Unblocked(uint256 indexed byProfileId, uint256 idOfProfileUnblocked, uint256 timestamp);\n\n363:     event CollectNFTTransferred(\n\n379:     event ModuleGlobalsGovernanceSet(address indexed prevGovernance, address indexed newGovernance, uint256 timestamp);\n\n388:     event ModuleGlobalsTreasurySet(address indexed prevTreasury, address indexed newTreasury, uint256 timestamp);\n\n397:     event ModuleGlobalsTreasuryFeeSet(uint16 indexed prevTreasuryFee, uint16 indexed newTreasuryFee, uint256 timestamp);\n\n407:     event ModuleGlobalsCurrencyWhitelisted(\n\n421:     event ProfileMetadataSet(uint256 indexed profileId, string metadata, uint256 timestamp);\n\n432:     event TokenGuardianStateChanged(\n\n```\n\n[15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L15), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L25), [41](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L41), [57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L57), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L71), [80](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L80), [89](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L89), [99](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L99), [118](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L118), [139](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L139), [155](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L155), [166](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L166), [184](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L184), [205](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L205), [223](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L223), [243](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L243), [259](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L259), [269](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L269), [287](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L287), [304](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L304), [317](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L317), [333](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L333), [342](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L342), [351](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L351), [363](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L363), [379](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L379), [388](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L388), [397](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L397), [407](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L407), [421](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L421), [432](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L432),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n8:     event ControllerContractUpdated(address previousControllerContract, address newControllerContract);\n\n```\n\n[8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L8),\n\n```solidity\nFile: contracts/namespaces/constants/Events.sol\n\n8:     event HandleMinted(string handle, string namespace, uint256 handleId, address to, uint256 timestamp);\n\n19:     event TokenGuardianStateChanged(\n\n28:     event HandleLinked(RegistryTypes.Handle handle, RegistryTypes.Token token, uint256 timestamp);\n\n35:     event HandleUnlinked(RegistryTypes.Handle handle, RegistryTypes.Token token, uint256 timestamp);\n\n```\n\n[8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Events.sol#L8), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Events.sol#L19), [28](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Events.sol#L28), [35](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Events.sol#L35),\n\n</details>\n\n### <a name=\"N-44\"></a>[N-44] Unused contract variables\nNote that there may be cases where a variable appears to be used, but this is only because there are multiple definitions of the varible in different files. In such cases, the variable definition should be moved into a separate file. The instances below are the unused variables.\n\n*Instances (39)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n24:     uint256[5] ___DEPRECATED_SLOTS; // Deprecated slots, previously used for delegations.\n\n```\n\n[24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L24),\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n31:     uint256 constant PROFILE_COUNTER_SLOT = 22;\n\n45:     uint256 constant PROFILE_ROYALTIES_BPS_SLOT = 30;\n\n```\n\n[31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L31), [45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L45),\n\n```solidity\nFile: contracts/libraries/constants/Typehash.sol\n\n7:     bytes32 constant ACT = keccak256('Act(uint256 publicationActedProfileId,uint256 publicationActedId,uint256 actorProfileId,uint256[] referrerProfileIds,uint256[] referrerPubIds,address actionModuleAddress,bytes actionModuleData,uint256 nonce,uint256 deadline)');\n\n9:     bytes32 constant BURN = keccak256('Burn(uint256 tokenId,uint256 nonce,uint256 deadline)');\n\n11:     bytes32 constant CHANGE_DELEGATED_EXECUTORS_CONFIG = keccak256('ChangeDelegatedExecutorsConfig(uint256 delegatorProfileId,address[] delegatedExecutors,bool[] approvals,uint64 configNumber,bool switchToGivenConfig,uint256 nonce,uint256 deadline)');\n\n13:     bytes32 constant LEGACY_COLLECT = keccak256('Collect(uint256 publicationCollectedProfileId,uint256 publicationCollectedId,uint256 collectorProfileId,uint256 referrerProfileId,uint256 referrerPubId,bytes collectModuleData,uint256 nonce,uint256 deadline)');\n\n15:     bytes32 constant COMMENT = keccak256('Comment(uint256 profileId,string contentURI,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileIds,uint256[] referrerPubIds,bytes referenceModuleData,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n17:     bytes32 constant EIP712_DOMAIN = keccak256('EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)');\n\n21:     bytes32 constant MIRROR = keccak256('Mirror(uint256 profileId,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileId,uint256[] referrerPubId,bytes referenceModuleData,uint256 nonce,uint256 deadline)');\n\n23:     bytes32 constant POST = keccak256('Post(uint256 profileId,string contentURI,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n25:     bytes32 constant QUOTE = keccak256('Quote(uint256 profileId,string contentURI,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileIds,uint256[] referrerPubIds,bytes referenceModuleData,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n27:     bytes32 constant SET_BLOCK_STATUS = keccak256('SetBlockStatus(uint256 byProfileId,uint256[] idsOfProfilesToSetBlockStatus,bool[] blockStatus,uint256 nonce,uint256 deadline)');\n\n29:     bytes32 constant SET_FOLLOW_MODULE = keccak256('SetFollowModule(uint256 profileId,address followModule,bytes followModuleInitData,uint256 nonce,uint256 deadline)');\n\n31:     bytes32 constant SET_PROFILE_IMAGE_URI = keccak256('SetProfileImageURI(uint256 profileId,string imageURI,uint256 nonce,uint256 deadline)');\n\n33:     bytes32 constant SET_PROFILE_METADATA_URI = keccak256('SetProfileMetadataURI(uint256 profileId,string metadata,uint256 nonce,uint256 deadline)');\n\n35:     bytes32 constant UNFOLLOW = keccak256('Unfollow(uint256 unfollowerProfileId,uint256[] idsOfProfilesToUnfollow,uint256 nonce,uint256 deadline)');\n\n```\n\n[7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L7), [9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L9), [11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L11), [13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L13), [15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L15), [17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L17), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L21), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L23), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L25), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L27), [29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L29), [31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L31), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L33), [35](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L35),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n55:     mapping(uint256 => uint256) private __DEPRECATED__ownedTokensIndex;\n\n61:     mapping(uint256 => uint256) private __DEPRECATED__allTokensIndex;\n\n```\n\n[55](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L55), [61](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L61),\n\n```solidity\nFile: contracts/base/LensHubStorage.sol\n\n17:     uint256 private _lastInitializedRevision; // Slot 11.\n\n19:     Types.ProtocolState internal _state; // Slot 12\n\n21:     mapping(address profileCreator => bool isWhitelisted) internal _profileCreatorWhitelisted; // Slot 13\n\n23:     mapping(address => bool isWhitelisted) internal _followModuleWhitelisted; // Slot 14\n\n28:     mapping(address actionModule => Types.ActionModuleWhitelistData whitelistData) internal _actionModuleWhitelistData; // Slot 15\n\n30:     mapping(address referenceModule => bool isWhitelisted) internal _referenceModuleWhitelisted; // Slot 16\n\n32:     mapping(uint256 profileId => address dispatcher) internal __DEPRECATED__dispatcherByProfile; // Slot 17\n\n34:     mapping(bytes32 handleHash => uint256 profileId) internal __DEPRECATED__profileIdByHandleHash; // Slot 18\n\n36:     mapping(uint256 profileId => Types.Profile profile) internal _profiles; // Slot 19\n\n38:     mapping(uint256 profileId => mapping(uint256 pubId => Types.Publication publication)) internal _publications; // Slot 20\n\n40:     mapping(address userAddress => uint256 profileId) internal __DEPRECATED__defaultProfiles; // Slot 21\n\n42:     uint256 internal _profileCounter; // Slot 22 - different from totalSupply, as this is not decreased when burning profiles\n\n44:     address internal _governance; // Slot 23\n\n46:     address internal _emergencyAdmin; // Slot 24\n\n51:     mapping(address => uint256) internal _tokenGuardianDisablingTimestamp; // Slot 25\n\n57:     mapping(uint256 profileId => Types.DelegatedExecutorsConfig config) internal _delegatedExecutorsConfigs; // Slot 26\n\n59:     mapping(uint256 blockerProfileId => mapping(uint256 blockedProfileId => bool isBlocked)) internal _blockedStatus; // Slot 27\n\n61:     mapping(uint256 id => address actionModule) internal _actionModules; // Slot 28\n\n63:     uint256 internal _maxActionModuleIdUsed; // Slot 29\n\n65:     uint256 internal _profileRoyaltiesBps; // Slot 30\n\n```\n\n[17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L17), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L19), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L21), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L23), [28](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L28), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L30), [32](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L32), [34](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L34), [36](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L36), [38](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L38), [40](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L40), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L42), [44](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L44), [46](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L46), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L51), [57](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L57), [59](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L59), [61](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L61), [63](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L63), [65](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L65),\n\n</details>\n\n### <a name=\"N-45\"></a>[N-45] Unused `error` definition\nNote that there may be cases where an error superficially appears to be used, but this is only because there are multiple definitions of the error in different files. In such cases, the error definition should be moved into a separate file. The instances below are the unused definitions.\n\n*Instances (60)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/libraries/constants/Errors.sol\n\n6:     error CannotInitImplementation();\n\n7:     error Initialized();\n\n8:     error SignatureExpired();\n\n9:     error SignatureInvalid();\n\n10:     error InvalidOwner();\n\n11:     error NotOwnerOrApproved();\n\n12:     error NotHub();\n\n13:     error TokenDoesNotExist();\n\n14:     error NotGovernance();\n\n15:     error NotGovernanceOrEmergencyAdmin();\n\n16:     error EmergencyAdminCanOnlyPauseFurther();\n\n17:     error NotProfileOwner();\n\n18:     error PublicationDoesNotExist();\n\n19:     error ProfileImageURILengthInvalid();\n\n20:     error CallerNotFollowNFT();\n\n21:     error CallerNotCollectNFT(); // Legacy\n\n22:     error ArrayMismatch();\n\n23:     error NotWhitelisted();\n\n24:     error InvalidParameter();\n\n25:     error ExecutorInvalid();\n\n26:     error Blocked();\n\n27:     error SelfBlock();\n\n28:     error NotFollowing();\n\n29:     error SelfFollow();\n\n30:     error InvalidReferrer();\n\n31:     error InvalidPointedPub();\n\n32:     error NonERC721ReceiverImplementer();\n\n33:     error AlreadyEnabled();\n\n36:     error MaxActionModuleIdReached(); // This means we need an upgrade\n\n39:     error InitParamsInvalid();\n\n40:     error ActionNotAllowed();\n\n42:     error CollectNotAllowed(); // Used in LegacyCollectLib (pending deprecation)\n\n45:     error Paused();\n\n46:     error PublishingPaused();\n\n49:     error GuardianEnabled();\n\n50:     error NotEOA();\n\n51:     error DisablingAlreadyTriggered();\n\n```\n\n[6](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L6), [7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L7), [8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L8), [9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L9), [10](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L10), [11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L11), [12](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L12), [13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L13), [14](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L14), [15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L15), [16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L16), [17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L17), [18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L18), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L19), [20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L20), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L21), [22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L22), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L23), [24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L24), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L25), [26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L26), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L27), [28](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L28), [29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L29), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L30), [31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L31), [32](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L32), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L33), [36](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L36), [39](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L39), [40](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L40), [42](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L42), [45](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L45), [46](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L46), [49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L49), [50](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L50), [51](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L51),\n\n```solidity\nFile: contracts/namespaces/constants/Errors.sol\n\n6:     error NotHandleOwner();\n\n7:     error NotTokenOwner();\n\n8:     error NotHandleNorTokenOwner();\n\n9:     error OnlyLensHub();\n\n10:     error NotLinked();\n\n11:     error DoesNotExist();\n\n15:     error HandleLengthInvalid();\n\n16:     error HandleContainsInvalidCharacters();\n\n17:     error HandleFirstCharInvalid();\n\n18:     error NotOwnerNorWhitelisted();\n\n19:     error NotOwner();\n\n20:     error NotHub();\n\n21:     error DoesNotExist();\n\n22:     error NotEOA();\n\n23:     error DisablingAlreadyTriggered();\n\n24:     error GuardianEnabled();\n\n25:     error AlreadyEnabled();\n\n```\n\n[6](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L6), [7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L7), [8](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L8), [9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L9), [10](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L10), [11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L11), [15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L15), [16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L16), [17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L17), [18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L18), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L19), [20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L20), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L21), [22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L22), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L23), [24](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L24), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L25),\n\n```solidity\nFile: contracts/interfaces/IFollowNFT.sol\n\n18:     error AlreadyFollowing();\n\n19:     error NotFollowing();\n\n20:     error FollowTokenDoesNotExist();\n\n21:     error AlreadyWrapped();\n\n22:     error OnlyWrappedFollowTokens();\n\n23:     error DoesNotHavePermissions();\n\n```\n\n[18](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L18), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L19), [20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L20), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L21), [22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L22), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L23),\n\n</details>\n\n### <a name=\"N-46\"></a>[N-46] Unused file\nThe file is never imported by any other source file. If the file is needed for tests, it should be moved to a test directory\n\n*Instances (44)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/LensHub.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L1),\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L1),\n\n```solidity\nFile: contracts/libraries/ActionLib.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L1),\n\n```solidity\nFile: contracts/libraries/FollowLib.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L1),\n\n```solidity\nFile: contracts/libraries/GovernanceLib.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L1),\n\n```solidity\nFile: contracts/libraries/LegacyCollectLib.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L1),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L1),\n\n```solidity\nFile: contracts/libraries/MigrationLib.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MigrationLib.sol#L1),\n\n```solidity\nFile: contracts/libraries/constants/Errors.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Errors.sol#L1),\n\n```solidity\nFile: contracts/libraries/constants/Events.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Events.sol#L1),\n\n```solidity\nFile: contracts/libraries/constants/Typehash.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L1),\n\n```solidity\nFile: contracts/base/HubRestricted.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/HubRestricted.sol#L1),\n\n```solidity\nFile: contracts/base/LensGovernable.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L1),\n\n```solidity\nFile: contracts/base/LensHubEventHooks.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubEventHooks.sol#L1),\n\n```solidity\nFile: contracts/base/LensHubStorage.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L1),\n\n```solidity\nFile: contracts/base/LensImplGetters.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensImplGetters.sol#L1),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L1),\n\n```solidity\nFile: contracts/base/upgradeability/FollowNFTProxy.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L1),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L1),\n\n```solidity\nFile: contracts/misc/LensV2Migration.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L1),\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L1),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L1),\n\n```solidity\nFile: contracts/misc/ProfileCreationProxy.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L1),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L1),\n\n```solidity\nFile: contracts/misc/access/ProxyAdmin.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L1),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L1),\n\n```solidity\nFile: contracts/namespaces/TokenHandleRegistry.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L1),\n\n```solidity\nFile: contracts/namespaces/constants/Errors.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Errors.sol#L1),\n\n```solidity\nFile: contracts/namespaces/constants/Events.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/constants/Events.sol#L1),\n\n```solidity\nFile: contracts/interfaces/ICollectModule.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ICollectModule.sol#L1),\n\n```solidity\nFile: contracts/interfaces/ICollectNFT.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ICollectNFT.sol#L1),\n\n```solidity\nFile: contracts/interfaces/IFollowModule.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowModule.sol#L1),\n\n```solidity\nFile: contracts/interfaces/IFollowNFT.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IFollowNFT.sol#L1),\n\n```solidity\nFile: contracts/interfaces/ILegacyCollectModule.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyCollectModule.sol#L1),\n\n```solidity\nFile: contracts/interfaces/ILegacyCollectNFT.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyCollectNFT.sol#L1),\n\n```solidity\nFile: contracts/interfaces/ILegacyFollowModule.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyFollowModule.sol#L1),\n\n```solidity\nFile: contracts/interfaces/ILegacyReferenceModule.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyReferenceModule.sol#L1),\n\n```solidity\nFile: contracts/interfaces/ILensHandles.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHandles.sol#L1),\n\n```solidity\nFile: contracts/interfaces/ILensHub.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHub.sol#L1),\n\n```solidity\nFile: contracts/interfaces/ILensHubInitializable.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILensHubInitializable.sol#L1),\n\n```solidity\nFile: contracts/interfaces/IModuleGlobals.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IModuleGlobals.sol#L1),\n\n```solidity\nFile: contracts/interfaces/IPublicationActionModule.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IPublicationActionModule.sol#L1),\n\n```solidity\nFile: contracts/interfaces/IReferenceModule.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/IReferenceModule.sol#L1),\n\n```solidity\nFile: contracts/interfaces/ITokenHandleRegistry.sol\n\n1: // SPDX-License-Identifier: MIT\n\n```\n\n[1](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ITokenHandleRegistry.sol#L1),\n\n</details>\n\n### <a name=\"N-47\"></a>[N-47] Unused parameter\npossible for issue\n\n*Instances (16)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n/// @audit quoteParams not used\n203:     function _asReferencePubParams(Types.QuoteParams calldata quoteParams)\n204:             private\n205:             pure\n206:             returns (Types.ReferencePubParams calldata referencePubParams)\n207:         {\n\n/// @audit commentParams not used\n214:     function _asReferencePubParams(Types.CommentParams calldata commentParams)\n215:             private\n216:             pure\n217:             returns (Types.ReferencePubParams calldata referencePubParams)\n218:         {\n\n```\n\n[203](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L203), [214](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L214),\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n/// @audit profileId not used\n49:     function getPublication(uint256 profileId, uint256 pubId)\n50:            internal\n51:            pure\n52:            returns (Types.Publication storage _publication)\n53:        {\n\n/// @audit pubId not used\n49:     function getPublication(uint256 profileId, uint256 pubId)\n50:            internal\n51:            pure\n52:            returns (Types.Publication storage _publication)\n53:        {\n\n/// @audit profileId not used\n63:     function getProfile(uint256 profileId) internal pure returns (Types.Profile storage _profiles) {\n\n/// @audit delegatorProfileId not used\n71:     function getDelegatedExecutorsConfig(uint256 delegatorProfileId)\n72:            internal\n73:            pure\n74:            returns (Types.DelegatedExecutorsConfig storage _delegatedExecutorsConfig)\n75:        {\n\n/// @audit tokenId not used\n93:     function getTokenData(uint256 tokenId) internal pure returns (Types.TokenData storage _tokenData) {\n\n/// @audit blockerProfileId not used\n101:     function blockedStatus(uint256 blockerProfileId)\n102:             internal\n103:             pure\n104:             returns (mapping(uint256 => bool) storage _blockedStatus)\n105:         {\n\n/// @audit newGovernance not used\n193:     function setGovernance(address newGovernance) internal {\n\n/// @audit newEmergencyAdmin not used\n205:     function setEmergencyAdmin(address newEmergencyAdmin) internal {\n\n/// @audit newState not used\n217:     function setState(Types.ProtocolState newState) internal {\n\n/// @audit newLastInitializedRevision not used\n229:     function setLastInitializedRevision(uint256 newLastInitializedRevision) internal {\n\n```\n\n[49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L49), [49](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L49), [63](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L63), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L71), [93](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L93), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L101), [193](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L193), [205](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L205), [217](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L217), [229](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L229),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n/// @audit royaltiesInBasisPoints not used\n58:     function _storeRoyaltiesInBasisPoints(uint256 royaltiesInBasisPoints) internal virtual {\n\n```\n\n[58](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L58),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n/// @audit from not used\n506:     function _beforeTokenTransfer(\n507:             address from,\n508:             address to,\n509:             uint256 tokenId\n510:         ) internal virtual {}\n\n/// @audit to not used\n506:     function _beforeTokenTransfer(\n507:             address from,\n508:             address to,\n509:             uint256 tokenId\n510:         ) internal virtual {}\n\n/// @audit tokenId not used\n506:     function _beforeTokenTransfer(\n507:             address from,\n508:             address to,\n509:             uint256 tokenId\n510:         ) internal virtual {}\n\n```\n\n[506](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L506), [506](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L506), [506](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L506),\n\n</details>\n\n### <a name=\"N-48\"></a>[N-48] Unused structs\nIf these serve no purpose, they should be safely removed\n\n*Instances (14)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/libraries/constants/Types.sol\n\n21:     struct TokenData {\n22:            address owner;\n23:            uint96 mintTimestamp;\n24:        }\n\n34:     struct FollowData {\n35:            uint160 followerProfileId;\n36:            uint48 originalFollowTimestamp;\n37:            uint48 followTimestamp;\n38:            uint256 profileIdAllowedToRecover;\n39:        }\n\n82:     struct EIP712Signature {\n83:            address signer;\n84:            uint8 v;\n85:            bytes32 r;\n86:            bytes32 s;\n87:            uint256 deadline;\n88:        }\n\n161:     struct CreateProfileParams {\n162:             address to;\n163:             string imageURI;\n164:             address followModule;\n165:             bytes followModuleInitData;\n166:         }\n\n178:     struct PostParams {\n179:             uint256 profileId;\n180:             string contentURI;\n181:             address[] actionModules;\n182:             bytes[] actionModulesInitDatas;\n183:             address referenceModule;\n184:             bytes referenceModuleInitData;\n185:         }\n\n260:     struct ReferencePubParams {\n261:             uint256 profileId;\n262:             string contentURI;\n263:             uint256 pointedProfileId;\n264:             uint256 pointedPubId;\n265:             uint256[] referrerProfileIds;\n266:             uint256[] referrerPubIds;\n267:             bytes referenceModuleData;\n268:             address[] actionModules;\n269:             bytes[] actionModulesInitDatas;\n270:             address referenceModule;\n271:             bytes referenceModuleInitData;\n272:         }\n\n323:     struct PublicationActionParams {\n324:             uint256 publicationActedProfileId;\n325:             uint256 publicationActedId;\n326:             uint256 actorProfileId;\n327:             uint256[] referrerProfileIds;\n328:             uint256[] referrerPubIds;\n329:             address actionModuleAddress;\n330:             bytes actionModuleData;\n331:         }\n\n333:     struct ProcessActionParams {\n334:             uint256 publicationActedProfileId;\n335:             uint256 publicationActedId;\n336:             uint256 actorProfileId;\n337:             address actorProfileOwner;\n338:             address transactionExecutor;\n339:             uint256[] referrerProfileIds;\n340:             uint256[] referrerPubIds;\n341:             Types.PublicationType[] referrerPubTypes;\n342:             bytes actionModuleData;\n343:         }\n\n346:     struct ProcessCollectParams {\n347:             uint256 publicationCollectedProfileId;\n348:             uint256 publicationCollectedId;\n349:             uint256 collectorProfileId;\n350:             address collectorProfileOwner;\n351:             address transactionExecutor;\n352:             uint256[] referrerProfileIds;\n353:             uint256[] referrerPubIds;\n354:             Types.PublicationType[] referrerPubTypes;\n355:             bytes data;\n356:         }\n\n358:     struct ProcessCommentParams {\n359:             uint256 profileId;\n360:             address transactionExecutor;\n361:             uint256 pointedProfileId;\n362:             uint256 pointedPubId;\n363:             uint256[] referrerProfileIds;\n364:             uint256[] referrerPubIds;\n365:             Types.PublicationType[] referrerPubTypes;\n366:             bytes data;\n367:         }\n\n369:     struct ProcessQuoteParams {\n370:             uint256 profileId;\n371:             address transactionExecutor;\n372:             uint256 pointedProfileId;\n373:             uint256 pointedPubId;\n374:             uint256[] referrerProfileIds;\n375:             uint256[] referrerPubIds;\n376:             Types.PublicationType[] referrerPubTypes;\n377:             bytes data;\n378:         }\n\n380:     struct ProcessMirrorParams {\n381:             uint256 profileId;\n382:             address transactionExecutor;\n383:             uint256 pointedProfileId;\n384:             uint256 pointedPubId;\n385:             uint256[] referrerProfileIds;\n386:             uint256[] referrerPubIds;\n387:             Types.PublicationType[] referrerPubTypes;\n388:             bytes data;\n389:         }\n\n399:     struct DelegatedExecutorsConfig {\n400:             mapping(uint256 => mapping(address => bool)) isApproved; // isApproved[configNumber][delegatedExecutor]\n401:             uint64 configNumber;\n402:             uint64 prevConfigNumber;\n403:             uint64 maxConfigNumberSet;\n404:         }\n\n406:     struct ActionModuleWhitelistData {\n407:             uint248 id;\n408:             bool isWhitelisted;\n409:         }\n\n```\n\n[21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L21), [34](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L34), [82](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L82), [161](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L161), [178](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L178), [260](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L260), [323](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L323), [333](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L333), [346](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L346), [358](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L358), [369](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L369), [380](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L380), [399](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L399), [406](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Types.sol#L406),\n\n</details>\n\n### <a name=\"N-49\"></a>[N-49] Use `abi.encodeCall()` instead of `abi.encodeSignature()`/`abi.encodeSelector()`\n`abi.encodeCall()` has compiler [type safety](https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3693), whereas the other two functions do not\n\n*Instances (1)*:\n\n```solidity\nFile: contracts/libraries/FollowLib.sol\n\n91:         bytes memory functionData = abi.encodeWithSelector(IFollowNFT.initialize.selector, profileId);\n\n```\n\n[91](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L91),\n\n### <a name=\"N-50\"></a>[N-50] Use `bytes.concat()` on bytes instead of `abi.encodePacked()` for clearer semantic\nStarting with version 0.8.4, Solidity has the `bytes.concat()` function, which allows one to concatenate a list of bytes/strings, without extra padding. Using this function rather than `abi.encodePacked()` makes the intended operation more clear, leading to less reviewer confusion.\n\n*Instances (13)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n275:         return string(abi.encodePacked(_followedProfileId.toString(), FOLLOW_NFT_NAME_SUFFIX));\n\n279:         return string(abi.encodePacked(_followedProfileId.toString(), FOLLOW_NFT_SYMBOL_SUFFIX));\n\n```\n\n[275](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L275), [279](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L279),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n103:                         abi.encodePacked(delegatedExecutors),\n\n104:                         abi.encodePacked(approvals),\n\n169:         return keccak256(abi.encodePacked(actionModulesInitDatasHashes));\n\n345:                         keccak256(abi.encodePacked(idsOfProfilesToFollow)),\n\n346:                         keccak256(abi.encodePacked(followTokenIds)),\n\n347:                         keccak256(abi.encodePacked(dataHashes)),\n\n368:                         keccak256(abi.encodePacked(idsOfProfilesToUnfollow)),\n\n390:                         keccak256(abi.encodePacked(idsOfProfilesToSetBlockStatus)),\n\n391:                         keccak256(abi.encodePacked(blockStatus)),\n\n473:             bytes memory concatenatedSig = abi.encodePacked(signature.r, signature.s, signature.v);\n\n493:         return keccak256(abi.encodePacked('\\x19\\x01', calculateDomainSeparator(), hashedMessage));\n\n```\n\n[103](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L103), [104](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L104), [169](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L169), [345](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L345), [346](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L346), [347](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L347), [368](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L368), [390](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L390), [391](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L391), [473](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L473), [493](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L493),\n\n</details>\n\n### <a name=\"N-51\"></a>[N-51] Constants should be defined rather than using magic numbers\nEven [assembly](https://github.com/code-423n4/2022-05-opensea-seaport/blob/9d7ce4d08bf3c3010304a0476a785c70c0e90ae7/contracts/lib/TokenTransferrer.sol#L35-L39)can benefit from using readable constants instead of hex/numeric literals\n\n*Instances (2)*:\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n/// @audit 1000\n55:         _setRoyalty(1000); // 10% of royalties\n\n```\n\n[55](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L55),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n/// @audit 1000\n48:         _setRoyalty(1000); // 10% of royalties\n\n```\n\n[48](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L48),\n\n### <a name=\"N-52\"></a>[N-52] Non-library/interface files should use fixed compiler versions, not floating ones\n\n*Instances (22)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/LensHub.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L3),\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L3),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n3: pragma solidity ^0.8.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L3),\n\n```solidity\nFile: contracts/base/HubRestricted.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/HubRestricted.sol#L3),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n3: pragma solidity ^0.8.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L3),\n\n```solidity\nFile: contracts/base/LensGovernable.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L3),\n\n```solidity\nFile: contracts/base/LensHubEventHooks.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubEventHooks.sol#L3),\n\n```solidity\nFile: contracts/base/LensHubStorage.sol\n\n3: pragma solidity ^0.8.18;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L3),\n\n```solidity\nFile: contracts/base/LensImplGetters.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensImplGetters.sol#L3),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L3),\n\n```solidity\nFile: contracts/base/upgradeability/FollowNFTProxy.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L3),\n\n```solidity\nFile: contracts/misc/ImmutableOwnable.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L3),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L3),\n\n```solidity\nFile: contracts/misc/LensV2Migration.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L3),\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n3: pragma solidity ^0.8.19;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L3),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L3),\n\n```solidity\nFile: contracts/misc/ProfileCreationProxy.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L3),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L3),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L3),\n\n```solidity\nFile: contracts/misc/access/ProxyAdmin.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L3),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n3: pragma solidity ^0.8.18;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L3),\n\n```solidity\nFile: contracts/namespaces/TokenHandleRegistry.sol\n\n3: pragma solidity ^0.8.18;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L3),\n\n</details>\n\n### <a name=\"N-53\"></a>[N-53] Expressions for constant values such as a call to `keccak256()`, should use `immutable` rather than `constant`\nWhile it doesn't save any gas because the compiler knows that developers often make this mistake, it's still best to use theright tool for the task at hand. There is a difference between `constant` variables and `immutable` variables, and they shouldeach be used in their appropriate contexts. `constants` should be used for literal values written into the code, and `immutable`variables should be used for expressions, or values calculated in, or passed into the constructor.\n\n*Instances (17)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n22:     bytes32 constant EIP712_DOMAIN_VERSION_HASH = keccak256(bytes(EIP712_DOMAIN_VERSION));\n\n```\n\n[22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L22),\n\n```solidity\nFile: contracts/libraries/constants/Typehash.sol\n\n7:     bytes32 constant ACT = keccak256('Act(uint256 publicationActedProfileId,uint256 publicationActedId,uint256 actorProfileId,uint256[] referrerProfileIds,uint256[] referrerPubIds,address actionModuleAddress,bytes actionModuleData,uint256 nonce,uint256 deadline)');\n\n9:     bytes32 constant BURN = keccak256('Burn(uint256 tokenId,uint256 nonce,uint256 deadline)');\n\n11:     bytes32 constant CHANGE_DELEGATED_EXECUTORS_CONFIG = keccak256('ChangeDelegatedExecutorsConfig(uint256 delegatorProfileId,address[] delegatedExecutors,bool[] approvals,uint64 configNumber,bool switchToGivenConfig,uint256 nonce,uint256 deadline)');\n\n13:     bytes32 constant LEGACY_COLLECT = keccak256('Collect(uint256 publicationCollectedProfileId,uint256 publicationCollectedId,uint256 collectorProfileId,uint256 referrerProfileId,uint256 referrerPubId,bytes collectModuleData,uint256 nonce,uint256 deadline)');\n\n15:     bytes32 constant COMMENT = keccak256('Comment(uint256 profileId,string contentURI,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileIds,uint256[] referrerPubIds,bytes referenceModuleData,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n17:     bytes32 constant EIP712_DOMAIN = keccak256('EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)');\n\n19:     bytes32 constant FOLLOW = keccak256('Follow(uint256 followerProfileId,uint256[] idsOfProfilesToFollow,uint256[] followTokenIds,bytes[] datas,uint256 nonce,uint256 deadline)');\n\n21:     bytes32 constant MIRROR = keccak256('Mirror(uint256 profileId,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileId,uint256[] referrerPubId,bytes referenceModuleData,uint256 nonce,uint256 deadline)');\n\n23:     bytes32 constant POST = keccak256('Post(uint256 profileId,string contentURI,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n25:     bytes32 constant QUOTE = keccak256('Quote(uint256 profileId,string contentURI,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileIds,uint256[] referrerPubIds,bytes referenceModuleData,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n27:     bytes32 constant SET_BLOCK_STATUS = keccak256('SetBlockStatus(uint256 byProfileId,uint256[] idsOfProfilesToSetBlockStatus,bool[] blockStatus,uint256 nonce,uint256 deadline)');\n\n29:     bytes32 constant SET_FOLLOW_MODULE = keccak256('SetFollowModule(uint256 profileId,address followModule,bytes followModuleInitData,uint256 nonce,uint256 deadline)');\n\n31:     bytes32 constant SET_PROFILE_IMAGE_URI = keccak256('SetProfileImageURI(uint256 profileId,string imageURI,uint256 nonce,uint256 deadline)');\n\n33:     bytes32 constant SET_PROFILE_METADATA_URI = keccak256('SetProfileMetadataURI(uint256 profileId,string metadata,uint256 nonce,uint256 deadline)');\n\n35:     bytes32 constant UNFOLLOW = keccak256('Unfollow(uint256 unfollowerProfileId,uint256[] idsOfProfilesToUnfollow,uint256 nonce,uint256 deadline)');\n\n```\n\n[7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L7), [9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L9), [11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L11), [13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L13), [15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L15), [17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L17), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L19), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L21), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L23), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L25), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L27), [29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L29), [31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L31), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L33), [35](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L35),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n32:     bytes32 internal constant NAMESPACE_HASH = keccak256(bytes(NAMESPACE));\n\n```\n\n[32](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L32),\n\n</details>\n\n### <a name=\"N-54\"></a>[N-54] Functions not used internally could be marked external\n\n*Instances (17)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n255:     function burn(uint256 followTokenId) public override {\n\n274:     function name() public view override returns (string memory) {\n\n278:     function symbol() public view override returns (string memory) {\n\n285:     function tokenURI(uint256 followTokenId) public view override returns (string memory) {\n\n```\n\n[255](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L255), [274](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L274), [278](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L278), [285](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L285),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n94:     function nonces(address signer) public view override returns (uint256) {\n\n```\n\n[94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L94),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n93:     function burn(uint256 tokenId)\n\n105:     function tokenURI(uint256 tokenId) public view override(LensBaseERC721, IERC721Metadata) returns (string memory) {\n\n112:     function approve(address to, uint256 tokenId) public override(LensBaseERC721, IERC721) {\n\n120:     function setApprovalForAll(address operator, bool approved) public override(LensBaseERC721, IERC721) {\n\n```\n\n[93](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L93), [105](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L105), [112](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L112), [120](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L120),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n69:     function tokenURI(uint256 tokenId) public view override returns (string memory) {\n\n77:     function name() public view override returns (string memory) {\n\n84:     function symbol() public pure override returns (string memory) {\n\n```\n\n[69](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L69), [77](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L77), [84](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L84),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n70:     function name() public pure override returns (string memory) {\n\n81:     function tokenURI(uint256 tokenId) public view override returns (string memory) {\n\n139:     function approve(address to, uint256 tokenId) public override(IERC721, ERC721) {\n\n147:     function setApprovalForAll(address operator, bool approved) public override(IERC721, ERC721) {\n\n177:     function getHandle(uint256 tokenId) public view returns (string memory) {\n\n```\n\n[70](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L70), [81](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L81), [139](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L139), [147](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L147), [177](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L177),\n\n</details>\n\n### <a name=\"N-55\"></a>[N-55] Use a more recent version of solidity\nUse a solidity version of at least 0.8.13 to get the ability to use using for with a list of free functions In 0.8.15 the conditions necessary for inlining are relaxed. Benchmarks show that the change significantly decreases the bytecode size (which impacts the deployment cost) while the effect on the runtime gas usage is smaller.In 0.8.17 prevent the incorrect removal of storage writes before calls to Yul functions that conditionally terminate the external EVM call; Simplify the starting offset of zero-length operations to zero. More efficient overflow checks for multiplication.\n\n*Instances (2)*:\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n3: pragma solidity ^0.8.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L3),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n3: pragma solidity ^0.8.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L3),\n\n### <a name=\"N-56\"></a>[N-56] Use named function calls\nCode base has an extensive use of named function calls, but it somehow missed one instance where this would be appropriate.\nIt should use named function calls on function call, as such:\n\n```solidity\n\nlibrary.exampleFunction{value: _data.amount.value}({\n    _id: _data.id,\n    _amount: _data.amount.value,\n    _token: _data.token,\n    _example: \"\",    _metadata: _data.metadata\n});\n\n\n```\n\n\n\n*Instances (1)*:\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n82:         (bool success, bytes memory returnData) = target.call{gas: gasleft(), value: msg.value}(data);\n\n```\n\n[82](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L82),\n\n### <a name=\"N-57\"></a>[N-57] Critical Changes Should Use Two-step Procedure\nThe critical procedures should be two step process.\nSee similar findings in previous Code4rena contests for reference:[code4rena.com illuminate-report](https://code4rena.com/reports/2022-06-illuminate/#2-critical-changes-should-use-two-step-procedure)\n\n*Instances (18)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/libraries/GovernanceLib.sol\n\n16:     function setGovernance(address newGovernance) external {\n\n27:     function setEmergencyAdmin(address newEmergencyAdmin) external {\n\n```\n\n[16](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L16), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L27),\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n193:     function setGovernance(address newGovernance) internal {\n\n205:     function setEmergencyAdmin(address newEmergencyAdmin) internal {\n\n229:     function setLastInitializedRevision(uint256 newLastInitializedRevision) internal {\n\n```\n\n[193](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L193), [205](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L205), [229](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L229),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n26:     function setRoyalty(uint256 royaltiesInBasisPoints) external {\n\n43:     function _setRoyalty(uint256 royaltiesInBasisPoints) internal virtual {\n\n```\n\n[26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L26), [43](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L43),\n\n```solidity\nFile: contracts/base/LensGovernable.sol\n\n25:     function setGovernance(address newGovernance) external override onlyGov {\n\n30:     function setEmergencyAdmin(address newEmergencyAdmin) external override onlyGov {\n\n```\n\n[25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L25), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L30),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n50:     function setGovernance(address newGovernance) external override onlyGov {\n\n55:     function setTreasury(address newTreasury) external override onlyGov {\n\n60:     function setTreasuryFee(uint16 newTreasuryFee) external override onlyGov {\n\n94:     function _setGovernance(address newGovernance) internal {\n\n101:     function _setTreasury(address newTreasury) internal {\n\n108:     function _setTreasuryFee(uint16 newTreasuryFee) internal {\n\n```\n\n[50](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L50), [55](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L55), [60](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L60), [94](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L94), [101](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L101), [108](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L108),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n30:     function setControllerContract(address newControllerContract) external onlyOwner {\n\n```\n\n[30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L30),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n23:     function lensHub_setGovernance(address newGovernance) external onlyOwner {\n\n27:     function lensHub_setEmergencyAdmin(address newEmergencyAdmin) external onlyOwner {\n\n```\n\n[23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L23), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L27),\n\n</details>\n\n### <a name=\"N-58\"></a>[N-58] Large numeric literals should use underscores for readability\n\n*Instances (2)*:\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n10:     uint16 internal constant BASIS_POINTS = 10000;\n\n```\n\n[10](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L10),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n20:     uint16 internal constant BPS_MAX = 10000;\n\n```\n\n[20](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L20),\n\n### <a name=\"N-59\"></a>[N-59] Using underscore at the end of variable name\nThe use of underscore at the end of the variable name is uncommon and also suggests that the variable name was not completely changed. Consider refactoring variableName_ to variableName.\n\n*Instances (13)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n71:     function _initialize(string calldata name_, string calldata symbol_) internal {\n\n71:     function _initialize(string calldata name_, string calldata symbol_) internal {\n\n```\n\n[71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L71), [71](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L71),\n\n```solidity\nFile: contracts/misc/LensV2UpgradeContract.sol\n\n26:         address[] memory oldFollowModulesToUnwhitelist_,\n\n27:         address[] memory newFollowModulesToWhitelist_,\n\n28:         address[] memory oldReferenceModulesToUnwhitelist_,\n\n29:         address[] memory newReferenceModulesToWhitelist_,\n\n30:         address[] memory oldCollectModulesToUnwhitelist_,\n\n31:         address[] memory newActionModulesToWhitelist_\n\n```\n\n[26](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L26), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L27), [28](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L28), [29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L29), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L30), [31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2UpgradeContract.sol#L31),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n15:     constructor(address lensHubAddress_, address governanceOwner_) ControllableByContract(governanceOwner_) {\n\n15:     constructor(address lensHubAddress_, address governanceOwner_) ControllableByContract(governanceOwner_) {\n\n```\n\n[15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L15), [15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L15),\n\n```solidity\nFile: contracts/misc/access/ProxyAdmin.sol\n\n13:         address lensHubAddress_,\n\n14:         address previousImplementation_,\n\n15:         address proxyAdminOwner_\n\n```\n\n[13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L13), [14](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L14), [15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L15),\n\n</details>\n\n### <a name=\"N-60\"></a>[N-60] Consider implementing two-step procedure for updating protocol addresses\nA copy-paste error or a typo may end up bricking protocol functionality, or sending tokens to an address with no known private key. Consider implementing a two-step procedure for updating protocol addresses, where the recipient is set as pending, and must 'accept' the assignment by making an affirmative call. A straight forward way of doing this would be to have the target contracts implement [EIP-165](https://eips.ethereum.org/EIPS/eip-165), and to have the 'set' functions ensure that the recipient is of the right interface type.\n\n*Instances (7)*:\n\n```solidity\nFile: contracts/base/LensGovernable.sol\n\n25:     function setGovernance(address newGovernance) external override onlyGov {\n26:            GovernanceLib.setGovernance(newGovernance);\n27:        }\n\n30:     function setEmergencyAdmin(address newEmergencyAdmin) external override onlyGov {\n31:            GovernanceLib.setEmergencyAdmin(newEmergencyAdmin);\n32:        }\n\n```\n\n[25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L25), [30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L30),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n50:     function setGovernance(address newGovernance) external override onlyGov {\n51:            _setGovernance(newGovernance);\n52:        }\n\n55:     function setTreasury(address newTreasury) external override onlyGov {\n56:            _setTreasury(newTreasury);\n57:        }\n\n```\n\n[50](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L50), [55](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L55),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n30:     function setControllerContract(address newControllerContract) external onlyOwner {\n31:            emit ControllerContractUpdated(controllerContract, newControllerContract);\n32:            controllerContract = newControllerContract;\n33:        }\n\n```\n\n[30](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L30),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n23:     function lensHub_setGovernance(address newGovernance) external onlyOwner {\n24:            LENS_HUB.setGovernance(newGovernance);\n25:        }\n\n27:     function lensHub_setEmergencyAdmin(address newEmergencyAdmin) external onlyOwner {\n28:            LENS_HUB.setEmergencyAdmin(newEmergencyAdmin);\n29:        }\n\n```\n\n[23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L23), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L27),\n\n### <a name=\"N-61\"></a>[N-61] Do not calculate constants\nDue to how constant variables are implemented (replacements at compile-time), an expression assigned to a constant variable is recomputed each time that the variable is used, which wastes some gas.\n\n*Instances (17)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n22:     bytes32 constant EIP712_DOMAIN_VERSION_HASH = keccak256(bytes(EIP712_DOMAIN_VERSION));\n\n```\n\n[22](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L22),\n\n```solidity\nFile: contracts/libraries/constants/Typehash.sol\n\n7:     bytes32 constant ACT = keccak256('Act(uint256 publicationActedProfileId,uint256 publicationActedId,uint256 actorProfileId,uint256[] referrerProfileIds,uint256[] referrerPubIds,address actionModuleAddress,bytes actionModuleData,uint256 nonce,uint256 deadline)');\n\n9:     bytes32 constant BURN = keccak256('Burn(uint256 tokenId,uint256 nonce,uint256 deadline)');\n\n11:     bytes32 constant CHANGE_DELEGATED_EXECUTORS_CONFIG = keccak256('ChangeDelegatedExecutorsConfig(uint256 delegatorProfileId,address[] delegatedExecutors,bool[] approvals,uint64 configNumber,bool switchToGivenConfig,uint256 nonce,uint256 deadline)');\n\n13:     bytes32 constant LEGACY_COLLECT = keccak256('Collect(uint256 publicationCollectedProfileId,uint256 publicationCollectedId,uint256 collectorProfileId,uint256 referrerProfileId,uint256 referrerPubId,bytes collectModuleData,uint256 nonce,uint256 deadline)');\n\n15:     bytes32 constant COMMENT = keccak256('Comment(uint256 profileId,string contentURI,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileIds,uint256[] referrerPubIds,bytes referenceModuleData,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n17:     bytes32 constant EIP712_DOMAIN = keccak256('EIP712Domain(string name,string version,uint256 chainId,address verifyingContract)');\n\n19:     bytes32 constant FOLLOW = keccak256('Follow(uint256 followerProfileId,uint256[] idsOfProfilesToFollow,uint256[] followTokenIds,bytes[] datas,uint256 nonce,uint256 deadline)');\n\n21:     bytes32 constant MIRROR = keccak256('Mirror(uint256 profileId,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileId,uint256[] referrerPubId,bytes referenceModuleData,uint256 nonce,uint256 deadline)');\n\n23:     bytes32 constant POST = keccak256('Post(uint256 profileId,string contentURI,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n25:     bytes32 constant QUOTE = keccak256('Quote(uint256 profileId,string contentURI,uint256 pointedProfileId,uint256 pointedPubId,uint256[] referrerProfileIds,uint256[] referrerPubIds,bytes referenceModuleData,address collectModule,bytes collectModuleInitData,address referenceModule,bytes referenceModuleInitData,uint256 nonce,uint256 deadline)');\n\n27:     bytes32 constant SET_BLOCK_STATUS = keccak256('SetBlockStatus(uint256 byProfileId,uint256[] idsOfProfilesToSetBlockStatus,bool[] blockStatus,uint256 nonce,uint256 deadline)');\n\n29:     bytes32 constant SET_FOLLOW_MODULE = keccak256('SetFollowModule(uint256 profileId,address followModule,bytes followModuleInitData,uint256 nonce,uint256 deadline)');\n\n31:     bytes32 constant SET_PROFILE_IMAGE_URI = keccak256('SetProfileImageURI(uint256 profileId,string imageURI,uint256 nonce,uint256 deadline)');\n\n33:     bytes32 constant SET_PROFILE_METADATA_URI = keccak256('SetProfileMetadataURI(uint256 profileId,string metadata,uint256 nonce,uint256 deadline)');\n\n35:     bytes32 constant UNFOLLOW = keccak256('Unfollow(uint256 unfollowerProfileId,uint256[] idsOfProfilesToUnfollow,uint256 nonce,uint256 deadline)');\n\n```\n\n[7](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L7), [9](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L9), [11](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L11), [13](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L13), [15](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L15), [17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L17), [19](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L19), [21](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L21), [23](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L23), [25](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L25), [27](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L27), [29](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L29), [31](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L31), [33](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L33), [35](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/constants/Typehash.sol#L35),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n32:     bytes32 internal constant NAMESPACE_HASH = keccak256(bytes(NAMESPACE));\n\n```\n\n[32](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L32),\n\n</details>\n\n### <a name=\"N-62\"></a>[N-62] Public functions not used internally can be marked as external to save gas\n`public` functions that aren't used `internal`ly in Solidity contracts should be made `external` to optimize gas usage and improve contract efficiency. `external` functions can only be called from outside the contract, and their arguments are directly read from the `calldata`, which is more gas-efficient than loading them into `memory`, as is the case for `public` functions. By using `external` visibility, developers can reduce gas consumption for `external` calls and ensure that the contract operates more cost-effectively for users. Moreover, setting the appropriate visibility level for functions also enhances code readability and maintainability, promoting a more secure and well-structured contract design.\n\n*Instances (2)*:\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n17:     function supportsInterface(bytes4 interfaceId) public view virtual returns (bool) {\n\n```\n\n[17](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L17),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n177:     function getHandle(uint256 tokenId) public view returns (string memory) {\n\n```\n\n[177](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L177),\n\n### <a name=\"N-63\"></a>[N-63] Use `assembly` to calculate hashes to save gas\nUse assembly to calculate hashes to save gas\n\n*Instances (43)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n50:                 keccak256(\n\n54:                         keccak256(bytes(metadataURI)),\n\n72:                 keccak256(\n\n77:                         keccak256(followModuleInitData),\n\n99:                 keccak256(\n\n123:                 keccak256(\n\n127:                         keccak256(bytes(imageURI)),\n\n142:                 keccak256(\n\n146:                         keccak256(bytes(postParams.contentURI)),\n\n150:                         keccak256(postParams.referenceModuleInitData),\n\n164:             actionModulesInitDatasHashes[i] = keccak256(abi.encode(actionModulesInitDatas[i]));\n\n169:         return keccak256(abi.encodePacked(actionModulesInitDatasHashes));\n\n229:         bytes32 contentURIHash = keccak256(bytes(commentParams.contentURI));\n\n230:         bytes32 referenceModuleDataHash = keccak256(commentParams.referenceModuleData);\n\n232:         bytes32 referenceModuleInitDataHash = keccak256(commentParams.referenceModuleInitData);\n\n253:         _validateRecoveredAddress(_calculateDigest(keccak256(encodedAbi)), signature);\n\n259:         bytes32 contentURIHash = keccak256(bytes(quoteParams.contentURI));\n\n260:         bytes32 referenceModuleDataHash = keccak256(quoteParams.referenceModuleData);\n\n262:         bytes32 referenceModuleInitDataHash = keccak256(quoteParams.referenceModuleInitData);\n\n283:         _validateRecoveredAddress(_calculateDigest(keccak256(encodedAbi)), signature);\n\n291:                 keccak256(\n\n299:                         keccak256(mirrorParams.referenceModuleData),\n\n312:                 keccak256(\n\n331:             dataHashes[i] = keccak256(datas[i]);\n\n341:                 keccak256(\n\n345:                         keccak256(abi.encodePacked(idsOfProfilesToFollow)),\n\n346:                         keccak256(abi.encodePacked(followTokenIds)),\n\n347:                         keccak256(abi.encodePacked(dataHashes)),\n\n364:                 keccak256(\n\n368:                         keccak256(abi.encodePacked(idsOfProfilesToUnfollow)),\n\n386:                 keccak256(\n\n390:                         keccak256(abi.encodePacked(idsOfProfilesToSetBlockStatus)),\n\n391:                         keccak256(abi.encodePacked(blockStatus)),\n\n407:                 keccak256(\n\n415:                         keccak256(collectParams.collectModuleData),\n\n431:                 keccak256(\n\n440:                         keccak256(publicationActionParams.actionModuleData),\n\n455:             keccak256(\n\n458:                     keccak256(bytes(ILensERC721(address(this)).name())),\n\n493:         return keccak256(abi.encodePacked('\\x19\\x01', calculateDomainSeparator(), hashedMessage));\n\n```\n\n[50](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L50), [54](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L54), [72](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L72), [77](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L77), [99](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L99), [123](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L123), [127](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L127), [142](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L142), [146](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L146), [150](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L150), [164](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L164), [169](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L169), [229](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L229), [230](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L230), [232](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L232), [253](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L253), [259](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L259), [260](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L260), [262](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L262), [283](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L283), [291](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L291), [299](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L299), [312](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L312), [331](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L331), [341](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L341), [345](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L345), [346](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L346), [347](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L347), [364](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L364), [368](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L368), [386](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L386), [390](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L390), [391](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L391), [407](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L407), [415](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L415), [431](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L431), [440](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L440), [455](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L455), [458](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L458), [493](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L493),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n183:         return uint256(keccak256(bytes(localName)));\n\n```\n\n[183](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L183),\n\n```solidity\nFile: contracts/namespaces/TokenHandleRegistry.sol\n\n168:         return keccak256(abi.encode(handle.collection, handle.id));\n\n172:         return keccak256(abi.encode(token.collection, token.id));\n\n```\n\n[168](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L168), [172](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L172),\n\n</details>\n\n### <a name=\"N-64\"></a>[N-64] `bytes.concat()` can be used instead of `abi.encodePacked`\nGiven concatenation is not going to be used for hashing `bytes.concat` is the preferred method to use as its more gas efficient\n\n*Instances (13)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n275:         return string(abi.encodePacked(_followedProfileId.toString(), FOLLOW_NFT_NAME_SUFFIX));\n\n279:         return string(abi.encodePacked(_followedProfileId.toString(), FOLLOW_NFT_SYMBOL_SUFFIX));\n\n```\n\n[275](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L275), [279](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L279),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n103:                         abi.encodePacked(delegatedExecutors),\n\n104:                         abi.encodePacked(approvals),\n\n169:         return keccak256(abi.encodePacked(actionModulesInitDatasHashes));\n\n345:                         keccak256(abi.encodePacked(idsOfProfilesToFollow)),\n\n346:                         keccak256(abi.encodePacked(followTokenIds)),\n\n347:                         keccak256(abi.encodePacked(dataHashes)),\n\n368:                         keccak256(abi.encodePacked(idsOfProfilesToUnfollow)),\n\n390:                         keccak256(abi.encodePacked(idsOfProfilesToSetBlockStatus)),\n\n391:                         keccak256(abi.encodePacked(blockStatus)),\n\n473:             bytes memory concatenatedSig = abi.encodePacked(signature.r, signature.s, signature.v);\n\n493:         return keccak256(abi.encodePacked('\\x19\\x01', calculateDomainSeparator(), hashedMessage));\n\n```\n\n[103](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L103), [104](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L104), [169](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L169), [345](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L345), [346](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L346), [347](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L347), [368](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L368), [390](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L390), [391](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L391), [473](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L473), [493](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L493),\n\n</details>\n\n### <a name=\"N-65\"></a>[N-65] Reduce gas usage by moving to Solidity 0.8.19 or later\nSee [this](https://blog.soliditylang.org/2023/02/22/solidity-0.8.19-release-announcement/#preventing-dead-code-in-runtime-bytecode) link for the full details\n\n*Instances (31)*:\n<details>\n<summary>see instances</summary>\n\n\n```solidity\nFile: contracts/LensHub.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/LensHub.sol#L3),\n\n```solidity\nFile: contracts/FollowNFT.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/FollowNFT.sol#L3),\n\n```solidity\nFile: contracts/libraries/ActionLib.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ActionLib.sol#L3),\n\n```solidity\nFile: contracts/libraries/FollowLib.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/FollowLib.sol#L3),\n\n```solidity\nFile: contracts/libraries/GovernanceLib.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/GovernanceLib.sol#L3),\n\n```solidity\nFile: contracts/libraries/LegacyCollectLib.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/LegacyCollectLib.sol#L3),\n\n```solidity\nFile: contracts/libraries/MetaTxLib.sol\n\n2: pragma solidity ^0.8.15;\n\n```\n\n[2](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/MetaTxLib.sol#L2),\n\n```solidity\nFile: contracts/libraries/ProfileLib.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ProfileLib.sol#L3),\n\n```solidity\nFile: contracts/libraries/PublicationLib.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/PublicationLib.sol#L3),\n\n```solidity\nFile: contracts/libraries/StorageLib.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/StorageLib.sol#L3),\n\n```solidity\nFile: contracts/libraries/ValidationLib.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/libraries/ValidationLib.sol#L3),\n\n```solidity\nFile: contracts/base/ERC2981CollectionRoyalties.sol\n\n3: pragma solidity ^0.8.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/ERC2981CollectionRoyalties.sol#L3),\n\n```solidity\nFile: contracts/base/HubRestricted.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/HubRestricted.sol#L3),\n\n```solidity\nFile: contracts/base/LensBaseERC721.sol\n\n3: pragma solidity ^0.8.0;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensBaseERC721.sol#L3),\n\n```solidity\nFile: contracts/base/LensGovernable.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensGovernable.sol#L3),\n\n```solidity\nFile: contracts/base/LensHubEventHooks.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubEventHooks.sol#L3),\n\n```solidity\nFile: contracts/base/LensHubStorage.sol\n\n3: pragma solidity ^0.8.18;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensHubStorage.sol#L3),\n\n```solidity\nFile: contracts/base/LensImplGetters.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensImplGetters.sol#L3),\n\n```solidity\nFile: contracts/base/LensProfiles.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/LensProfiles.sol#L3),\n\n```solidity\nFile: contracts/base/upgradeability/FollowNFTProxy.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/base/upgradeability/FollowNFTProxy.sol#L3),\n\n```solidity\nFile: contracts/misc/ImmutableOwnable.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ImmutableOwnable.sol#L3),\n\n```solidity\nFile: contracts/misc/LegacyCollectNFT.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LegacyCollectNFT.sol#L3),\n\n```solidity\nFile: contracts/misc/LensV2Migration.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/LensV2Migration.sol#L3),\n\n```solidity\nFile: contracts/misc/ModuleGlobals.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ModuleGlobals.sol#L3),\n\n```solidity\nFile: contracts/misc/ProfileCreationProxy.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/ProfileCreationProxy.sol#L3),\n\n```solidity\nFile: contracts/misc/access/ControllableByContract.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ControllableByContract.sol#L3),\n\n```solidity\nFile: contracts/misc/access/Governance.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/Governance.sol#L3),\n\n```solidity\nFile: contracts/misc/access/ProxyAdmin.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/misc/access/ProxyAdmin.sol#L3),\n\n```solidity\nFile: contracts/namespaces/LensHandles.sol\n\n3: pragma solidity ^0.8.18;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/LensHandles.sol#L3),\n\n```solidity\nFile: contracts/namespaces/TokenHandleRegistry.sol\n\n3: pragma solidity ^0.8.18;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/namespaces/TokenHandleRegistry.sol#L3),\n\n```solidity\nFile: contracts/interfaces/ILegacyFollowModule.sol\n\n3: pragma solidity ^0.8.15;\n\n```\n\n[3](https://github.com/code-423n4/2023-07-lens/blob/main/contracts/interfaces/ILegacyFollowModule.sol#L3),\n\n</details>\n";
      addReportFormFields('0x6980-bot', defaultReport);      
    </script>
  </body>
</html>
